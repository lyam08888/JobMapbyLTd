<!DOCTYPE html>
<html lang="fr" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JobMap by LTd - Trouvez des Emplois et Candidats</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
    <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; overflow: hidden; user-select: none; }
        .dark body { background-color: #111827; }
        #map { height: 100vh; width: 100%; z-index: 0; }
        .leaflet-tile-pane { filter: brightness(1); transition: filter 0.3s ease-in-out; }
        .dark .leaflet-tile-pane { filter: brightness(0.6) invert(1) contrast(3) hue-rotate(200deg) saturate(0.3) brightness(0.7); }
        #ui-overlay { z-index: 1001; }
        .leaflet-popup-content-wrapper { border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .dark .leaflet-popup-content-wrapper { background: #1f2937; color: #d1d5db; }
        .leaflet-popup-content { margin: 15px; font-size: 14px; line-height: 1.5; }
        .popup-title { font-weight: 700; font-size: 16px; margin-bottom: 5px; color: #1a202c; }
        .dark .popup-title, .dark .popup-company { color: #f9fafb; }
        .popup-company { font-weight: 500; color: #4a5568; margin-bottom: 10px; }
        .search-container { transition: all 0.3s ease-in-out; overflow: hidden; }
        #drag-handle { cursor: move; }
        .search-container.collapsed { width: 60px !important; height: 60px !important; padding: 0; }
        .search-container.collapsed #panel-content, .search-container.collapsed #drag-handle { display: none; }
        .search-container.collapsed #panel-header { padding: 0; height: 100%; border-bottom: none; display:flex; align-items:center; justify-content:center; }
        #toggle-panel-btn i { transition: transform 0.3s ease; }
        .search-container.collapsed #toggle-panel-btn i { transform: rotate(180deg); }
        .custom-marker-icon { display: flex; align-items: center; justify-content: center; color: white; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3); transition: transform 0.2s ease; }
        .custom-marker-icon:hover { transform: scale(1.2); }
        .user-location-icon { background-color: #f59e0b; border: 3px solid white; border-radius: 50%; width: 18px !important; height: 18px !important; box-shadow: 0 0 10px #f59e0b; }
        @keyframes pulse { 0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); } 50% { transform: scale(1.2); box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); } }
        .pulsing { animation: pulse 1.5s infinite; }
        .modal-backdrop.hidden { display: none; }
        .modal-panel.hidden { transform: scale(0.95); opacity: 0; }
        .modal-panel { transition: all 0.2s ease-out; }
        .filter-btn, .sub-filter-btn { transition: all 0.2s ease-in-out; }
        .filter-btn.active, .sub-filter-btn.active { background-color: #3b82f6; color: white; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); }
        .dark .filter-btn.active, .dark .sub-filter-btn.active { background-color: #2563eb; }
        #startup-overlay.fade-out { opacity: 0; }
        #progress-bar { animation: progressBar 1.5s ease-in-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        @keyframes fadeOut { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.95); } }
        @keyframes progressBar { from { width: 0%; } to { width: 100%; } }
        #user-menu { transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out; }
        .routing-mode-btn.active { background-color: #3b82f6; color: white; }
        .leaflet-routing-container { display: none; }
        .toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%) translateY(100px); opacity: 0; transition: all 0.4s ease; z-index: 9999; }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        #match-mode-btn.active, #favorites-btn.has-favorites, #dark-mode-toggle.dark-on { color: #ec4899; box-shadow: 0 0 10px #ec489950; }
        #match-mode-btn.active { color: #a855f7; box-shadow: 0 0 10px #a855f750; }
        .score-circle { width: 120px; height: 120px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; font-weight: bold; color: white; border: 6px solid; }
        .favorite-icon.is-favorite { color: #ec4899; }
        .result-card { padding: 0.75rem; margin-bottom: 0.5rem; }
        .result-card h3 { font-size: 0.95rem; font-weight: 600; }
        .result-card p { font-size: 0.8rem; }
        #results-list { transition: max-height 0.3s ease-in-out; max-height: 200px; /* Hauteur réduite par défaut */ overflow-y: auto; }
        #results-list.expanded { max-height: 45vh; /* Hauteur étendue */ }
        #advanced-filters { transition: all 0.3s ease-in-out; max-height: 500px; overflow: hidden; }
        #advanced-filters.collapsed { max-height: 0; padding-top: 0; padding-bottom: 0; margin-bottom: 0; }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900">

    <div id="startup-overlay" class="fixed inset-0 bg-gray-900 z-[9999] flex flex-col items-center justify-center text-white transition-opacity duration-1000 ease-in-out">
        <div id="logo-container" class="text-center opacity-0" style="animation: fadeIn 1s ease-in forwards;"><i class="fas fa-map-marked-alt text-8xl text-blue-400"></i><h1 class="text-5xl font-bold mt-4">JobMap <span class="font-light">by LTd</span></h1></div>
        <div id="loader-container" class="hidden w-1/3 max-w-sm mt-8"><div class="w-full bg-gray-700 rounded-full h-2.5"><div id="progress-bar" class="bg-blue-500 h-2.5 rounded-full"></div></div><p id="loading-text" class="text-center text-gray-300 mt-2 text-sm"></p></div>
    </div>
    
    <div id="toast-container"></div>

    <div id="app" class="relative w-screen h-screen">
        <div id="map"></div>
        <div id="ui-overlay" class="absolute top-0 left-0 w-full h-full p-4 md:p-6 pointer-events-none">
            
            <!-- Menu Utilisateur en bas à gauche -->
            <div class="absolute bottom-6 left-6 pointer-events-auto">
                <button id="user-menu-button" title="Menu utilisateur" class="w-14 h-14 bg-white dark:bg-gray-800 rounded-full shadow-lg flex items-center justify-center text-gray-600 dark:text-gray-300 hover:text-blue-500 transition"><i class="fas fa-user-circle text-4xl"></i></button>
                <div id="user-menu" class="absolute bottom-full mb-2 left-0 bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-64 p-2 origin-bottom-left transform scale-95 opacity-0 hidden"></div>
            </div>

            <!-- Barre d'outils en bas au centre -->
            <div class="absolute bottom-6 left-1/2 -translate-x-1/2 pointer-events-auto flex gap-2 bg-white/80 dark:bg-gray-800/80 backdrop-blur-md rounded-full shadow-lg p-2">
                <button id="help-btn" title="Aide et tutoriel" class="w-12 h-12 rounded-full flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition"><i class="fas fa-question-circle text-xl"></i></button>
                <button id="locate-me-btn" title="Me localiser" class="w-12 h-12 rounded-full flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition"><i class="fas fa-crosshairs text-xl"></i></button>
                <button id="match-mode-btn" title="Activer le mode association" class="w-12 h-12 rounded-full flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition"><i class="fas fa-link text-xl"></i></button>
                <button id="favorites-btn" title="Voir les favoris" class="w-12 h-12 rounded-full flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition relative"><i class="fas fa-heart text-xl"></i><span id="favorites-count" class="absolute top-1 right-1 bg-pink-500 text-white text-xs font-bold rounded-full h-4 w-4 flex items-center justify-center hidden"></span></button>
                <button id="dark-mode-toggle" title="Changer de thème" class="w-12 h-12 rounded-full flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition"><i class="fas fa-moon text-xl"></i></button>
            </div>


            <div id="search-panel" class="search-container absolute top-6 right-6 w-full max-w-sm md:max-w-xs lg:max-w-sm bg-white/80 dark:bg-gray-800/80 backdrop-blur-md rounded-xl shadow-2xl flex flex-col pointer-events-auto max-h-[90vh]">
                <div id="panel-header" class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
                    <div id="drag-handle" class="flex items-center gap-3 flex-grow"><i class="fas fa-map-marked-alt text-3xl text-blue-500"></i><div><h1 class="text-xl font-bold text-gray-800 dark:text-gray-100">JobMap</h1><p class="text-sm text-gray-500 dark:text-gray-400">by LTd</p></div></div>
                    <button id="toggle-panel-btn" class="p-2 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 flex-shrink-0"><i class="fas fa-chevron-left"></i></button>
                </div>
                <div id="panel-content" class="p-4 flex flex-col min-h-0">
                    <div class="relative py-2 flex-shrink-0">
                        <input type="text" id="search-input" placeholder="Poste, compétence..." class="w-full pl-10 pr-10 py-3 text-md bg-gray-100 dark:bg-gray-700 border-2 border-transparent dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                        <button id="save-search-btn" title="Sauvegarder cette recherche" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-blue-500 transition">
                            <i class="fas fa-bookmark"></i>
                        </button>
                    </div>
                    <div class="mb-3 flex-shrink-0"><div id="filter-container" class="w-full flex bg-gray-200 dark:bg-gray-700 rounded-lg p-1"><button class="filter-btn active w-1/3 text-center py-2 px-2 rounded-md font-semibold text-sm text-gray-700 dark:text-gray-300" data-filter="all">Tous</button><button class="filter-btn w-1/3 text-center py-2 px-2 rounded-md font-semibold text-sm text-gray-700 dark:text-gray-300" data-filter="job">Emplois</button><button class="filter-btn w-1/3 text-center py-2 px-2 rounded-md font-semibold text-sm text-gray-700 dark:text-gray-300" data-filter="candidate">Profils</button></div></div>
                    
                    <div id="toggle-filters-btn" class="flex justify-between items-center py-2 cursor-pointer flex-shrink-0">
                         <h4 class="text-sm font-semibold text-gray-600 dark:text-gray-300">Filtres avancés</h4>
                         <i class="fas fa-chevron-up text-gray-500 dark:text-gray-400 transition-transform"></i>
                    </div>
                    <div id="advanced-filters" class="flex-shrink-0">
                        <div class="space-y-3 pt-2 mb-3">
                            <div><label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Type de contrat</label><div id="contract-filter-container" class="w-full flex bg-gray-200 dark:bg-gray-700 rounded-lg p-1 text-xs"><button class="sub-filter-btn active w-1/4 py-1.5 rounded-md text-gray-700 dark:text-gray-300" data-contract="all">Tous</button><button class="sub-filter-btn w-1/4 py-1.5 rounded-md text-gray-700 dark:text-gray-300" data-contract="CDI">CDI</button><button class="sub-filter-btn w-1/4 py-1.5 rounded-md text-gray-700 dark:text-gray-300" data-contract="CDD">CDD</button><button class="sub-filter-btn w-1/4 py-1.5 rounded-md text-gray-700 dark:text-gray-300" data-contract="Alternance">Alternance</button></div></div>
                            <div><label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Mode de travail</label><div id="work-arrangement-filter-container" class="w-full flex bg-gray-200 dark:bg-gray-700 rounded-lg p-1 text-xs"><button class="sub-filter-btn active w-1/3 py-1.5 rounded-md text-gray-700 dark:text-gray-300" data-work="all">Tous</button><button class="sub-filter-btn w-1/3 py-1.5 rounded-md text-gray-700 dark:text-gray-300" data-work="Sur site">Sur site</button><button class="sub-filter-btn w-1/3 py-1.5 rounded-md text-gray-700 dark:text-gray-300" data-work="Hybride">Hybride</button></div></div>
                            <div><label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Secteur</label><select id="industry-filter" class="w-full p-2 text-xs bg-gray-200 dark:bg-gray-700 rounded-lg border-none text-gray-700 dark:text-gray-300"><option value="all">Tous les secteurs</option><option value="Tech">Tech</option><option value="Data">Data/IA</option><option value="Design">Design</option><option value="Marketing">Marketing</option><option value="Finance">Finance</option><option value="Conseil">Conseil</option><option value="E-Commerce">E-Commerce</option><option value="Blockchain">Blockchain</option><option value="Communication">Communication</option><option value="RH">RH</option><option value="IoT">IoT</option><option value="Sécurité">Sécurité</option><option value="Cloud">Cloud</option><option value="Mobile">Mobile</option><option value="IA">Intelligence Artificielle</option><option value="Web">Développement Web</option><option value="Digital">Digital/Agence</option><option value="QA">Qualité/Testing</option><option value="Infrastructure">Infrastructure</option></select></div>
                            <div><label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Expérience</label><div id="experience-filter-container" class="w-full flex bg-gray-200 dark:bg-gray-700 rounded-lg p-1 text-xs"><button class="sub-filter-btn active w-1/4 py-1.5 rounded-md text-gray-700 dark:text-gray-300" data-exp="all">Tous</button><button class="sub-filter-btn w-1/4 py-1.5 rounded-md text-gray-700 dark:text-gray-300" data-exp="Junior">Junior</button><button class="sub-filter-btn w-1/4 py-1.5 rounded-md text-gray-700 dark:text-gray-300" data-exp="Confirmé">Confirmé</button><button class="sub-filter-btn w-1/4 py-1.5 rounded-md text-gray-700 dark:text-gray-300" data-exp="Senior">Senior</button></div></div>
                            <div><label for="salary-slider" class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Salaire max: <span id="salary-value" class="font-bold text-blue-600 dark:text-blue-400"></span></label><input type="range" id="salary-slider" min="30000" max="120000" step="5000" value="120000" class="w-full h-2 bg-gray-200 dark:bg-gray-600 rounded-lg appearance-none cursor-pointer"></div>
                            <div><label for="distance-slider" class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Distance max: <span id="distance-value" class="font-bold text-emerald-600 dark:text-emerald-400">50 km</span></label><input type="range" id="distance-slider" min="5" max="100" step="5" value="50" class="w-full h-2 bg-gray-200 dark:bg-gray-600 rounded-lg appearance-none cursor-pointer"></div>
                            <div class="pt-2">
                                <button id="export-data-btn" class="w-full py-2 px-4 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg text-xs font-semibold hover:from-blue-600 hover:to-purple-600 transition">
                                    <i class="fas fa-download mr-2"></i>Exporter les résultats
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="results-header" class="flex justify-between items-center text-sm font-medium text-gray-500 dark:text-gray-400 mb-2 flex-shrink-0 hidden">
                        <span id="results-count"></span>
                        <button id="toggle-results-btn" title="Agrandir/Réduire" class="p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600"><i class="fas fa-chevron-up"></i></button>
                    </div>
                    <div id="results-list" class="flex-1 min-h-0 hidden pr-2"></div>
                </div>
            </div>
            <div id="routing-controls" class="absolute top-[100px] right-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-1 flex gap-1 pointer-events-auto hidden"><button data-mode="car" class="routing-mode-btn w-10 h-10 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition active"><i class="fas fa-car"></i></button><button data-mode="bicycle" class="routing-mode-btn w-10 h-10 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition"><i class="fas fa-bicycle"></i></button><button data-mode="foot" class="routing-mode-btn w-10 h-10 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition"><i class="fas fa-walking"></i></button><div class="border-l dark:border-gray-600 mx-1"></div><button id="clear-route-btn" class="w-10 h-10 rounded-md text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition"><i class="fas fa-times"></i></button></div>
        </div>
    </div>
    
    <div id="modal-container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const startupOverlay = document.getElementById('startup-overlay'), logoContainer = document.getElementById('logo-container'), loaderContainer = document.getElementById('loader-container');
            setTimeout(() => { logoContainer.style.animation = 'fadeOut 1s ease-out forwards'; }, 1500);
            setTimeout(() => { logoContainer.classList.add('hidden'); loaderContainer.classList.remove('hidden'); loaderContainer.style.animation = 'fadeIn 1s ease-in forwards'; }, 2500);
            setTimeout(() => { startupOverlay.classList.add('fade-out'); startupOverlay.addEventListener('transitionend', () => startupOverlay.remove()); initializeApp(); }, 4200);

            function initializeApp() {
                const map = L.map('map').setView([46.603354, 1.888334], 6);
                L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', { attribution: '&copy; OSM &copy; CARTO', maxZoom: 20 }).addTo(map);

                const ui = {
                    userMenuButton: document.getElementById('user-menu-button'), userMenu: document.getElementById('user-menu'), helpBtn: document.getElementById('help-btn'), saveSearchBtn: document.getElementById('save-search-btn'), locateMeBtn: document.getElementById('locate-me-btn'), matchModeBtn: document.getElementById('match-mode-btn'), favoritesBtn: document.getElementById('favorites-btn'), favoritesCount: document.getElementById('favorites-count'), searchInput: document.getElementById('search-input'), resultsList: document.getElementById('results-list'), resultsHeader: document.getElementById('results-header'), resultsCount: document.getElementById('results-count'), toggleResultsBtn: document.getElementById('toggle-results-btn'), filterContainer: document.getElementById('filter-container'), advancedFilters: document.getElementById('advanced-filters'), toggleFiltersBtn: document.getElementById('toggle-filters-btn'), expFilterContainer: document.getElementById('experience-filter-container'), contractFilterContainer: document.getElementById('contract-filter-container'), workArrangementFilterContainer: document.getElementById('work-arrangement-filter-container'), industryFilter: document.getElementById('industry-filter'), salarySlider: document.getElementById('salary-slider'), salaryValue: document.getElementById('salary-value'), distanceSlider: document.getElementById('distance-slider'), distanceValue: document.getElementById('distance-value'), exportDataBtn: document.getElementById('export-data-btn'), routingControls: document.getElementById('routing-controls'), clearRouteBtn: document.getElementById('clear-route-btn'), searchPanel: document.getElementById('search-panel'), dragHandle: document.getElementById('drag-handle'), darkModeToggle: document.getElementById('dark-mode-toggle'), modalContainer: document.getElementById('modal-container'), togglePanelBtn: document.getElementById('toggle-panel-btn'),
                };
                
                let state = { currentUser: null, routingControl: null, userLocation: { lat: 48.85884, lon: 2.29435 }, userLocationMarker: null, firstInteraction: false, isMatchModeActive: false, matchStartPoint: null, markers: new Map(), favorites: new Set(), filters: { type: 'all', experience: 'all', salary: 120000, contract: 'all', workArrangement: 'all', industry: 'all', distance: 50 }, viewHistory: [], savedSearches: [] };

                const markerClusters = L.markerClusterGroup();
                map.addLayer(markerClusters);

                let data = [
                    { id: 1, type: 'job', title: 'Développeur Full-Stack', company: 'Tech Solutions Inc.', logo: 'https://placehold.co/100x100/3b82f6/ffffff?text=TSI', companyDescription: 'Leader en solutions logicielles B2B, nous innovons constamment pour nos clients.', industry: 'Tech', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['React', 'Node.js', 'TypeScript', 'SQL'], softSkills: ['Travail d\'équipe', 'Communication', 'Créativité'], experience: 'Confirmé', salary: 65000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Rejoignez notre équipe agile pour construire des applications web innovantes.' },
                    { id: 3, type: 'job', title: 'Data Scientist Senior', company: 'DataCorp', logo: 'https://placehold.co/100x100/10b981/ffffff?text=DC', companyDescription: 'Nous transformons les données en décisions stratégiques pour les entreprises du CAC40.', industry: 'Data', location: { lat: 48.8698, lon: 2.3344 }, city: 'Paris', tags: ['Python', 'Machine Learning', 'TensorFlow'], softSkills: ['Analyse critique', 'Résolution de problèmes'], experience: 'Senior', salary: 85000, contract: 'CDI', workArrangement: 'Télétravail', acceptsSpontaneous: true, description: 'Expert en Machine Learning pour développer des modèles prédictifs.' },
                    { id: 4, type: 'candidate', name: 'Jean Dupont', title: 'Développeur Backend', avatar: 'https://placehold.co/100x100/7c3aed/ffffff?text=JD', location: { lat: 48.8534, lon: 2.3488 }, city: 'Paris', tags: ['Java', 'Spring', 'SQL'], softSkills: ['Autonomie', 'Rigueur', 'Communication'], experience: 'Senior', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2008-2011', degree: 'Master Informatique', school: 'Université Paris-Saclay'}], certifications: ['Oracle Java Certified', 'Spring Professional'], background: [{ year: '2015-2023', role: 'Développeur Senior', company: 'Banque Générale'}, { year: '2012-2015', role: 'Développeur Java', company: 'Soft Services'}], description: '8 ans d\'expérience dans le secteur financier.' },
                    { id: 2, type: 'candidate', name: 'Alice Martin', title: 'Chef de Projet Digital', avatar: 'https://placehold.co/100x100/f59e0b/ffffff?text=AM', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Agile', 'Scrum', 'Gestion'], softSkills: ['Leadership', 'Organisation', 'Communication'], experience: 'Confirmé', availability: 'Sous 1 mois', portfolioLink: 'https://example.com', education: [{ year: '2013-2016', degree: 'Master Management Digital', school: 'EM Lyon'}], certifications: ['Scrum Master Certified', 'PMP'], background: [{ year: '2018-2023', role: 'Product Owner', company: 'WebAgency Lyon'}, { year: '2016-2018', role: 'Assistante Chef de Projet', company: 'Digital Corp'}], description: '5 ans d\'expérience, certifiée Scrum Master.' },
                    { id: 5, type: 'job', title: 'Designer UI/UX Junior', company: 'Creative Minds', logo: 'https://placehold.co/100x100/ec4899/ffffff?text=CM', companyDescription: 'Agence de design primée, nous créons des expériences digitales mémorables.', industry: 'Design', location: { lat: 45.7578, lon: 4.8320 }, city: 'Lyon', tags: ['Figma', 'Adobe XD', 'User Research'], softSkills: ['Créativité', 'Empathie', 'Collaboration'], experience: 'Junior', salary: 42000, contract: 'CDD', workArrangement: 'Sur site', acceptsSpontaneous: false, description: 'Nous cherchons un designer talentueux pour créer des interfaces intuitives.' },
                    { id: 6, type: 'job', title: 'Chef de projet Marketing', company: 'DataCorp', logo: 'https://placehold.co/100x100/10b981/ffffff?text=DC', companyDescription: 'Nous transformons les données en décisions stratégiques pour les entreprises du CAC40.', industry: 'Marketing', location: { lat: 48.875, lon: 2.33 }, city: 'Paris', tags: ['Marketing', 'SEO', 'SEA'], softSkills: ['Organisation', 'Communication'], experience: 'Confirmé', salary: 55000, contract: 'Alternance', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Gérez nos campagnes marketing digitales.' },
                    { id: 7, type: 'job', title: 'Développeur Mobile iOS', company: 'AppFactory', logo: 'https://placehold.co/100x100/8b5cf6/ffffff?text=AF', companyDescription: 'Startup innovante spécialisée dans les applications mobiles pour le secteur de la santé.', industry: 'Tech', location: { lat: 43.2965, lon: 5.3698 }, city: 'Marseille', tags: ['Swift', 'SwiftUI', 'CoreData'], softSkills: ['Innovation', 'Rigueur'], experience: 'Confirmé', salary: 58000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Développez des applications iOS de qualité médicale.' },
                    { id: 8, type: 'candidate', name: 'Sophie Bernard', title: 'DevOps Engineer', avatar: 'https://placehold.co/100x100/06b6d4/ffffff?text=SB', location: { lat: 43.6108, lon: 3.8767 }, city: 'Montpellier', tags: ['Docker', 'Kubernetes', 'AWS'], softSkills: ['Méthodique', 'Proactif'], experience: 'Confirmé', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2015-2017', degree: 'Master Systèmes Distribués', school: 'Université Montpellier'}], certifications: ['AWS Solutions Architect', 'CKA'], background: [{ year: '2019-2024', role: 'DevOps Engineer', company: 'CloudTech'}, { year: '2017-2019', role: 'Administrateur Système', company: 'HostNet'}], description: 'Experte en automatisation et CI/CD.' },
                    { id: 9, type: 'job', title: 'Architecte Cloud', company: 'CloudMasters', logo: 'https://placehold.co/100x100/14b8a6/ffffff?text=CM', companyDescription: 'Cabinet de conseil en architecture cloud et transformation digitale.', industry: 'Conseil', location: { lat: 47.2184, lon: -1.5536 }, city: 'Nantes', tags: ['AWS', 'Azure', 'Architecture'], softSkills: ['Leadership technique', 'Vision stratégique'], experience: 'Senior', salary: 95000, contract: 'CDI', workArrangement: 'Télétravail', acceptsSpontaneous: true, description: 'Concevez des architectures cloud scalables pour nos grands comptes.' },
                    { id: 10, type: 'candidate', name: 'Marc Rousseau', title: 'Ingénieur QA', avatar: 'https://placehold.co/100x100/f97316/ffffff?text=MR', location: { lat: 48.5734, lon: 7.7521 }, city: 'Strasbourg', tags: ['Selenium', 'Jest', 'Cypress'], softSkills: ['Minutieux', 'Analytique'], experience: 'Junior', availability: 'Sous 2 mois', portfolioLink: 'https://example.com', education: [{ year: '2020-2022', degree: 'Master Qualité Logicielle', school: 'INSA Strasbourg'}], certifications: ['ISTQB Foundation'], background: [{ year: '2022-2024', role: 'Testeur QA', company: 'TestLab'}], description: 'Passionné par la qualité logicielle et l\'automatisation des tests.' },
                    { id: 11, type: 'job', title: 'Product Manager', company: 'InnovateTech', logo: 'https://placehold.co/100x100/ef4444/ffffff?text=IT', companyDescription: 'Scale-up en pleine croissance dans le domaine de la fintech.', industry: 'Finance', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Product Management', 'Agile', 'Analytics'], softSkills: ['Leadership', 'Vision produit', 'Communication'], experience: 'Confirmé', salary: 70000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Définissez la vision produit et coordonnez les équipes de développement.' },
                    { id: 12, type: 'candidate', name: 'Emma Lefebvre', title: 'UX Researcher', avatar: 'https://placehold.co/100x100/a855f7/ffffff?text=EL', location: { lat: 50.6292, lon: 3.0573 }, city: 'Lille', tags: ['User Research', 'Usability Testing', 'Figma'], softSkills: ['Empathie', 'Analyse', 'Communication'], experience: 'Confirmé', availability: 'Sous 1 mois', portfolioLink: 'https://example.com', education: [{ year: '2016-2018', degree: 'Master Design d\'Interface', school: 'Gobelins'}], certifications: ['Nielsen Norman UX Certificate'], background: [{ year: '2020-2024', role: 'UX Researcher', company: 'DesignStudio'}, { year: '2018-2020', role: 'UX Designer', company: 'WebCorp'}], description: 'Spécialisée en recherche utilisateur et tests d\'utilisabilité.' },
                    { id: 13, type: 'job', title: 'Ingénieur Sécurité', company: 'SecureSoft', logo: 'https://placehold.co/100x100/dc2626/ffffff?text=SS', companyDescription: 'Éditeur de solutions de cybersécurité pour les entreprises.', industry: 'Sécurité', location: { lat: 43.6047, lon: 1.4442 }, city: 'Toulouse', tags: ['Pentest', 'SIEM', 'Cryptographie'], softSkills: ['Rigueur', 'Curiosité', 'Éthique'], experience: 'Senior', salary: 80000, contract: 'CDI', workArrangement: 'Sur site', acceptsSpontaneous: false, description: 'Protégez nos clients contre les cybermenaces et réalisez des audits de sécurité.' },
                    { id: 14, type: 'candidate', name: 'Thomas Dubois', title: 'Développeur Frontend', avatar: 'https://placehold.co/100x100/0ea5e9/ffffff?text=TD', location: { lat: 47.4784, lon: -0.5632 }, city: 'Angers', tags: ['Vue.js', 'Nuxt', 'TailwindCSS'], softSkills: ['Créativité', 'Détail', 'Collaboration'], experience: 'Junior', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2021-2023', degree: 'Licence Informatique', school: 'Université Angers'}], certifications: [], background: [{ year: '2023-2024', role: 'Développeur Frontend', company: 'WebStudio'}], description: 'Développeur frontend passionné par les interfaces modernes et performantes.' },
                    { id: 15, type: 'job', title: 'Consultant SAP', company: 'BusinessTech', logo: 'https://placehold.co/100x100/84cc16/ffffff?text=BT', companyDescription: 'Cabinet de conseil spécialisé en transformation digitale et ERP.', industry: 'Conseil', location: { lat: 48.1173, lon: -1.6778 }, city: 'Rennes', tags: ['SAP', 'ABAP', 'Gestion de projet'], softSkills: ['Conseil', 'Adaptabilité', 'Communication'], experience: 'Confirmé', salary: 72000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Accompagnez nos clients dans leurs projets SAP et transformation digitale.' },
                    { id: 16, type: 'job', title: 'Développeur Backend Python', company: 'Tech Solutions Inc.', logo: 'https://placehold.co/100x100/3b82f6/ffffff?text=TSI', companyDescription: 'Leader en solutions logicielles B2B, nous innovons constamment pour nos clients.', industry: 'Tech', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Python', 'Django', 'PostgreSQL', 'Redis'], softSkills: ['Autonomie', 'Problem Solving'], experience: 'Confirmé', salary: 60000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Développez des APIs robustes et scalables pour nos clients B2B.' },
                    { id: 17, type: 'candidate', name: 'Léa Roussel', title: 'Data Analyst', avatar: 'https://placehold.co/100x100/22c55e/ffffff?text=LR', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['SQL', 'Python', 'Tableau', 'Power BI'], softSkills: ['Analytique', 'Communication', 'Curiosité'], experience: 'Junior', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2021-2023', degree: 'Master Data Science', school: 'ENSAE'}], certifications: ['Google Data Analytics'], background: [{ year: '2023-2024', role: 'Stagiaire Data', company: 'Big Corp'}], description: 'Passionnée par l\'analyse de données et la visualisation.' },
                    { id: 18, type: 'job', title: 'Responsable E-Commerce', company: 'ShopDigital', logo: 'https://placehold.co/100x100/f43f5e/ffffff?text=SD', companyDescription: 'Plateforme e-commerce innovante avec plus de 2M de clients actifs.', industry: 'E-Commerce', location: { lat: 48.8738, lon: 2.2950 }, city: 'Paris', tags: ['E-commerce', 'Google Analytics', 'SEO'], softSkills: ['Stratégie', 'Leadership', 'Créativité'], experience: 'Senior', salary: 75000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Pilotez notre stratégie e-commerce et optimisez les conversions.' },
                    { id: 19, type: 'candidate', name: 'Pierre Durand', title: 'Développeur Mobile Flutter', avatar: 'https://placehold.co/100x100/6366f1/ffffff?text=PD', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Flutter', 'Dart', 'Firebase', 'REST API'], softSkills: ['Créativité', 'Autonomie', 'Persévérance'], experience: 'Confirmé', availability: 'Sous 1 mois', portfolioLink: 'https://example.com', education: [{ year: '2016-2019', degree: 'Licence Informatique', school: 'Université Lyon 1'}], certifications: ['Google Flutter Developer'], background: [{ year: '2019-2024', role: 'Développeur Mobile', company: 'MobileApps SA'}], description: '5 ans d\'expérience dans le développement d\'applications mobiles cross-platform.' },
                    { id: 20, type: 'job', title: 'Chef de Projet IT', company: 'CloudMasters', logo: 'https://placehold.co/100x100/14b8a6/ffffff?text=CM', companyDescription: 'Cabinet de conseil en architecture cloud et transformation digitale.', industry: 'Conseil', location: { lat: 47.2184, lon: -1.5536 }, city: 'Nantes', tags: ['Gestion de projet', 'Agile', 'ITIL'], softSkills: ['Organisation', 'Communication', 'Leadership'], experience: 'Confirmé', salary: 68000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Gérez des projets d\'infrastructure cloud pour nos clients grands comptes.' },
                    { id: 21, type: 'candidate', name: 'Camille Petit', title: 'Graphiste 3D', avatar: 'https://placehold.co/100x100/ec4899/ffffff?text=CP', location: { lat: 43.2965, lon: 5.3698 }, city: 'Marseille', tags: ['Blender', 'Cinema 4D', 'After Effects'], softSkills: ['Créativité', 'Attention au détail', 'Passion'], experience: 'Junior', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2020-2023', degree: 'Bachelor Design 3D', school: 'Les Gobelins'}], certifications: [], background: [{ year: '2023-2024', role: 'Graphiste 3D', company: 'Studio Créatif'}], description: 'Créateur de visuels 3D pour l\'animation et le jeu vidéo.' },
                    { id: 22, type: 'job', title: 'Développeur Blockchain', company: 'CryptoTech', logo: 'https://placehold.co/100x100/8b5cf6/ffffff?text=CT', companyDescription: 'Startup pionnière dans les solutions blockchain pour la finance décentralisée.', industry: 'Blockchain', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Solidity', 'Web3', 'Ethereum', 'Smart Contracts'], softSkills: ['Innovation', 'Rigueur', 'Curiosité'], experience: 'Confirmé', salary: 78000, contract: 'CDI', workArrangement: 'Télétravail', acceptsSpontaneous: true, description: 'Développez des smart contracts et applications décentralisées innovantes.' },
                    { id: 23, type: 'candidate', name: 'Lucas Martin', title: 'Architecte Logiciel', avatar: 'https://placehold.co/100x100/0ea5e9/ffffff?text=LM', location: { lat: 50.6292, lon: 3.0573 }, city: 'Lille', tags: ['Architecture', 'Microservices', 'DDD', 'Cloud'], softSkills: ['Vision technique', 'Mentoring', 'Communication'], experience: 'Senior', availability: 'Sous 3 mois', portfolioLink: 'https://example.com', education: [{ year: '2008-2013', degree: 'Ingénieur Informatique', school: 'Centrale Lille'}], certifications: ['AWS Solutions Architect Pro', 'TOGAF'], background: [{ year: '2018-2024', role: 'Architecte', company: 'Tech Leader'}, { year: '2013-2018', role: 'Lead Dev', company: 'Dev Solutions'}], description: '11 ans d\'expérience dans la conception d\'architectures complexes.' },
                    { id: 24, type: 'job', title: 'Community Manager', company: 'SocialMedia Pro', logo: 'https://placehold.co/100x100/f59e0b/ffffff?text=SMP', companyDescription: 'Agence spécialisée en gestion de communautés et stratégie social media.', industry: 'Communication', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Social Media', 'Content Creation', 'Analytics'], softSkills: ['Créativité', 'Communication', 'Réactivité'], experience: 'Junior', salary: 35000, contract: 'CDD', workArrangement: 'Hybride', acceptsSpontaneous: false, description: 'Animez les communautés de nos clients sur les réseaux sociaux.' },
                    { id: 25, type: 'candidate', name: 'Julie Moreau', title: 'Ingénieur DevSecOps', avatar: 'https://placehold.co/100x100/dc2626/ffffff?text=JM', location: { lat: 43.6047, lon: 1.4442 }, city: 'Toulouse', tags: ['DevOps', 'Security', 'Jenkins', 'Kubernetes'], softSkills: ['Rigueur', 'Proactif', 'Collaboration'], experience: 'Confirmé', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2014-2017', degree: 'Master Cybersécurité', school: 'INSA Toulouse'}], certifications: ['CISSP', 'CKA'], background: [{ year: '2017-2024', role: 'DevSecOps', company: 'SecureCloud'}], description: '7 ans d\'expérience en sécurité et automatisation.' },
                    { id: 26, type: 'job', title: 'Business Analyst', company: 'BusinessTech', logo: 'https://placehold.co/100x100/84cc16/ffffff?text=BT', companyDescription: 'Cabinet de conseil spécialisé en transformation digitale et ERP.', industry: 'Conseil', location: { lat: 48.1173, lon: -1.6778 }, city: 'Rennes', tags: ['Business Analysis', 'SQL', 'UML'], softSkills: ['Analyse', 'Communication', 'Synthèse'], experience: 'Confirmé', salary: 55000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Analysez les besoins métiers et proposez des solutions adaptées.' },
                    { id: 27, type: 'candidate', name: 'Alexandre Blanc', title: 'Développeur Jeux Vidéo', avatar: 'https://placehold.co/100x100/8b5cf6/ffffff?text=AB', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Unity', 'C#', 'Game Design'], softSkills: ['Créativité', 'Passion', 'Travail d\'équipe'], experience: 'Junior', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2019-2022', degree: 'Bachelor Game Design', school: 'Gaming Campus'}], certifications: ['Unity Certified Developer'], background: [{ year: '2022-2024', role: 'Game Developer', company: 'Indie Studio'}], description: 'Développeur passionné avec plusieurs jeux indés publiés.' },
                    { id: 28, type: 'job', title: 'Responsable RH Digital', company: 'HR Innov', logo: 'https://placehold.co/100x100/10b981/ffffff?text=HRI', companyDescription: 'Transformation digitale des ressources humaines pour les grandes entreprises.', industry: 'RH', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['RH', 'Digital', 'Change Management'], softSkills: ['Empathie', 'Leadership', 'Communication'], experience: 'Senior', salary: 65000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Pilotez la transformation digitale RH de nos clients.' },
                    { id: 29, type: 'candidate', name: 'Sarah Dubois', title: 'Développeur IA/ML', avatar: 'https://placehold.co/100x100/06b6d4/ffffff?text=SD', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Python', 'TensorFlow', 'PyTorch', 'NLP'], softSkills: ['Analytique', 'Curiosité', 'Innovation'], experience: 'Confirmé', availability: 'Sous 2 mois', portfolioLink: 'https://example.com', education: [{ year: '2016-2018', degree: 'PhD Machine Learning', school: 'Université Paris-Saclay'}], certifications: ['TensorFlow Developer'], background: [{ year: '2018-2024', role: 'ML Engineer', company: 'AI Research Lab'}], description: 'Docteure en ML, experte en NLP et vision par ordinateur.' },
                    { id: 30, type: 'job', title: 'Ingénieur IoT', company: 'Connected Devices', logo: 'https://placehold.co/100x100/f43f5e/ffffff?text=CD', companyDescription: 'Fabricant de solutions IoT pour la smart city et l\'industrie 4.0.', industry: 'IoT', location: { lat: 43.6108, lon: 3.8767 }, city: 'Montpellier', tags: ['IoT', 'MQTT', 'C++', 'Arduino'], softSkills: ['Innovation', 'Problem Solving', 'Rigueur'], experience: 'Confirmé', salary: 62000, contract: 'CDI', workArrangement: 'Sur site', acceptsSpontaneous: true, description: 'Concevez des solutions IoT innovantes pour nos projets smart city.' },
                    // Additional candidates (31-60)
                    { id: 31, type: 'candidate', name: 'Maxime Girard', title: 'Développeur .NET', avatar: 'https://placehold.co/100x100/3b82f6/ffffff?text=MG', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['.NET Core', 'C#', 'Azure', 'SQL Server'], softSkills: ['Collaboration', 'Adaptabilité', 'Méthodique'], experience: 'Confirmé', availability: 'Sous 1 mois', portfolioLink: 'https://example.com', education: [{ year: '2015-2018', degree: 'Master Génie Logiciel', school: 'EPITA'}], certifications: ['Microsoft Certified: Azure Developer'], background: [{ year: '2018-2024', role: 'Développeur .NET', company: 'Enterprise Solutions'}], description: '6 ans d\'expérience en développement d\'applications d\'entreprise.' },
                    { id: 32, type: 'candidate', name: 'Nathalie Blanc', title: 'Responsable Marketing Digital', avatar: 'https://placehold.co/100x100/ec4899/ffffff?text=NB', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Marketing Digital', 'SEO', 'Google Ads', 'Analytics'], softSkills: ['Créativité', 'Stratégie', 'Leadership'], experience: 'Senior', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2010-2013', degree: 'Master Marketing', school: 'EM Lyon Business School'}], certifications: ['Google Analytics Certified', 'HubSpot Inbound'], background: [{ year: '2018-2024', role: 'Responsable Marketing', company: 'E-commerce Leader'}, { year: '2013-2018', role: 'Chef de Projet Marketing', company: 'Digital Agency'}], description: '11 ans d\'expérience en stratégie digitale et acquisition.' },
                    { id: 33, type: 'candidate', name: 'Olivier Mercier', title: 'Ingénieur Data', avatar: 'https://placehold.co/100x100/10b981/ffffff?text=OM', location: { lat: 43.6047, lon: 1.4442 }, city: 'Toulouse', tags: ['Big Data', 'Spark', 'Hadoop', 'Python', 'Scala'], softSkills: ['Analytique', 'Rigoureux', 'Pédagogue'], experience: 'Senior', availability: 'Sous 2 mois', portfolioLink: 'https://example.com', education: [{ year: '2011-2014', degree: 'PhD Mathématiques Appliquées', school: 'Université Toulouse III'}], certifications: ['Databricks Certified', 'Cloudera Data Engineer'], background: [{ year: '2017-2024', role: 'Ingénieur Data', company: 'BigData Corp'}, { year: '2014-2017', role: 'Data Scientist', company: 'Analytics Pro'}], description: 'Expert en architecture big data et machine learning.' },
                    { id: 34, type: 'candidate', name: 'Patricia Duval', title: 'Cheffe de Projet Agile', avatar: 'https://placehold.co/100x100/f59e0b/ffffff?text=PD', location: { lat: 47.2184, lon: -1.5536 }, city: 'Nantes', tags: ['Scrum', 'Kanban', 'JIRA', 'Confluence'], softSkills: ['Leadership', 'Organisation', 'Facilitation'], experience: 'Confirmé', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2014-2017', degree: 'Master Management de Projets', school: 'Audencia Business School'}], certifications: ['Certified Scrum Master', 'SAFe Agilist', 'PMP'], background: [{ year: '2019-2024', role: 'Scrum Master', company: 'Tech Innovate'}, { year: '2017-2019', role: 'Chef de Projet', company: 'Consulting Group'}], description: '7 ans en gestion de projets agiles et transformation digitale.' },
                    { id: 35, type: 'candidate', name: 'Quentin Roux', title: 'Développeur React Native', avatar: 'https://placehold.co/100x100/06b6d4/ffffff?text=QR', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['React Native', 'JavaScript', 'Redux', 'TypeScript'], softSkills: ['Créativité', 'Autonomie', 'Proactivité'], experience: 'Confirmé', availability: 'Sous 1 mois', portfolioLink: 'https://example.com', education: [{ year: '2016-2019', degree: 'Licence Développement Mobile', school: 'Université Paris Diderot'}], certifications: ['React Native Certified'], background: [{ year: '2019-2024', role: 'Développeur Mobile', company: 'Mobile First SA'}], description: '5 ans d\'expérience en développement d\'applications mobiles.' },
                    { id: 36, type: 'candidate', name: 'Rachel Simon', title: 'UX/UI Designer', avatar: 'https://placehold.co/100x100/a855f7/ffffff?text=RS', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Figma', 'Sketch', 'Prototyping', 'Design System'], softSkills: ['Empathie', 'Créativité', 'Collaboration'], experience: 'Confirmé', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2015-2018', degree: 'Master Design Interactif', school: 'École de Design Nantes'}], certifications: ['Adobe XD Certified', 'UX Design Institute'], background: [{ year: '2020-2024', role: 'Lead UX Designer', company: 'DesignLab'}, { year: '2018-2020', role: 'UI Designer', company: 'Creative Studio'}], description: 'Experte en création d\'expériences utilisateur centrées sur l\'humain.' },
                    { id: 37, type: 'candidate', name: 'Stéphane Laurent', title: 'Administrateur Systèmes Linux', avatar: 'https://placehold.co/100x100/dc2626/ffffff?text=SL', location: { lat: 50.6292, lon: 3.0573 }, city: 'Lille', tags: ['Linux', 'Bash', 'Ansible', 'Monitoring'], softSkills: ['Rigueur', 'Problem Solving', 'Disponibilité'], experience: 'Senior', availability: 'Sous 3 mois', portfolioLink: 'https://example.com', education: [{ year: '2008-2010', degree: 'Master Systèmes et Réseaux', school: 'Polytech Lille'}], certifications: ['RHCE', 'Linux Foundation Certified'], background: [{ year: '2015-2024', role: 'Administrateur Senior', company: 'Hosting Solutions'}, { year: '2010-2015', role: 'Administrateur Systèmes', company: 'IT Services'}], description: '14 ans d\'expertise en administration de systèmes critiques.' },
                    { id: 38, type: 'candidate', name: 'Thibault Morel', title: 'Ingénieur Cybersécurité', avatar: 'https://placehold.co/100x100/0ea5e9/ffffff?text=TM', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Pentesting', 'SOC', 'SIEM', 'Incident Response'], softSkills: ['Analytique', 'Éthique', 'Discrétion'], experience: 'Confirmé', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2016-2019', degree: 'Master Cybersécurité', school: 'ESIEA'}], certifications: ['CEH', 'OSCP', 'GIAC'], background: [{ year: '2019-2024', role: 'Pentester', company: 'SecureNet'}], description: '5 ans en tests d\'intrusion et réponse aux incidents.' },
                    { id: 39, type: 'candidate', name: 'Valérie Thomas', title: 'Product Owner', avatar: 'https://placehold.co/100x100/8b5cf6/ffffff?text=VT', location: { lat: 43.2965, lon: 5.3698 }, city: 'Marseille', tags: ['Product Management', 'User Stories', 'Roadmap', 'Analytics'], softSkills: ['Vision', 'Communication', 'Décision'], experience: 'Confirmé', availability: 'Sous 1 mois', portfolioLink: 'https://example.com', education: [{ year: '2013-2016', degree: 'Master Product Management', school: 'Grenoble École de Management'}], certifications: ['CSPO', 'Product Management Certified'], background: [{ year: '2018-2024', role: 'Product Owner', company: 'SaaS Company'}, { year: '2016-2018', role: 'Business Analyst', company: 'Tech Corp'}], description: '8 ans d\'expérience en gestion de produits digitaux.' },
                    { id: 40, type: 'candidate', name: 'William Bernard', title: 'Développeur PHP/Symfony', avatar: 'https://placehold.co/100x100/ef4444/ffffff?text=WB', location: { lat: 47.2184, lon: -1.5536 }, city: 'Nantes', tags: ['PHP', 'Symfony', 'MySQL', 'API Platform'], softSkills: ['Autonomie', 'Rigueur', 'Collaboration'], experience: 'Confirmé', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2014-2017', degree: 'Licence Informatique', school: 'Université de Nantes'}], certifications: ['Symfony Certified Developer'], background: [{ year: '2017-2024', role: 'Développeur Backend', company: 'Web Solutions'}], description: '7 ans de développement web avec Symfony.' },
                    { id: 41, type: 'candidate', name: 'Xavier Petit', title: 'Consultant BI', avatar: 'https://placehold.co/100x100/22c55e/ffffff?text=XP', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Power BI', 'Tableau', 'SQL', 'ETL'], softSkills: ['Analytique', 'Pédagogue', 'Communication'], experience: 'Confirmé', availability: 'Sous 2 mois', portfolioLink: 'https://example.com', education: [{ year: '2015-2018', degree: 'Master Data Science', school: 'ESSEC'}], certifications: ['Microsoft Power BI Certified', 'Tableau Desktop Specialist'], background: [{ year: '2018-2024', role: 'Consultant BI', company: 'Business Intelligence Corp'}], description: '6 ans d\'expertise en Business Intelligence et DataViz.' },
                    { id: 42, type: 'candidate', name: 'Yolande Martin', title: 'Ingénieur Tests Automatisés', avatar: 'https://placehold.co/100x100/f43f5e/ffffff?text=YM', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Selenium', 'Cucumber', 'JUnit', 'CI/CD'], softSkills: ['Minutieux', 'Méthodique', 'Persévérance'], experience: 'Confirmé', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2016-2018', degree: 'Master Qualité Logicielle', school: 'Université Lyon 1'}], certifications: ['ISTQB Advanced', 'Selenium Certified'], background: [{ year: '2018-2024', role: 'Ingénieur QA', company: 'Quality Solutions'}], description: '6 ans en automatisation de tests et assurance qualité.' },
                    { id: 43, type: 'candidate', name: 'Zoé Dupuis', title: 'Développeuse Full Stack JS', avatar: 'https://placehold.co/100x100/84cc16/ffffff?text=ZD', location: { lat: 43.6047, lon: 1.4442 }, city: 'Toulouse', tags: ['Node.js', 'React', 'MongoDB', 'Express'], softSkills: ['Créativité', 'Collaboration', 'Adaptabilité'], experience: 'Junior', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2020-2023', degree: 'Licence Développement Web', school: 'IUT Toulouse'}], certifications: ['Node.js Certified Developer'], background: [{ year: '2023-2024', role: 'Développeuse Junior', company: 'StartUp Tech'}], description: 'Jeune développeuse passionnée par l\'écosystème JavaScript.' },
                    { id: 44, type: 'candidate', name: 'Antoine Dumas', title: 'Architecte Solutions', avatar: 'https://placehold.co/100x100/06b6d4/ffffff?text=AD', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Architecture', 'Cloud', 'Microservices', 'Event-Driven'], softSkills: ['Vision', 'Leadership', 'Communication'], experience: 'Senior', availability: 'Sous 3 mois', portfolioLink: 'https://example.com', education: [{ year: '2007-2012', degree: 'Ingénieur Télécom', school: 'Télécom ParisTech'}], certifications: ['AWS Solutions Architect Pro', 'Azure Architect Expert'], background: [{ year: '2015-2024', role: 'Architecte', company: 'Enterprise Tech'}, { year: '2012-2015', role: 'Lead Developer', company: 'Software House'}], description: '12 ans en architecture de systèmes distribués complexes.' },
                    { id: 45, type: 'candidate', name: 'Béatrice Faure', title: 'Responsable CRM', avatar: 'https://placehold.co/100x100/a855f7/ffffff?text=BF', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Salesforce', 'CRM', 'Marketing Automation', 'Analytics'], softSkills: ['Stratégie', 'Organisation', 'Relationnel'], experience: 'Confirmé', availability: 'Sous 1 mois', portfolioLink: 'https://example.com', education: [{ year: '2013-2016', degree: 'Master Marketing', school: 'IAE Lyon'}], certifications: ['Salesforce Administrator', 'Pardot Specialist'], background: [{ year: '2018-2024', role: 'CRM Manager', company: 'Retail Corp'}, { year: '2016-2018', role: 'CRM Specialist', company: 'E-commerce'}], description: '8 ans en gestion de la relation client et marketing automation.' },
                    { id: 46, type: 'candidate', name: 'Cédric Lambert', title: 'Ingénieur Machine Learning', avatar: 'https://placehold.co/100x100/f59e0b/ffffff?text=CL', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Machine Learning', 'Deep Learning', 'Python', 'TensorFlow'], softSkills: ['Innovation', 'Curiosité', 'Rigueur'], experience: 'Confirmé', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2015-2018', degree: 'Master IA', school: 'Université Paris-Saclay'}], certifications: ['Google ML Engineer', 'Deep Learning Specialization'], background: [{ year: '2018-2024', role: 'ML Engineer', company: 'AI Lab'}], description: '6 ans en développement de modèles de Machine Learning.' },
                    { id: 47, type: 'candidate', name: 'Delphine Rousseau', title: 'Développeuse Mobile Android', avatar: 'https://placehold.co/100x100/10b981/ffffff?text=DR', location: { lat: 43.6047, lon: 1.4442 }, city: 'Toulouse', tags: ['Android', 'Kotlin', 'Jetpack Compose', 'MVVM'], softSkills: ['Créativité', 'Perfectionniste', 'Collaboration'], experience: 'Confirmé', availability: 'Sous 1 mois', portfolioLink: 'https://example.com', education: [{ year: '2016-2019', degree: 'Master Informatique Mobile', school: 'Université Paul Sabatier'}], certifications: ['Google Associate Android Developer'], background: [{ year: '2019-2024', role: 'Android Developer', company: 'Mobile Innovations'}], description: '5 ans de développement d\'applications Android natives.' },
                    { id: 48, type: 'candidate', name: 'Édouard Mercier', title: 'Consultant ERP', avatar: 'https://placehold.co/100x100/ec4899/ffffff?text=EM', location: { lat: 47.2184, lon: -1.5536 }, city: 'Nantes', tags: ['SAP', 'Oracle', 'ERP', 'Business Process'], softSkills: ['Conseil', 'Adaptabilité', 'Communication'], experience: 'Senior', availability: 'Sous 2 mois', portfolioLink: 'https://example.com', education: [{ year: '2008-2011', degree: 'Master Systèmes d\'Information', school: 'Audencia'}], certifications: ['SAP Certified', 'Oracle ERP Cloud'], background: [{ year: '2015-2024', role: 'Consultant Senior SAP', company: 'Big Consulting'}, { year: '2011-2015', role: 'Consultant ERP', company: 'IT Advisory'}], description: '13 ans d\'expérience en déploiement de solutions ERP.' },
                    { id: 49, type: 'candidate', name: 'Fabienne Giraud', title: 'Responsable E-Commerce', avatar: 'https://placehold.co/100x100/3b82f6/ffffff?text=FG', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['E-Commerce', 'Shopify', 'Magento', 'Conversion'], softSkills: ['Stratégie', 'Créativité', 'ROI Focus'], experience: 'Confirmé', availability: 'Immédiate', portfolioLink: 'https://example.com', education: [{ year: '2014-2017', degree: 'Master E-Business', school: 'ESCP Europe'}], certifications: ['Shopify Partner', 'Google Analytics Certified'], background: [{ year: '2019-2024', role: 'E-Commerce Manager', company: 'Fashion Retail'}, { year: '2017-2019', role: 'Digital Manager', company: 'Online Shop'}], description: '7 ans en gestion de sites e-commerce à fort trafic.' },
                    { id: 50, type: 'candidate', name: 'Gérard Blanc', title: 'Expert Blockchain', avatar: 'https://placehold.co/100x100/8b5cf6/ffffff?text=GB', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Blockchain', 'Solidity', 'Ethereum', 'Web3'], softSkills: ['Innovation', 'Pédagogue', 'Visionnaire'], experience: 'Senior', availability: 'Sous 3 mois', portfolioLink: 'https://example.com', education: [{ year: '2010-2013', degree: 'PhD Cryptographie', school: 'INSA Lyon'}], certifications: ['Certified Blockchain Expert', 'Ethereum Developer'], background: [{ year: '2017-2024', role: 'Blockchain Architect', company: 'Crypto Solutions'}, { year: '2013-2017', role: 'Security Expert', company: 'FinTech Corp'}], description: '11 ans d\'expertise en blockchain et cryptographie.' },
                    // Additional job offers (51-80)
                    { id: 51, type: 'job', title: 'Lead Développeur Java', company: 'Enterprise Systems', logo: 'https://placehold.co/100x100/dc2626/ffffff?text=ES', companyDescription: 'Leader européen des solutions d\'entreprise avec 5000+ employés et présence dans 15 pays.', industry: 'Tech', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Java', 'Spring Boot', 'Microservices', 'Kafka'], softSkills: ['Leadership', 'Mentoring', 'Architecture'], experience: 'Senior', salary: 90000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Dirigez une équipe de 8 développeurs sur des projets d\'envergure internationale.' },
                    { id: 52, type: 'job', title: 'Data Engineer', company: 'Analytics Pro', logo: 'https://placehold.co/100x100/0ea5e9/ffffff?text=AP', companyDescription: 'Startup en hyper-croissance spécialisée en analytics prédictifs, levée de fonds de 50M€.', industry: 'Data', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Python', 'Airflow', 'BigQuery', 'dbt'], softSkills: ['Analytique', 'Autonomie', 'Innovation'], experience: 'Confirmé', salary: 68000, contract: 'CDI', workArrangement: 'Télétravail', acceptsSpontaneous: true, description: 'Construisez des pipelines de données pour nos clients grands comptes.' },
                    { id: 53, type: 'job', title: 'DevOps Engineer', company: 'CloudNative Solutions', logo: 'https://placehold.co/100x100/22c55e/ffffff?text=CNS', companyDescription: 'Expert en transformation cloud et DevOps, partenaire premium AWS et Azure.', industry: 'Cloud', location: { lat: 47.2184, lon: -1.5536 }, city: 'Nantes', tags: ['Kubernetes', 'Terraform', 'CI/CD', 'Monitoring'], softSkills: ['Problem Solving', 'Collaboration', 'Automation'], experience: 'Confirmé', salary: 65000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Automatisez et optimisez les infrastructures cloud de nos clients.' },
                    { id: 54, type: 'job', title: 'Scrum Master', company: 'Agile Transform', logo: 'https://placehold.co/100x100/f59e0b/ffffff?text=AT', companyDescription: 'Cabinet de conseil spécialisé en transformation agile des grandes organisations.', industry: 'Conseil', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Scrum', 'SAFe', 'Coaching', 'Change Management'], softSkills: ['Facilitation', 'Communication', 'Leadership'], experience: 'Confirmé', salary: 62000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Accompagnez les équipes dans leur transformation agile.' },
                    { id: 55, type: 'job', title: 'Architecte Microservices', company: 'Tech Solutions Inc.', logo: 'https://placehold.co/100x100/3b82f6/ffffff?text=TSI', companyDescription: 'Leader en solutions logicielles B2B, nous innovons constamment pour nos clients.', industry: 'Tech', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Architecture', 'Docker', 'Kubernetes', 'API Gateway'], softSkills: ['Vision', 'Communication', 'Mentoring'], experience: 'Senior', salary: 98000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Concevez l\'architecture de nos nouvelles plateformes microservices.' },
                    { id: 56, type: 'job', title: 'Front-End Developer React', company: 'Digital Creators', logo: 'https://placehold.co/100x100/a855f7/ffffff?text=DC', companyDescription: 'Agence digitale créative primée pour ses interfaces innovantes et design thinking.', industry: 'Digital', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['React', 'Next.js', 'TypeScript', 'Styled Components'], softSkills: ['Créativité', 'Attention aux détails', 'Collaboration'], experience: 'Confirmé', salary: 55000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: false, description: 'Créez des interfaces web modernes et performantes pour nos clients.' },
                    { id: 57, type: 'job', title: 'Responsable Sécurité SI', company: 'CyberGuard', logo: 'https://placehold.co/100x100/dc2626/ffffff?text=CG', companyDescription: 'Leader français de la cybersécurité, 2000 clients protégés dont 50+ du CAC40.', industry: 'Sécurité', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['CISO', 'ISO 27001', 'Risk Management', 'SOC'], softSkills: ['Leadership', 'Stratégie', 'Communication'], experience: 'Senior', salary: 105000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Définissez et pilotez la stratégie de sécurité de l\'information.' },
                    { id: 58, type: 'job', title: 'Développeur Python Django', company: 'WebPython Pro', logo: 'https://placehold.co/100x100/10b981/ffffff?text=WPP', companyDescription: 'Expert en développement web Python avec 200+ projets réussis.', industry: 'Tech', location: { lat: 43.6047, lon: 1.4442 }, city: 'Toulouse', tags: ['Python', 'Django', 'REST API', 'PostgreSQL'], softSkills: ['Rigueur', 'Autonomie', 'Documentation'], experience: 'Confirmé', salary: 58000, contract: 'CDI', workArrangement: 'Télétravail', acceptsSpontaneous: true, description: 'Développez des applications web robustes avec Django.' },
                    { id: 59, type: 'job', title: 'UX Designer Senior', company: 'Design Studio Elite', logo: 'https://placehold.co/100x100/ec4899/ffffff?text=DSE', companyDescription: 'Studio de design primé internationalement, spécialisé en UX/UI haut de gamme.', industry: 'Design', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['UX Design', 'User Research', 'Prototyping', 'Design Systems'], softSkills: ['Empathie', 'Créativité', 'Collaboration'], experience: 'Senior', salary: 72000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: false, description: 'Concevez des expériences utilisateur exceptionnelles pour nos clients prestigieux.' },
                    { id: 60, type: 'job', title: 'Développeur Mobile Flutter', company: 'MobileFirst', logo: 'https://placehold.co/100x100/06b6d4/ffffff?text=MF', companyDescription: 'Agence mobile spécialisée Flutter avec 100+ apps publiées sur les stores.', industry: 'Mobile', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Flutter', 'Dart', 'Firebase', 'BLoC'], softSkills: ['Créativité', 'Proactivité', 'Qualité'], experience: 'Confirmé', salary: 60000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Développez des applications mobiles cross-platform performantes.' },
                    { id: 61, type: 'job', title: 'Chef de Projet Digital', company: 'Digital Agency 360', logo: 'https://placehold.co/100x100/8b5cf6/ffffff?text=DA3', companyDescription: 'Agence digitale full-service, 150 collaborateurs, top 10 des agences françaises.', industry: 'Digital', location: { lat: 47.2184, lon: -1.5536 }, city: 'Nantes', tags: ['Gestion de Projet', 'Agile', 'Client Management', 'Budget'], softSkills: ['Organisation', 'Communication', 'Leadership'], experience: 'Confirmé', salary: 58000, contract: 'CDI', workArrangement: 'Sur site', acceptsSpontaneous: true, description: 'Pilotez des projets digitaux de A à Z pour des clients variés.' },
                    { id: 62, type: 'job', title: 'Ingénieur ML/AI', company: 'AI Research Lab', logo: 'https://placehold.co/100x100/f59e0b/ffffff?text=ARL', companyDescription: 'Centre de recherche en IA appliquée, partenariats avec les meilleures universités.', industry: 'IA', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Machine Learning', 'Deep Learning', 'NLP', 'Computer Vision'], softSkills: ['Recherche', 'Innovation', 'Collaboration'], experience: 'Senior', salary: 88000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Menez des projets de recherche en IA appliquée à l\'industrie.' },
                    { id: 63, type: 'job', title: 'Développeur .NET Core', company: 'Microsoft Partner Gold', logo: 'https://placehold.co/100x100/3b82f6/ffffff?text=MPG', companyDescription: 'Partenaire Gold Microsoft depuis 15 ans, expert en solutions .NET d\'entreprise.', industry: 'Tech', location: { lat: 43.2965, lon: 5.3698 }, city: 'Marseille', tags: ['.NET Core', 'C#', 'Azure', 'Entity Framework'], softSkills: ['Rigueur', 'Collaboration', 'Innovation'], experience: 'Confirmé', salary: 62000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Développez des applications d\'entreprise avec les technologies Microsoft.' },
                    { id: 64, type: 'job', title: 'Consultant SAP Senior', company: 'BusinessTech', logo: 'https://placehold.co/100x100/84cc16/ffffff?text=BT', companyDescription: 'Cabinet de conseil spécialisé en transformation digitale et ERP.', industry: 'Conseil', location: { lat: 48.1173, lon: -1.6778 }, city: 'Rennes', tags: ['SAP S/4HANA', 'ABAP', 'Fiori', 'Integration'], softSkills: ['Conseil', 'Client Focus', 'Leadership'], experience: 'Senior', salary: 85000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Accompagnez nos clients dans leurs transformations SAP S/4HANA.' },
                    { id: 65, type: 'job', title: 'Analyste Cybersécurité', company: 'SecureSoft', logo: 'https://placehold.co/100x100/dc2626/ffffff?text=SS', companyDescription: 'Éditeur de solutions de cybersécurité pour les entreprises.', industry: 'Sécurité', location: { lat: 43.6047, lon: 1.4442 }, city: 'Toulouse', tags: ['SOC', 'SIEM', 'Threat Intelligence', 'Incident Response'], softSkills: ['Analytique', 'Vigilance', 'Communication'], experience: 'Confirmé', salary: 66000, contract: 'CDI', workArrangement: 'Sur site', acceptsSpontaneous: true, description: 'Analysez et répondez aux menaces de sécurité pour nos clients.' },
                    { id: 66, type: 'job', title: 'Product Manager SaaS', company: 'InnovateTech', logo: 'https://placehold.co/100x100/ef4444/ffffff?text=IT', companyDescription: 'Scale-up en pleine croissance dans le domaine de la fintech.', industry: 'Finance', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Product Strategy', 'Roadmap', 'Analytics', 'A/B Testing'], softSkills: ['Vision', 'Data-Driven', 'Leadership'], experience: 'Confirmé', salary: 75000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Définissez la stratégie produit de notre plateforme SaaS en forte croissance.' },
                    { id: 67, type: 'job', title: 'Développeur iOS Swift', company: 'AppFactory', logo: 'https://placehold.co/100x100/8b5cf6/ffffff?text=AF', companyDescription: 'Startup innovante spécialisée dans les applications mobiles pour le secteur de la santé.', industry: 'Tech', location: { lat: 43.2965, lon: 5.3698 }, city: 'Marseille', tags: ['Swift', 'SwiftUI', 'Combine', 'HealthKit'], softSkills: ['Créativité', 'Rigueur', 'Qualité'], experience: 'Confirmé', salary: 60000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Créez des applications iOS innovantes dans le domaine de la santé.' },
                    { id: 68, type: 'job', title: 'Administrateur Cloud AWS', company: 'CloudMasters', logo: 'https://placehold.co/100x100/14b8a6/ffffff?text=CM', companyDescription: 'Cabinet de conseil en architecture cloud et transformation digitale.', industry: 'Conseil', location: { lat: 47.2184, lon: -1.5536 }, city: 'Nantes', tags: ['AWS', 'CloudFormation', 'Lambda', 'ECS'], softSkills: ['Rigueur', 'Autonomie', 'Documentation'], experience: 'Confirmé', salary: 68000, contract: 'CDI', workArrangement: 'Télétravail', acceptsSpontaneous: true, description: 'Administrez et optimisez les infrastructures AWS de nos clients.' },
                    { id: 69, type: 'job', title: 'Designer UI/UX', company: 'Creative Minds', logo: 'https://placehold.co/100x100/ec4899/ffffff?text=CM', companyDescription: 'Agence de design primée, nous créons des expériences digitales mémorables.', industry: 'Design', location: { lat: 45.7578, lon: 4.8320 }, city: 'Lyon', tags: ['Figma', 'Adobe XD', 'Prototyping', 'UI Design'], softSkills: ['Créativité', 'Empathie', 'Collaboration'], experience: 'Confirmé', salary: 52000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: false, description: 'Créez des interfaces utilisateur élégantes et intuitives.' },
                    { id: 70, type: 'job', title: 'Data Scientist IA', company: 'DataCorp', logo: 'https://placehold.co/100x100/10b981/ffffff?text=DC', companyDescription: 'Nous transformons les données en décisions stratégiques pour les entreprises du CAC40.', industry: 'Data', location: { lat: 48.8698, lon: 2.3344 }, city: 'Paris', tags: ['Python', 'TensorFlow', 'NLP', 'MLOps'], softSkills: ['Analytique', 'Curiosité', 'Communication'], experience: 'Senior', salary: 92000, contract: 'CDI', workArrangement: 'Télétravail', acceptsSpontaneous: true, description: 'Développez des modèles d\'IA pour résoudre des problèmes business complexes.' },
                    { id: 71, type: 'job', title: 'Tech Lead Full-Stack', company: 'Digital Innovators', logo: 'https://placehold.co/100x100/0ea5e9/ffffff?text=DI', companyDescription: 'Scale-up innovante en forte croissance, levée de série B de 30M€.', industry: 'Tech', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['React', 'Node.js', 'TypeScript', 'GraphQL'], softSkills: ['Leadership', 'Mentoring', 'Architecture'], experience: 'Senior', salary: 85000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Dirigez l\'équipe technique et définissez l\'architecture de nos produits.' },
                    { id: 72, type: 'job', title: 'Ingénieur Réseau', company: 'Network Solutions', logo: 'https://placehold.co/100x100/22c55e/ffffff?text=NS', companyDescription: 'Expert en infrastructure réseau et sécurité pour les entreprises.', industry: 'Infrastructure', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Cisco', 'Routing', 'Switching', 'Firewall'], softSkills: ['Rigueur', 'Problem Solving', 'Disponibilité'], experience: 'Confirmé', salary: 60000, contract: 'CDI', workArrangement: 'Sur site', acceptsSpontaneous: true, description: 'Concevez et maintenez les infrastructures réseau de nos clients.' },
                    { id: 73, type: 'job', title: 'Consultant Business Intelligence', company: 'BI Excellence', logo: 'https://placehold.co/100x100/a855f7/ffffff?text=BIE', companyDescription: 'Cabinet spécialisé en BI et analytics pour les décideurs.', industry: 'Conseil', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Power BI', 'SQL', 'Data Modeling', 'DAX'], softSkills: ['Analytique', 'Pédagogue', 'Client Focus'], experience: 'Confirmé', salary: 70000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Aidez nos clients à exploiter leurs données pour la prise de décision.' },
                    { id: 74, type: 'job', title: 'Développeur Vue.js', company: 'Web Innovators', logo: 'https://placehold.co/100x100/f59e0b/ffffff?text=WI', companyDescription: 'Agence web spécialisée en applications Vue.js modernes et performantes.', industry: 'Web', location: { lat: 43.6047, lon: 1.4442 }, city: 'Toulouse', tags: ['Vue.js', 'Vuex', 'Nuxt', 'Composition API'], softSkills: ['Créativité', 'Collaboration', 'Qualité'], experience: 'Confirmé', salary: 56000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Développez des applications web interactives avec Vue.js.' },
                    { id: 75, type: 'job', title: 'Ingénieur QA Automation', company: 'Quality First', logo: 'https://placehold.co/100x100/dc2626/ffffff?text=QF', companyDescription: 'Spécialiste de la qualité logicielle et de l\'automatisation des tests.', industry: 'QA', location: { lat: 47.2184, lon: -1.5536 }, city: 'Nantes', tags: ['Selenium', 'Cypress', 'Jest', 'CI/CD'], softSkills: ['Minutieux', 'Méthodique', 'Automation'], experience: 'Confirmé', salary: 58000, contract: 'CDI', workArrangement: 'Télétravail', acceptsSpontaneous: true, description: 'Mettez en place des stratégies de tests automatisés robustes.' },
                    { id: 76, type: 'job', title: 'Architecte Cloud Azure', company: 'Azure Experts', logo: 'https://placehold.co/100x100/3b82f6/ffffff?text=AE', companyDescription: 'Partenaire Microsoft Gold, expert en solutions cloud Azure.', industry: 'Cloud', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Azure', 'ARM Templates', 'DevOps', 'Architecture'], softSkills: ['Vision', 'Communication', 'Leadership'], experience: 'Senior', salary: 95000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Concevez des architectures cloud Azure scalables et sécurisées.' },
                    { id: 77, type: 'job', title: 'Responsable Marketing Digital', company: 'Marketing Masters', logo: 'https://placehold.co/100x100/ec4899/ffffff?text=MM', companyDescription: 'Agence de marketing digital multi-primée, 10 ans d\'expertise.', industry: 'Marketing', location: { lat: 45.7640, lon: 4.8357 }, city: 'Lyon', tags: ['Marketing Digital', 'SEO', 'SEA', 'Social Media'], softSkills: ['Stratégie', 'Créativité', 'ROI Focus'], experience: 'Senior', salary: 72000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Pilotez les stratégies marketing digital de nos clients.' },
                    { id: 78, type: 'job', title: 'Développeur Golang', company: 'Go Systems', logo: 'https://placehold.co/100x100/06b6d4/ffffff?text=GS', companyDescription: 'Startup spécialisée en systèmes distribués haute performance avec Go.', industry: 'Tech', location: { lat: 48.8566, lon: 2.3522 }, city: 'Paris', tags: ['Golang', 'Microservices', 'gRPC', 'Docker'], softSkills: ['Performance', 'Rigueur', 'Innovation'], experience: 'Confirmé', salary: 70000, contract: 'CDI', workArrangement: 'Télétravail', acceptsSpontaneous: true, description: 'Développez des systèmes distribués performants en Go.' },
                    { id: 79, type: 'job', title: 'Business Analyst Senior', company: 'BusinessTech', logo: 'https://placehold.co/100x100/84cc16/ffffff?text=BT', companyDescription: 'Cabinet de conseil spécialisé en transformation digitale et ERP.', industry: 'Conseil', location: { lat: 48.1173, lon: -1.6778 }, city: 'Rennes', tags: ['Business Analysis', 'UML', 'Agile', 'Requirements'], softSkills: ['Analyse', 'Communication', 'Synthèse'], experience: 'Senior', salary: 68000, contract: 'CDI', workArrangement: 'Hybride', acceptsSpontaneous: true, description: 'Analysez et modélisez les processus métiers complexes de nos clients.' },
                    { id: 80, type: 'job', title: 'Développeur Ruby on Rails', company: 'Rails Developers', logo: 'https://placehold.co/100x100/dc2626/ffffff?text=RD', companyDescription: 'Agence spécialisée en développement Ruby on Rails depuis 2010.', industry: 'Web', location: { lat: 43.6047, lon: 1.4442 }, city: 'Toulouse', tags: ['Ruby', 'Rails', 'PostgreSQL', 'Sidekiq'], softSkills: ['Qualité', 'Testing', 'Collaboration'], experience: 'Confirmé', salary: 60000, contract: 'CDI', workArrangement: 'Télétravail', acceptsSpontaneous: true, description: 'Développez des applications web robustes avec Ruby on Rails.' }
                ];

                const createModal = (id, content) => { const modal = document.createElement('div'); modal.id = id; modal.className = 'modal-backdrop fixed inset-0 bg-black bg-opacity-60 dark:bg-opacity-70 z-[1050] hidden items-center justify-center'; modal.innerHTML = content; ui.modalContainer.appendChild(modal); };
                const modals = {
                    details: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl m-4 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button><div id="details-modal-content" class="overflow-y-auto"></div></div>',
                    login: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md m-4 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button><div class="overflow-y-auto p-8"><h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Connexion</h2><form id="login-form"><div class="mb-4"><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label><input type="email" name="email" value="recruteur@jobmap.com" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg" required></div><div class="mb-6"><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Mot de passe</label><input type="password" name="password" value="password" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg" required></div><button type="submit" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition shadow-lg">Se connecter</button></form></div></div>',
                    signupCandidate: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg m-4 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button><div class="overflow-y-auto p-8"><h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Créer un profil Candidat</h2><form id="signup-candidate-form" class="space-y-4"><input name="name" placeholder="Nom complet" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><input name="email" type="email" placeholder="Email" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><input name="password" type="password" placeholder="Mot de passe" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><input name="title" placeholder="Titre du profil (ex: Développeur Web)" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><textarea name="tags" placeholder="Compétences (séparées par des virgules)" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required></textarea><button type="submit" class="w-full bg-emerald-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-emerald-700 transition">Créer mon profil</button></form></div></div>',
                    signupRecruiter: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md m-4 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button><div class="overflow-y-auto p-8"><h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Créer un compte Recruteur</h2><form id="signup-recruiter-form" class="space-y-4"><input name="name" placeholder="Votre nom" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><input name="email" type="email" placeholder="Email professionnel" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><input name="password" type="password" placeholder="Mot de passe" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><input name="company" placeholder="Nom de l\'entreprise" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 transition">Créer mon compte</button></form></div></div>',
                    signupEmployer: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md m-4 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button><div class="overflow-y-auto p-8"><h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Créer un compte Employeur</h2><form id="signup-employer-form" class="space-y-4"><input name="companyName" placeholder="Nom de l\'entreprise" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><input name="name" placeholder="Votre nom" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><input name="email" type="email" placeholder="Email professionnel" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><input name="password" type="password" placeholder="Mot de passe" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><input name="siret" placeholder="Numéro SIRET" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><button type="submit" class="w-full bg-sky-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-sky-700 transition">Créer mon compte</button></form></div></div>',
                    postJob: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl m-4 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button><div class="overflow-y-auto p-8"><h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Poster une nouvelle offre</h2><form id="post-job-form" class="space-y-4"><input name="title" placeholder="Titre du poste" class="w-full p-2 border rounded dark:bg-gray-700" required><input name="company" placeholder="Nom de l\'entreprise" class="w-full p-2 border rounded dark:bg-gray-700" required><input name="city" placeholder="Ville" class="w-full p-2 border rounded dark:bg-gray-700" required><textarea name="description" placeholder="Description du poste" class="w-full p-2 border rounded dark:bg-gray-700" rows="4" required></textarea><input name="tags" placeholder="Compétences techniques (virgules)" class="w-full p-2 border rounded dark:bg-gray-700" required><input name="softSkills" placeholder="Compétences comportementales (virgules)" class="w-full p-2 border rounded dark:bg-gray-700" required><select name="experience" class="w-full p-2 border rounded dark:bg-gray-700" required><option>Junior</option><option>Confirmé</option><option>Senior</option></select><input name="salary" type="number" placeholder="Salaire annuel brut" class="w-full p-2 border rounded dark:bg-gray-700" required><button type="submit" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700">Publier l\'offre</button></form></div></div>',
                    editProfile: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg m-4 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button><div class="overflow-y-auto p-8"><h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Modifier mon profil</h2><form id="edit-profile-form" class="space-y-4"></form></div></div>',
                    matchReport: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-3xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-3xl font-bold text-center mb-6 text-gray-800 dark:text-white">Rapport de Compatibilité</h2><div id="match-report-content" class="overflow-y-auto"></div></div>',
                    favorites: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Mes Favoris</h2><div id="favorites-list" class="overflow-y-auto"></div></div>',
                    dashboard: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-3xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Tableau de Bord</h2><div id="dashboard-content" class="overflow-y-auto"></div></div>',
                    company: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-3xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><div id="company-profile-content" class="overflow-y-auto"></div></div>',
                    spontaneousApplication: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl m-4 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button><div class="overflow-y-auto p-8"><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-paper-plane text-blue-500 mr-2"></i>Candidature Spontanée</h2><form id="spontaneous-application-form" class="space-y-4"><div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg mb-4"><p class="text-sm text-gray-700 dark:text-gray-300"><i class="fas fa-info-circle mr-2"></i>Envoyez votre candidature spontanée aux entreprises qui acceptent ce type de candidature.</p></div><input name="company" placeholder="Nom de l\'entreprise" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" required><textarea name="message" placeholder="Votre message de motivation..." class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600" rows="6" required></textarea><div class="flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"><i class="fas fa-file-pdf text-red-500 text-xl"></i><span class="text-sm text-gray-600 dark:text-gray-300">CV à joindre (simulation)</span></div><button type="submit" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition"><i class="fas fa-paper-plane mr-2"></i>Envoyer la candidature</button></form></div></div>',
                    messages: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-3xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-envelope mr-2"></i>Messages</h2><div id="messages-content" class="overflow-y-auto"></div></div>',
                    jobAlerts: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-bell mr-2"></i>Alertes Emploi</h2><div id="job-alerts-content" class="overflow-y-auto"></div></div>',
                    calendar: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-calendar-alt mr-2"></i>Calendrier d\'entretiens</h2><div id="calendar-content" class="overflow-y-auto"></div></div>',
                    jobComparator: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-5xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-balance-scale mr-2"></i>Comparateur d\'offres</h2><div id="comparator-content" class="overflow-y-auto"></div></div>',
                    careerCoach: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-3xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-user-tie mr-2"></i>Coach Carrière</h2><div id="career-coach-content" class="overflow-y-auto"></div></div>',
                    statistics: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-5xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-chart-area mr-2"></i>Statistiques & Analytics</h2><div id="statistics-content" class="overflow-y-auto"></div></div>',
                    settings: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-3xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-cog mr-2"></i>Paramètres</h2><div id="settings-content" class="overflow-y-auto"></div></div>',
                    notifications: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-bell mr-2"></i>Notifications</h2><div id="notifications-content" class="overflow-y-auto"></div></div>',
                    helpCenter: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-question-circle mr-2"></i>Centre d\'aide</h2><div id="help-center-content" class="overflow-y-auto"></div></div>',
                    recruitmentAnalytics: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-5xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-chart-pie mr-2"></i>Analytics Recrutement</h2><div id="recruitment-analytics-content" class="overflow-y-auto"></div></div>',
                    candidatePool: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-5xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-users mr-2"></i>Vivier de Candidats</h2><div id="candidate-pool-content" class="overflow-y-auto"></div></div>',
                    jobPerformance: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-5xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-trophy mr-2"></i>Performance des Offres</h2><div id="job-performance-content" class="overflow-y-auto"></div></div>',
                    teamCollaboration: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-users-cog mr-2"></i>Collaboration Équipe</h2><div id="team-collaboration-content" class="overflow-y-auto"></div></div>',
                    savedSearches: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-3xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-bookmark mr-2"></i>Recherches Sauvegardées</h2><div id="saved-searches-content" class="overflow-y-auto"></div></div>',
                    viewHistory: '<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-3xl m-4 p-8 transform hidden relative max-h-[90vh] flex flex-col"><button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times fa-2x"></i></button><h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-history mr-2"></i>Historique de Navigation</h2><div id="view-history-content" class="overflow-y-auto"></div></div>'
                };
                for(const [key, value] of Object.entries(modals)) { createModal(key + '-modal', value); }

                function showToast(message, type = 'info') { const el = document.createElement('div'); el.className = `toast p-4 text-white rounded-lg shadow-lg flex items-center gap-3 ${type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500'}`; el.innerHTML = `<i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i><span>${message}</span>`; document.getElementById('toast-container').appendChild(el); setTimeout(() => el.classList.add('show'), 10); setTimeout(() => { el.classList.remove('show'); el.addEventListener('transitionend', () => el.remove()); }, 3000); }
                function openModal(modalId) { closeAllModals(); const modal = document.getElementById(modalId); if (modal) { modal.classList.remove('hidden'); modal.classList.add('flex'); setTimeout(() => modal.querySelector('.modal-panel').classList.remove('hidden'), 10); } }
                function closeAllModals() { ui.modalContainer.querySelectorAll('.modal-backdrop').forEach(modal => { modal.querySelector('.modal-panel')?.classList.add('hidden'); modal.classList.add('hidden'); modal.classList.remove('flex'); }); }
                
                function updateAuthUI() { 
                    let html = '';
                    if (state.currentUser) {
                        html = `<div class="p-2 text-gray-800 dark:text-gray-100"><p class="font-semibold">${state.currentUser.name}</p><p class="text-sm text-gray-500 dark:text-gray-400">${state.currentUser.email}</p></div><hr class="my-2 dark:border-gray-700">`;
                        if(state.currentUser.type === 'recruiter' || state.currentUser.type === 'employer') {
                            html += `<a href="#" data-action="post-job" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-plus-circle w-5 text-blue-500"></i>Poster une offre</a>`;
                            html += `<a href="#" data-action="dashboard" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-chart-line w-5 text-green-500"></i>Tableau de bord</a>`;
                            html += `<a href="#" data-action="recruitment-analytics" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-chart-pie w-5 text-blue-500"></i>Analytics Recrutement</a>`;
                            html += `<a href="#" data-action="candidate-pool" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-users w-5 text-cyan-500"></i>Vivier de candidats</a>`;
                            html += `<a href="#" data-action="calendar" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-calendar-alt w-5 text-red-500"></i>Calendrier d'entretiens</a>`;
                            html += `<a href="#" data-action="show-company" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-building w-5 text-indigo-500"></i>Profil entreprise</a>`;
                            html += `<a href="#" data-action="job-performance" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-trophy w-5 text-yellow-500"></i>Performance des offres</a>`;
                            html += `<a href="#" data-action="messages" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-envelope w-5 text-purple-500"></i>Messages</a>`;
                            html += `<a href="#" data-action="team-collaboration" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-users-cog w-5 text-teal-500"></i>Collaboration Équipe</a>`;
                        }
                        if(state.currentUser.type === 'candidate') {
                           html += `<a href="#" data-action="edit-profile" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-user-edit w-5 text-blue-500"></i>Mon Profil</a>`;
                           html += `<a href="#" data-action="dashboard" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-chart-line w-5 text-green-500"></i>Mes candidatures</a>`;
                           html += `<a href="#" data-action="calendar" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-calendar-alt w-5 text-red-500"></i>Calendrier d'entretiens</a>`;
                           html += `<a href="#" data-action="job-comparator" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-balance-scale w-5 text-cyan-500"></i>Comparateur d'offres</a>`;
                           html += `<a href="#" data-action="spontaneous-application" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-paper-plane w-5 text-indigo-500"></i>Candidature spontanée</a>`;
                           html += `<a href="#" data-action="salary-insights" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-chart-bar w-5 text-teal-500"></i>Baromètre des salaires</a>`;
                           html += `<a href="#" data-action="career-coach" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-user-tie w-5 text-rose-500"></i>Coach Carrière</a>`;
                           html += `<a href="#" data-action="job-alerts" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-bell w-5 text-yellow-500"></i>Alertes emploi</a>`;
                           html += `<a href="#" data-action="messages" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-envelope w-5 text-purple-500"></i>Messages</a>`;
                        }
                        html += `<a href="#" data-action="saved-searches" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-bookmark w-5 text-orange-500"></i>Recherches sauvegardées</a>`;
                        html += `<a href="#" data-action="view-history" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-history w-5 text-gray-500"></i>Historique</a>`;
                        html += `<a href="#" data-action="statistics" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-chart-area w-5 text-emerald-500"></i>Statistiques</a>`;
                        html += `<a href="#" data-action="notifications" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-bell w-5 text-red-500"></i>Notifications<span class="ml-auto bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">3</span></a>`;
                        html += `<a href="#" data-action="settings" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-cog w-5 text-gray-500"></i>Paramètres</a>`;
                        html += `<a href="#" data-action="help-center" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-question-circle w-5 text-blue-500"></i>Centre d'aide</a>`;
                        html += `<hr class="my-2 dark:border-gray-700">`;
                        html += `<a href="#" data-action="logout" class="flex items-center gap-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md"><i class="fas fa-sign-out-alt w-5"></i>Se déconnecter</a>`;
                    } else {
                        html = `<p class="px-4 pt-2 pb-1 text-xs font-semibold text-gray-500 uppercase">S'inscrire</p>
                            <a href="#" data-action="signup-candidate" class="flex items-center gap-3 px-4 py-3 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-user-graduate w-5 text-emerald-500"></i><span>Je suis candidat</span></a>
                            <a href="#" data-action="signup-recruiter" class="flex items-center gap-3 px-4 py-3 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-user-tie w-5 text-indigo-500"></i><span>Je suis recruteur</span></a>
                            <a href="#" data-action="signup-employer" class="flex items-center gap-3 px-4 py-3 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-building w-5 text-sky-500"></i><span>Je suis employeur</span></a><hr class="my-2 dark:border-gray-700"><a href="#" data-action="login" class="flex items-center gap-3 px-4 py-3 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md"><i class="fas fa-sign-in-alt w-5"></i><span>Se connecter</span></a>`;
                    }
                    ui.userMenu.innerHTML = html;
                }
                
                function showDashboard() {
                    if (!state.currentUser) { showToast('Connectez-vous pour accéder au tableau de bord.', 'error'); openModal('login-modal'); return; }
                    
                    let content = '';
                    if (state.currentUser.type === 'candidate') {
                        const applications = state.applications ? state.applications.filter(a => a.candidateId === state.currentUser.id) : [];
                        const profileViews = Math.floor(Math.random() * 150) + 50;
                        const savedJobs = Array.from(state.favorites).filter(id => data.find(d => d.id === id && d.type === 'job')).length;
                        
                        content = `<div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg hover:shadow-lg transition cursor-pointer" onclick="showApplications()">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Candidatures</p>
                                            <p class="text-3xl font-bold text-blue-600 dark:text-blue-400">${applications.length}</p>
                                            <p class="text-xs text-gray-500 mt-1">Cliquez pour voir</p>
                                        </div>
                                        <i class="fas fa-paper-plane text-4xl text-blue-600 dark:text-blue-400 opacity-50"></i>
                                    </div>
                                </div>
                                <div class="bg-green-50 dark:bg-green-900/20 p-6 rounded-lg hover:shadow-lg transition">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Vues du profil</p>
                                            <p class="text-3xl font-bold text-green-600 dark:text-green-400">${profileViews}</p>
                                            <p class="text-xs text-green-600 dark:text-green-400 mt-1">↑ +${Math.floor(Math.random()*20)+5}% cette semaine</p>
                                        </div>
                                        <i class="fas fa-eye text-4xl text-green-600 dark:text-green-400 opacity-50"></i>
                                    </div>
                                </div>
                                <div class="bg-purple-50 dark:bg-purple-900/20 p-6 rounded-lg hover:shadow-lg transition">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Offres sauvegardées</p>
                                            <p class="text-3xl font-bold text-purple-600 dark:text-purple-400">${savedJobs}</p>
                                            <p class="text-xs text-gray-500 mt-1">Favoris</p>
                                        </div>
                                        <i class="fas fa-heart text-4xl text-purple-600 dark:text-purple-400 opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-gradient-to-r from-cyan-50 to-blue-50 dark:from-cyan-900/20 dark:to-blue-900/20 p-6 rounded-lg">
                                <h3 class="text-lg font-bold mb-4 dark:text-white"><i class="fas fa-chart-pie mr-2"></i>Activité des 30 derniers jours</h3>
                                <div class="grid grid-cols-7 gap-2">
                                    ${Array.from({length: 30}, (_, i) => {
                                        const activity = Math.random() > 0.3 ? Math.floor(Math.random() * 4) : 0;
                                        const colors = ['bg-gray-200 dark:bg-gray-700', 'bg-blue-200 dark:bg-blue-800', 'bg-blue-400 dark:bg-blue-600', 'bg-blue-600 dark:bg-blue-500'];
                                        return `<div class="${colors[activity]} h-8 rounded" title="${activity} actions"></div>`;
                                    }).join('')}
                                </div>
                                <p class="text-xs text-gray-600 dark:text-gray-400 mt-2">Vos actions quotidiennes (candidatures, recherches, consultations)</p>
                            </div>
                            
                            <div>
                                <h3 class="text-xl font-bold mb-4 dark:text-white">Mes candidatures récentes</h3>
                                ${applications.length > 0 ? `<div class="space-y-3">
                                    ${applications.slice(0, 5).map(app => {
                                        const job = data.find(j => j.id === app.jobId);
                                        if (!job) return '';
                                        const statusColors = { pending: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/40 dark:text-yellow-300', accepted: 'bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300', rejected: 'bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-300' };
                                        const statusLabels = { pending: 'En attente', accepted: 'Acceptée', rejected: 'Refusée' };
                                        return `<div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg flex justify-between items-center">
                                            <div>
                                                <h4 class="font-semibold dark:text-white">${job.title}</h4>
                                                <p class="text-sm text-gray-600 dark:text-gray-300">${job.company}</p>
                                                <p class="text-xs text-gray-500 mt-1">${new Date(app.date).toLocaleDateString('fr-FR')}</p>
                                            </div>
                                            <span class="px-3 py-1 rounded-full text-sm ${statusColors[app.status]}">${statusLabels[app.status]}</span>
                                        </div>`;
                                    }).join('')}
                                </div>` : '<p class="text-gray-500 text-center py-8">Aucune candidature pour le moment.</p>'}
                            </div>
                            
                            <div>
                                <h3 class="text-xl font-bold mb-4 dark:text-white">Recommandations pour vous</h3>
                                <div class="space-y-3">
                                    ${data.filter(item => item.type === 'job').slice(0, 3).map(job => {
                                        const matchScore = Math.floor(Math.random() * 30) + 70;
                                        return `<div class="p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg cursor-pointer hover:shadow-md transition" onclick="showDetailsModal(${job.id})">
                                            <div class="flex justify-between items-start mb-2">
                                                <h4 class="font-semibold dark:text-white">${job.title}</h4>
                                                <span class="px-3 py-1 rounded-full text-xs font-bold ${matchScore >= 85 ? 'bg-green-500 text-white' : matchScore >= 70 ? 'bg-yellow-500 text-white' : 'bg-gray-400 text-white'}">
                                                    ${matchScore}% compatible
                                                </span>
                                            </div>
                                            <p class="text-sm text-gray-600 dark:text-gray-300">${job.company} • ${job.city}</p>
                                            <div class="flex items-center gap-2 mt-2">
                                                ${job.tags.slice(0, 3).map(tag => `<span class="text-xs px-2 py-1 bg-white dark:bg-gray-800 rounded">${tag}</span>`).join('')}
                                            </div>
                                        </div>`;
                                    }).join('')}
                                </div>
                            </div>
                        </div>`;
                    } else if (state.currentUser.type === 'recruiter' || state.currentUser.type === 'employer') {
                        const myJobs = data.filter(j => j.type === 'job');
                        const totalApplications = state.applications ? state.applications.filter(a => myJobs.some(j => j.id === a.jobId)).length : 0;
                        const activeJobs = myJobs.length;
                        const candidateViews = Math.floor(Math.random() * 200) + 100;
                        
                        content = `<div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg hover:shadow-lg transition">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Offres actives</p>
                                            <p class="text-3xl font-bold text-blue-600 dark:text-blue-400">${activeJobs}</p>
                                            <p class="text-xs text-gray-500 mt-1">En ligne</p>
                                        </div>
                                        <i class="fas fa-briefcase text-4xl text-blue-600 dark:text-blue-400 opacity-50"></i>
                                    </div>
                                </div>
                                <div class="bg-green-50 dark:bg-green-900/20 p-6 rounded-lg hover:shadow-lg transition">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Candidatures reçues</p>
                                            <p class="text-3xl font-bold text-green-600 dark:text-green-400">${totalApplications}</p>
                                            <p class="text-xs text-green-600 dark:text-green-400 mt-1">↑ +${Math.floor(Math.random()*10)+5} cette semaine</p>
                                        </div>
                                        <i class="fas fa-user-check text-4xl text-green-600 dark:text-green-400 opacity-50"></i>
                                    </div>
                                </div>
                                <div class="bg-purple-50 dark:bg-purple-900/20 p-6 rounded-lg hover:shadow-lg transition">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Profils consultés</p>
                                            <p class="text-3xl font-bold text-purple-600 dark:text-purple-400">${candidateViews}</p>
                                            <p class="text-xs text-gray-500 mt-1">Ce mois-ci</p>
                                        </div>
                                        <i class="fas fa-users text-4xl text-purple-600 dark:text-purple-400 opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 p-6 rounded-lg">
                                <h3 class="text-lg font-bold mb-4 dark:text-white"><i class="fas fa-chart-line mr-2"></i>Candidatures par offre</h3>
                                <div class="space-y-3">
                                    ${myJobs.slice(0, 5).map(job => {
                                        const apps = state.applications ? state.applications.filter(a => a.jobId === job.id).length : Math.floor(Math.random() * 15);
                                        const maxApps = 20;
                                        const percentage = (apps / maxApps) * 100;
                                        return `<div>
                                            <div class="flex justify-between text-sm mb-1">
                                                <span class="dark:text-white font-medium">${job.title}</span>
                                                <span class="text-blue-600 dark:text-blue-400 font-bold">${apps}</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all" style="width: ${Math.min(percentage, 100)}%"></div>
                                            </div>
                                        </div>`;
                                    }).join('')}
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="text-xl font-bold mb-4 dark:text-white">Mes offres d'emploi</h3>
                                ${myJobs.length > 0 ? `<div class="space-y-3">
                                    ${myJobs.slice(0, 5).map(job => {
                                        const apps = state.applications ? state.applications.filter(a => a.jobId === job.id) : [];
                                        return `<div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                            <div class="flex justify-between items-start">
                                                <div class="flex-1">
                                                    <h4 class="font-semibold dark:text-white">${job.title}</h4>
                                                    <p class="text-sm text-gray-600 dark:text-gray-300">${job.city} • ${job.contract}</p>
                                                </div>
                                                <div class="text-right">
                                                    <p class="text-2xl font-bold text-blue-600 dark:text-blue-400">${apps.length}</p>
                                                    <p class="text-xs text-gray-500">candidatures</p>
                                                </div>
                                            </div>
                                        </div>`;
                                    }).join('')}
                                </div>` : '<p class="text-gray-500 text-center py-8">Aucune offre publiée pour le moment.</p>'}
                            </div>
                            
                            <div>
                                <h3 class="text-xl font-bold mb-4 dark:text-white">Candidats recommandés</h3>
                                <div class="space-y-3">
                                    ${data.filter(item => item.type === 'candidate').slice(0, 3).map(candidate => {
                                        const matchScore = Math.floor(Math.random() * 25) + 75;
                                        return `<div class="p-4 bg-gradient-to-r from-emerald-50 to-blue-50 dark:from-emerald-900/20 dark:to-blue-900/20 rounded-lg cursor-pointer hover:shadow-md transition" onclick="showDetailsModal(${candidate.id})">
                                            <div class="flex items-start gap-3">
                                                ${candidate.avatar ? `<img src="${candidate.avatar}" class="w-12 h-12 rounded-full">` : '<div class="w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center"><i class="fas fa-user text-gray-600"></i></div>'}
                                                <div class="flex-1">
                                                    <div class="flex justify-between items-start">
                                                        <h4 class="font-semibold dark:text-white">${candidate.name}</h4>
                                                        <span class="px-3 py-1 rounded-full text-xs font-bold ${matchScore >= 85 ? 'bg-green-500 text-white' : matchScore >= 70 ? 'bg-yellow-500 text-white' : 'bg-gray-400 text-white'}">
                                                            ${matchScore}% match
                                                        </span>
                                                    </div>
                                                    <p class="text-sm text-gray-600 dark:text-gray-300">${candidate.title}</p>
                                                    <div class="flex items-center gap-2 mt-2">
                                                        ${candidate.tags.slice(0, 3).map(tag => `<span class="text-xs px-2 py-1 bg-white dark:bg-gray-800 rounded">${tag}</span>`).join('')}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>`;
                                    }).join('')}
                                </div>
                            </div>
                        </div>`;
                    }
                    
                    document.getElementById('dashboard-content').innerHTML = content;
                    openModal('dashboard-modal');
                }

                function calculateRoute(start, end) { if (state.routingControl) map.removeControl(state.routingControl); state.routingControl = L.Routing.control({ waypoints: [L.latLng(start.lat, start.lon), L.latLng(end.lat, end.lon)], router: L.Routing.osrmv1({ serviceUrl: `https://router.project-osrm.org/route/v1`, profile: 'car' }), createMarker: () => null, lineOptions: { styles: [{color: '#0ea5e9', opacity: 0.8, weight: 6}] } }).addTo(map); ui.routingControls.classList.remove('hidden'); }
                function toggleMatchMode() { state.isMatchModeActive = !state.isMatchModeActive; ui.matchModeBtn.classList.toggle('active', state.isMatchModeActive); showToast(state.isMatchModeActive ? "Mode Association activé." : "Mode Association désactivé.", "info"); if (!state.isMatchModeActive && state.matchStartPoint) { state.markers.get(state.matchStartPoint.id)?._icon.classList.remove('pulsing'); state.matchStartPoint = null; } }
                function calculateAndShowMatchReport(candidate, job) { 
                    const calculateScore = (jobSkills, candidateSkills) => { 
                        const common = [...jobSkills].filter(skill => candidateSkills.has(skill)); 
                        const missing = [...jobSkills].filter(skill => !candidateSkills.has(skill)); 
                        const score = jobSkills.size > 0 ? Math.round((common.length / jobSkills.size) * 100) : 0; 
                        return { common, missing, score }; 
                    }; 
                    
                    const techReport = calculateScore(new Set(job.tags.map(t=>t.toLowerCase())), new Set(candidate.tags.map(t=>t.toLowerCase()))); 
                    const softReport = calculateScore(new Set(job.softSkills.map(t=>t.toLowerCase())), new Set(candidate.softSkills.map(t=>t.toLowerCase()))); 
                    
                    const expLevels = { 'Junior': 1, 'Confirmé': 2, 'Senior': 3 };
                    const candidateExpLevel = expLevels[candidate.experience] || 1;
                    const jobExpLevel = expLevels[job.experience] || 1;
                    const expScore = Math.max(0, 100 - Math.abs(candidateExpLevel - jobExpLevel) * 25);
                    
                    const calculateDistance = (lat1, lon1, lat2, lon2) => {
                        const R = 6371;
                        const dLat = (lat2 - lat1) * Math.PI / 180;
                        const dLon = (lon2 - lon1) * Math.PI / 180;
                        const a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon/2) * Math.sin(dLon/2);
                        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
                        return R * c;
                    };
                    const distance = calculateDistance(candidate.location.lat, candidate.location.lon, job.location.lat, job.location.lon);
                    const locationScore = Math.max(0, 100 - (distance / 100) * 100);
                    
                    const totalScore = Math.round((techReport.score * 0.5) + (softReport.score * 0.2) + (expScore * 0.2) + (locationScore * 0.1)); 
                    
                    let scoreColor, recommendation, actionText; 
                    if (totalScore >= 75) { 
                        scoreColor = 'bg-green-500 border-green-600'; 
                        recommendation = '<p class="text-lg font-semibold text-green-700 dark:text-green-400"><i class="fas fa-check-circle mr-2"></i>Excellente compatibilité ! Ce candidat correspond très bien au profil recherché.</p>'; 
                        actionText = 'Excellent match';
                    } else if (totalScore >= 60) { 
                        scoreColor = 'bg-blue-500 border-blue-600'; 
                        recommendation = '<p class="text-lg font-semibold text-blue-700 dark:text-blue-400"><i class="fas fa-thumbs-up mr-2"></i>Bonne compatibilité. Quelques compétences à développer mais le profil est prometteur.</p>'; 
                        actionText = 'Bon match';
                    } else if (totalScore >= 40) { 
                        scoreColor = 'bg-yellow-500 border-yellow-600'; 
                        recommendation = '<p class="text-lg font-semibold text-yellow-700 dark:text-yellow-400"><i class="fas fa-info-circle mr-2"></i>Compatibilité moyenne. Certaines compétences clés manquent mais une formation peut combler les lacunes.</p>'; 
                        actionText = 'Match partiel';
                    } else { 
                        scoreColor = 'bg-red-500 border-red-600'; 
                        recommendation = '<p class="text-lg font-semibold text-red-700 dark:text-red-400"><i class="fas fa-exclamation-triangle mr-2"></i>Compatibilité faible. Le profil ne correspond pas aux exigences principales du poste.</p>'; 
                        actionText = 'Match faible';
                    } 
                    
                    const listSkills = (skills, color) => skills.map(s => `<span class="bg-${color}-100 dark:bg-${color}-900/40 text-${color}-800 dark:text-${color}-300 px-2 py-1 text-sm rounded">${s}</span>`).join(' ') || '<span class="text-gray-500">Aucune</span>'; 
                    
                    const content = `<div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-center">
                            <div class="md:col-span-1 flex flex-col items-center text-center">
                                <div class="score-circle ${scoreColor} shadow-lg mb-3">${totalScore}%</div>
                                <h3 class="text-2xl font-bold dark:text-white">Score Global</h3>
                                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">${actionText}</p>
                            </div>
                            <div class="md:col-span-2">
                                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-4 rounded-lg mb-3">
                                    <div class="flex items-start gap-3 mb-3">
                                        ${candidate.avatar ? `<img src="${candidate.avatar}" class="w-16 h-16 rounded-full border-2 border-blue-500">` : ''}
                                        <div class="flex-1">
                                            <h4 class="font-bold text-lg dark:text-white">${candidate.name}</h4>
                                            <p class="text-gray-600 dark:text-gray-300 text-sm">${candidate.title}</p>
                                            <p class="text-xs text-gray-500 mt-1"><i class="fas fa-briefcase mr-1"></i>${candidate.experience} • <i class="fas fa-map-marker-alt mr-1"></i>${candidate.city}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-center my-3">
                                    <i class="fas fa-arrows-alt-v text-gray-400 text-2xl"></i>
                                </div>
                                <div class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-4 rounded-lg">
                                    <div class="flex items-start gap-3">
                                        ${job.logo ? `<img src="${job.logo}" class="w-16 h-16 rounded-lg">` : ''}
                                        <div class="flex-1">
                                            <h4 class="font-bold text-lg dark:text-white">${job.title}</h4>
                                            <p class="text-gray-600 dark:text-gray-300 text-sm">${job.company}</p>
                                            <p class="text-xs text-gray-500 mt-1"><i class="fas fa-briefcase mr-1"></i>${job.experience} • <i class="fas fa-map-marker-alt mr-1"></i>${job.city}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <hr class="dark:border-gray-600">
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg text-center">
                                <div class="text-3xl font-bold text-blue-600 dark:text-blue-400">${techReport.score}%</div>
                                <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">Compétences tech.</div>
                            </div>
                            <div class="bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg text-center">
                                <div class="text-3xl font-bold text-purple-600 dark:text-purple-400">${softReport.score}%</div>
                                <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">Soft skills</div>
                            </div>
                            <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg text-center">
                                <div class="text-3xl font-bold text-green-600 dark:text-green-400">${expScore}%</div>
                                <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">Expérience</div>
                            </div>
                            <div class="bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg text-center">
                                <div class="text-3xl font-bold text-orange-600 dark:text-orange-400">${Math.round(locationScore)}%</div>
                                <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">Proximité (${Math.round(distance)}km)</div>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="font-bold text-xl mb-4 dark:text-white"><i class="fas fa-chart-bar mr-2"></i>Analyse détaillée</h3>
                            <div class="space-y-4">
                                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-4 rounded-lg">
                                    <h4 class="font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2">
                                        <i class="fas fa-code text-blue-600"></i>
                                        Compétences techniques (${techReport.common.length}/${job.tags.length})
                                    </h4>
                                    <div class="space-y-2">
                                        ${techReport.common.length > 0 ? `<div>
                                            <p class="text-xs text-green-700 dark:text-green-400 font-semibold mb-1"><i class="fas fa-check mr-1"></i>Compétences maîtrisées:</p>
                                            <div class="flex flex-wrap gap-2">${listSkills(techReport.common, 'green')}</div>
                                        </div>` : ''}
                                        ${techReport.missing.length > 0 ? `<div>
                                            <p class="text-xs text-red-600 dark:text-red-400 font-semibold mb-1"><i class="fas fa-times mr-1"></i>Compétences à acquérir:</p>
                                            <div class="flex flex-wrap gap-2">${listSkills(techReport.missing, 'red')}</div>
                                        </div>` : ''}
                                    </div>
                                </div>
                                
                                <div class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-4 rounded-lg">
                                    <h4 class="font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2">
                                        <i class="fas fa-user-check text-purple-600"></i>
                                        Compétences comportementales (${softReport.common.length}/${job.softSkills.length})
                                    </h4>
                                    <div class="space-y-2">
                                        ${softReport.common.length > 0 ? `<div>
                                            <p class="text-xs text-green-700 dark:text-green-400 font-semibold mb-1"><i class="fas fa-check mr-1"></i>Qualités présentes:</p>
                                            <div class="flex flex-wrap gap-2">${listSkills(softReport.common, 'green')}</div>
                                        </div>` : ''}
                                        ${softReport.missing.length > 0 ? `<div>
                                            <p class="text-xs text-red-600 dark:text-red-400 font-semibold mb-1"><i class="fas fa-times mr-1"></i>Qualités recherchées:</p>
                                            <div class="flex flex-wrap gap-2">${listSkills(softReport.missing, 'red')}</div>
                                        </div>` : ''}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 p-5 rounded-lg">
                            <h3 class="font-bold text-lg mb-3 dark:text-white"><i class="fas fa-lightbulb mr-2"></i>Recommandations</h3>
                            ${recommendation}
                            ${totalScore >= 60 ? `
                                <div class="mt-4 space-y-2">
                                    <p class="text-sm font-semibold text-gray-700 dark:text-gray-300">Points forts:</p>
                                    <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
                                        ${techReport.common.length > 0 ? `<li><i class="fas fa-check text-green-600 mr-2"></i>Maîtrise ${techReport.common.length} compétences techniques clés</li>` : ''}
                                        ${softReport.common.length > 0 ? `<li><i class="fas fa-check text-green-600 mr-2"></i>Possède ${softReport.common.length} soft skills recherchées</li>` : ''}
                                        ${expScore >= 75 ? `<li><i class="fas fa-check text-green-600 mr-2"></i>Niveau d'expérience adapté</li>` : ''}
                                        ${locationScore >= 75 ? `<li><i class="fas fa-check text-green-600 mr-2"></i>Proximité géographique favorable</li>` : ''}
                                    </ul>
                                </div>
                            ` : ''}
                            ${techReport.missing.length > 0 && totalScore >= 40 ? `
                                <div class="mt-4 space-y-2">
                                    <p class="text-sm font-semibold text-gray-700 dark:text-gray-300">Axes d'amélioration:</p>
                                    <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
                                        <li><i class="fas fa-arrow-right text-orange-600 mr-2"></i>Formation sur: ${techReport.missing.slice(0, 3).join(', ')}</li>
                                    </ul>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="flex gap-4 justify-end pt-4">
                            <button class="close-modal-btn bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-100 font-bold py-3 px-6 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500">
                                Fermer
                            </button>
                            <button id="view-route-from-report" class="bg-emerald-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-emerald-700">
                                <i class="fas fa-route mr-2"></i>Voir l'itinéraire
                            </button>
                            ${state.currentUser?.type === 'recruiter' ? `<button onclick="contactCandidate(${candidate.id}); closeAllModals();" class="bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700">
                                <i class="fas fa-envelope mr-2"></i>Contacter le candidat
                            </button>` : ''}
                        </div>
                    </div>`; 
                    
                    document.getElementById('match-report-content').innerHTML = content; 
                    document.getElementById('view-route-from-report').onclick = () => { closeAllModals(); calculateRoute(candidate.location, job.location); }; 
                    openModal('matchReport-modal'); 
                }
                function toggleFavorite(id) { if (state.favorites.has(id)) { state.favorites.delete(id); showToast('Retiré des favoris.', 'info'); } else { state.favorites.add(id); showToast('Ajouté aux favoris !', 'success'); } ui.favoritesCount.textContent = state.favorites.size; ui.favoritesCount.classList.toggle('hidden', state.favorites.size === 0); ui.favoritesBtn.classList.toggle('has-favorites', state.favorites.size > 0); performSearch(); }
                
                function showDetailsModal(itemId) {
                    const item = data.find(d => d.id === itemId);
                    if (!item) return;
                    
                    // Track viewing history
                    if (!state.viewHistory.find(v => v.id === itemId)) {
                        state.viewHistory.unshift({ id: itemId, date: new Date().toISOString(), item });
                        if (state.viewHistory.length > 20) state.viewHistory.pop();
                    }
                    
                    let content = '';
                    if (item.type === 'job') {
                        const isFav = state.favorites.has(item.id);
                        const matchingCandidates = data.filter(c => c.type === 'candidate').slice(0, 3);
                        const applications = state.applications ? state.applications.filter(a => a.jobId === item.id).length : Math.floor(Math.random() * 30);
                        const publishedDays = Math.floor(Math.random() * 15) + 1;
                        
                        content = `<div class="p-6">
                            <div class="flex items-start gap-4 mb-6">
                                ${item.logo ? `<img src="${item.logo}" alt="${item.company}" class="w-20 h-20 rounded-lg shadow">` : ''}
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-2">
                                        <h2 class="text-3xl font-bold text-gray-800 dark:text-white">${item.title}</h2>
                                        <span class="px-2 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 text-xs rounded-full">Actif</span>
                                    </div>
                                    <p class="text-xl text-gray-600 dark:text-gray-300 mb-2">${item.company}</p>
                                    <div class="flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 flex-wrap">
                                        <span><i class="fas fa-map-marker-alt mr-1"></i>${item.city}</span>
                                        <span><i class="fas fa-briefcase mr-1"></i>${item.contract}</span>
                                        <span><i class="fas fa-laptop-house mr-1"></i>${item.workArrangement}</span>
                                        <span><i class="fas fa-euro-sign mr-1"></i>${item.salary?.toLocaleString('fr-FR')} €/an</span>
                                        ${item.industry ? `<span class="bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200 px-2 py-1 rounded text-xs"><i class="fas fa-industry mr-1"></i>${item.industry}</span>` : ''}
                                    </div>
                                    <div class="flex items-center gap-4 mt-2 text-xs text-gray-500">
                                        <span><i class="fas fa-clock mr-1"></i>Publié il y a ${publishedDays} jour${publishedDays > 1 ? 's' : ''}</span>
                                        <span><i class="fas fa-users mr-1"></i>${applications} candidature${applications > 1 ? 's' : ''}</span>
                                        <span><i class="fas fa-eye mr-1"></i>${Math.floor(Math.random() * 200) + 50} vues</span>
                                    </div>
                                </div>
                                <button class="favorite-icon p-3 text-2xl ${isFav ? 'text-pink-500' : 'text-gray-300'} hover:text-pink-500" data-id="${item.id}">
                                    <i class="fas fa-heart"></i>
                                </button>
                            </div>
                            
                            ${item.companyDescription ? `<div class="mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                <h3 class="font-semibold text-lg mb-2 dark:text-white"><i class="fas fa-building mr-2"></i>À propos de l'entreprise</h3>
                                <p class="text-gray-700 dark:text-gray-300 mb-3">${item.companyDescription}</p>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mt-3 mb-3">
                                    <div class="bg-white dark:bg-gray-700 p-3 rounded text-center">
                                        <p class="text-2xl font-bold text-blue-600 dark:text-blue-400">${Math.floor(Math.random() * 5000) + 100}</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Employés</p>
                                    </div>
                                    <div class="bg-white dark:bg-gray-700 p-3 rounded text-center">
                                        <p class="text-2xl font-bold text-green-600 dark:text-green-400">${Math.floor(Math.random() * 30) + 5}</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Années</p>
                                    </div>
                                    <div class="bg-white dark:bg-gray-700 p-3 rounded text-center">
                                        <p class="text-2xl font-bold text-purple-600 dark:text-purple-400">${Math.floor(Math.random() * 15) + 3}</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Bureaux</p>
                                    </div>
                                    <div class="bg-white dark:bg-gray-700 p-3 rounded text-center">
                                        <p class="text-2xl font-bold text-orange-600 dark:text-orange-400">4.${Math.floor(Math.random() * 5) + 3}</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Glassdoor</p>
                                    </div>
                                </div>
                                <button onclick="showCompanyProfile('${item.company}')" class="text-blue-600 dark:text-blue-400 hover:underline text-sm">
                                    <i class="fas fa-arrow-right mr-1"></i>Voir le profil complet de l'entreprise
                                </button>
                            </div>` : ''}
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                                <div class="bg-gradient-to-br from-cyan-50 to-blue-50 dark:from-cyan-900/20 dark:to-blue-900/20 p-4 rounded-lg">
                                    <h3 class="font-semibold mb-2 dark:text-white"><i class="fas fa-users mr-2"></i>Équipe</h3>
                                    <p class="text-2xl font-bold text-cyan-600 dark:text-cyan-400">${Math.floor(Math.random() * 20) + 5}</p>
                                    <p class="text-xs text-gray-600 dark:text-gray-400">personnes</p>
                                </div>
                                <div class="bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 p-4 rounded-lg">
                                    <h3 class="font-semibold mb-2 dark:text-white"><i class="fas fa-chart-line mr-2"></i>Croissance</h3>
                                    <p class="text-2xl font-bold text-indigo-600 dark:text-indigo-400">+${Math.floor(Math.random() * 50) + 10}%</p>
                                    <p class="text-xs text-gray-600 dark:text-gray-400">cette année</p>
                                </div>
                                <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-4 rounded-lg">
                                    <h3 class="font-semibold mb-2 dark:text-white"><i class="fas fa-rocket mr-2"></i>Projets</h3>
                                    <p class="text-2xl font-bold text-green-600 dark:text-green-400">${Math.floor(Math.random() * 10) + 3}</p>
                                    <p class="text-xs text-gray-600 dark:text-gray-400">en cours</p>
                                </div>
                            </div>
                            
                            <div class="mb-6">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-file-alt mr-2"></i>Description du poste</h3>
                                <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                                    <p class="text-gray-700 dark:text-gray-300 mb-3">${item.description}</p>
                                    <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-600">
                                        <h4 class="font-semibold mb-2 dark:text-white">Missions principales:</h4>
                                        <ul class="list-disc list-inside space-y-1 text-sm text-gray-600 dark:text-gray-400">
                                            <li>Développer et maintenir les fonctionnalités de l'application</li>
                                            <li>Collaborer avec l'équipe pour définir les besoins techniques</li>
                                            <li>Assurer la qualité du code et la documentation</li>
                                            <li>Participer aux revues de code et au mentorat</li>
                                            <li>Contribuer à l'amélioration continue des processus</li>
                                        </ul>
                                    </div>
                                    <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-600">
                                        <h4 class="font-semibold mb-2 dark:text-white">Profil recherché:</h4>
                                        <ul class="list-disc list-inside space-y-1 text-sm text-gray-600 dark:text-gray-400">
                                            <li>Expérience de ${item.experience === 'Senior' ? '5+' : item.experience === 'Confirmé' ? '2-5' : '0-2'} ans dans un poste similaire</li>
                                            <li>Maîtrise des technologies mentionnées</li>
                                            <li>Capacité à travailler en équipe</li>
                                            <li>Excellent sens de la communication</li>
                                            <li>Passion pour les nouvelles technologies</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <div class="bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-4 rounded-lg">
                                    <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-code mr-2"></i>Compétences techniques requises</h3>
                                    <div class="flex flex-wrap gap-2">
                                        ${item.tags.map(tag => `<span class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-3 py-1 rounded-full text-sm font-medium">${tag}</span>`).join('')}
                                    </div>
                                </div>
                                <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-4 rounded-lg">
                                    <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-user-check mr-2"></i>Compétences comportementales</h3>
                                    <div class="flex flex-wrap gap-2">
                                        ${item.softSkills?.map(skill => `<span class="bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-3 py-1 rounded-full text-sm font-medium">${skill}</span>`).join('') || '<span class="text-gray-500">Non spécifié</span>'}
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-6 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-5 rounded-lg">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-gift mr-2"></i>Avantages</h3>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Télétravail partiel</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Tickets restaurant</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Mutuelle santé</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>RTT</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Formation continue</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Équipement fourni</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Primes sur objectifs</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Salle de sport</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Events d'équipe</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-6">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-clipboard-list mr-2"></i>Processus de recrutement</h3>
                                <div class="space-y-3">
                                    <div class="flex items-start gap-3 bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                        <div class="w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0">1</div>
                                        <div class="flex-1">
                                            <p class="font-semibold dark:text-white">Présélection CV</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Analyse de votre profil par notre équipe RH</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-3 bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                        <div class="w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0">2</div>
                                        <div class="flex-1">
                                            <p class="font-semibold dark:text-white">Entretien RH</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">30 min - Échange sur votre parcours et motivations</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-3 bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                        <div class="w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0">3</div>
                                        <div class="flex-1">
                                            <p class="font-semibold dark:text-white">Test technique</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">1-2h - Évaluation de vos compétences techniques</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-3 bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                        <div class="w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0">4</div>
                                        <div class="flex-1">
                                            <p class="font-semibold dark:text-white">Entretien équipe</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">1h - Rencontre avec votre futur manager et l'équipe</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-3 bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                        <div class="w-8 h-8 rounded-full bg-green-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0">5</div>
                                        <div class="flex-1">
                                            <p class="font-semibold dark:text-white">Proposition</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Offre d'emploi et négociation des conditions</p>
                                        </div>
                                    </div>
                                </div>
                                <p class="text-xs text-gray-500 mt-3 italic">⏱️ Durée totale du processus: 2-3 semaines</p>
                            </div>
                            
                            <div class="mb-6 bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-clipboard-list mr-2"></i>Processus de recrutement</h3>
                                <div class="space-y-2">
                                    <div class="flex items-center gap-3 text-sm">
                                        <div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold">1</div>
                                        <span class="text-gray-700 dark:text-gray-300">Entretien téléphonique (30 min)</span>
                                    </div>
                                    <div class="flex items-center gap-3 text-sm">
                                        <div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold">2</div>
                                        <span class="text-gray-700 dark:text-gray-300">Test technique (2h)</span>
                                    </div>
                                    <div class="flex items-center gap-3 text-sm">
                                        <div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold">3</div>
                                        <span class="text-gray-700 dark:text-gray-300">Entretien technique avec l'équipe (1h30)</span>
                                    </div>
                                    <div class="flex items-center gap-3 text-sm">
                                        <div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold">4</div>
                                        <span class="text-gray-700 dark:text-gray-300">Entretien RH et décision (45 min)</span>
                                    </div>
                                </div>
                            </div>
                            
                            ${matchingCandidates.length > 0 ? `<div class="mb-6 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 p-5 rounded-lg">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-users-cog mr-2"></i>Candidats recommandés</h3>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                    ${matchingCandidates.map(candidate => {
                                        const matchScore = Math.floor(Math.random() * 30) + 70;
                                        return `<div class="bg-white dark:bg-gray-700 p-3 rounded-lg cursor-pointer hover:shadow-md transition" onclick="showDetailsModal(${candidate.id})">
                                            <div class="flex items-center gap-2 mb-2">
                                                <img src="${candidate.avatar}" class="w-10 h-10 rounded-full">
                                                <div class="flex-1">
                                                    <p class="font-semibold text-sm dark:text-white">${candidate.name}</p>
                                                    <p class="text-xs text-gray-500 dark:text-gray-400">${candidate.title}</p>
                                                </div>
                                            </div>
                                            <div class="flex items-center justify-between mt-2">
                                                <span class="text-xs text-gray-600 dark:text-gray-400">${matchScore}% match</span>
                                                <span class="text-xs text-blue-600 dark:text-blue-400 hover:underline">Voir profil</span>
                                            </div>
                                        </div>`;
                                    }).join('')}
                                </div>
                            </div>` : ''}
                            
                            ${item.acceptsSpontaneous ? `<div class="mb-4 p-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg border border-indigo-200 dark:border-indigo-700">
                                <p class="text-sm text-indigo-700 dark:text-indigo-300"><i class="fas fa-star mr-2"></i>Cette entreprise accepte les <strong>candidatures spontanées</strong></p>
                            </div>` : ''}
                            
                            <div class="flex gap-3 mt-6">
                                ${state.currentUser?.type === 'candidate' ? `<button onclick="applyToJob(${item.id})" class="flex-1 bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition shadow-lg">
                                    <i class="fas fa-paper-plane mr-2"></i>Postuler maintenant
                                </button>` : ''}
                                <button onclick="showCompanyProfile('${item.company}')" class="flex-1 bg-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-purple-700 transition">
                                    <i class="fas fa-building mr-2"></i>Entreprise
                                </button>
                                <button onclick="calculateRoute({lat: ${state.userLocation.lat}, lon: ${state.userLocation.lon}}, {lat: ${item.location.lat}, lon: ${item.location.lon}}); closeAllModals();" class="flex-1 bg-emerald-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-emerald-700 transition">
                                    <i class="fas fa-route mr-2"></i>Itinéraire
                                </button>
                                <button class="bg-gray-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-gray-700 transition" onclick="shareItem(${item.id})">
                                    <i class="fas fa-share-alt"></i>
                                </button>
                            </div>
                        </div>`;
                    } else if (item.type === 'candidate') {
                        const isFav = state.favorites.has(item.id);
                        const matchingJobs = data.filter(j => j.type === 'job').slice(0, 3);
                        const profileStrength = Math.floor(Math.random() * 20) + 80;
                        const profileViews = Math.floor(Math.random() * 100) + 20;
                        
                        content = `<div class="p-6">
                            <div class="flex items-start gap-4 mb-6">
                                ${item.avatar ? `<img src="${item.avatar}" alt="${item.name}" class="w-20 h-20 rounded-full shadow-lg border-2 border-blue-500">` : ''}
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-2">
                                        <h2 class="text-3xl font-bold text-gray-800 dark:text-white">${item.name}</h2>
                                        ${item.certifications && item.certifications.length > 0 ? '<span class="bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-1 text-xs rounded-full"><i class="fas fa-certificate mr-1"></i>Certifié</span>' : ''}
                                    </div>
                                    <p class="text-xl text-gray-600 dark:text-gray-300 mb-2">${item.title}</p>
                                    <div class="flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 flex-wrap">
                                        <span><i class="fas fa-map-marker-alt mr-1"></i>${item.city}</span>
                                        <span><i class="fas fa-briefcase mr-1"></i>${item.experience}</span>
                                        <span><i class="fas fa-clock mr-1"></i>Dispo: ${item.availability || 'À négocier'}</span>
                                    </div>
                                    <div class="flex items-center gap-4 mt-2 text-xs text-gray-500">
                                        <span><i class="fas fa-eye mr-1"></i>${profileViews} vues</span>
                                        <span><i class="fas fa-chart-line mr-1"></i>Profil ${profileStrength}% complet</span>
                                    </div>
                                </div>
                                <button class="favorite-icon p-3 text-2xl ${isFav ? 'text-pink-500' : 'text-gray-300'} hover:text-pink-500" data-id="${item.id}">
                                    <i class="fas fa-heart"></i>
                                </button>
                            </div>
                            
                            <div class="mb-6 bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                                <h3 class="font-semibold text-lg mb-2 dark:text-white"><i class="fas fa-user mr-2"></i>Présentation</h3>
                                <p class="text-gray-700 dark:text-gray-300 mb-3">${item.description}</p>
                                <div class="grid grid-cols-2 gap-3 mt-3">
                                    <div class="bg-white dark:bg-gray-700 p-2 rounded text-center">
                                        <p class="text-2xl font-bold text-blue-600 dark:text-blue-400">${item.background ? item.background.length : 0}</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Expériences</p>
                                    </div>
                                    <div class="bg-white dark:bg-gray-700 p-2 rounded text-center">
                                        <p class="text-2xl font-bold text-green-600 dark:text-green-400">${item.certifications ? item.certifications.length : 0}</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Certifications</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <div class="bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 p-4 rounded-lg">
                                    <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-code mr-2"></i>Compétences techniques</h3>
                                    <div class="flex flex-wrap gap-2">
                                        ${item.tags.map(tag => `<span class="bg-emerald-100 dark:bg-emerald-900 text-emerald-800 dark:text-emerald-200 px-3 py-1 rounded-full text-sm font-medium">${tag}</span>`).join('')}
                                    </div>
                                </div>
                                <div class="bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-4 rounded-lg">
                                    <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-user-check mr-2"></i>Soft Skills</h3>
                                    <div class="flex flex-wrap gap-2">
                                        ${item.softSkills?.map(skill => `<span class="bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 px-3 py-1 rounded-full text-sm font-medium">${skill}</span>`).join('') || '<span class="text-gray-500">Non spécifié</span>'}
                                    </div>
                                </div>
                            </div>
                            
                            ${item.background ? `<div class="mb-6">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-briefcase mr-2"></i>Parcours professionnel</h3>
                                <div class="space-y-3">
                                    ${item.background.map(bg => `<div class="border-l-4 border-blue-500 pl-4 py-3 bg-gray-50 dark:bg-gray-700 rounded-r hover:shadow-md transition">
                                        <p class="font-semibold text-lg dark:text-white">${bg.role}</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">${bg.company}</p>
                                        <p class="text-xs text-gray-500"><i class="fas fa-calendar mr-1"></i>${bg.year}</p>
                                    </div>`).join('')}
                                </div>
                            </div>` : ''}
                            
                            ${item.education ? `<div class="mb-6">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-graduation-cap mr-2"></i>Formation</h3>
                                <div class="space-y-3">
                                    ${item.education.map(edu => `<div class="border-l-4 border-green-500 pl-4 py-3 bg-gray-50 dark:bg-gray-700 rounded-r hover:shadow-md transition">
                                        <p class="font-semibold text-lg dark:text-white">${edu.degree}</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">${edu.school}</p>
                                        <p class="text-xs text-gray-500"><i class="fas fa-calendar mr-1"></i>${edu.year}</p>
                                    </div>`).join('')}
                                </div>
                            </div>` : ''}
                            
                            ${item.certifications && item.certifications.length > 0 ? `<div class="mb-6">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-certificate mr-2"></i>Certifications</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                                    ${item.certifications.map(cert => `<div class="bg-yellow-50 dark:bg-yellow-900/20 px-3 py-2 rounded-lg text-sm flex items-center gap-2 border border-yellow-200 dark:border-yellow-800">
                                        <i class="fas fa-award text-yellow-600 dark:text-yellow-400"></i>
                                        <span class="text-gray-700 dark:text-gray-300">${cert}</span>
                                    </div>`).join('')}
                                </div>
                            </div>` : ''}
                            
                            <div class="mb-6">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-language mr-2"></i>Langues</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                        <div class="flex justify-between items-center mb-1">
                                            <span class="font-semibold text-sm dark:text-white">Français</span>
                                            <span class="text-xs text-gray-500">Natif</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-green-500 h-2 rounded-full" style="width: 100%"></div>
                                        </div>
                                    </div>
                                    <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                        <div class="flex justify-between items-center mb-1">
                                            <span class="font-semibold text-sm dark:text-white">Anglais</span>
                                            <span class="text-xs text-gray-500">${['Courant', 'Professionnel', 'Intermédiaire'][Math.floor(Math.random() * 3)]}</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-500 h-2 rounded-full" style="width: ${Math.floor(Math.random() * 30) + 70}%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-6 bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 p-5 rounded-lg">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-lightbulb mr-2"></i>Centres d'intérêt</h3>
                                <div class="flex flex-wrap gap-2">
                                    ${['Open Source', 'Conférences Tech', 'Veille Technologique', 'Mentorat', 'Blogging'][Math.floor(Math.random() * 3)].split(',').map(interest => 
                                        `<span class="bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200 px-3 py-1 rounded-full text-sm">${interest}</span>`
                                    ).join('')}
                                    <span class="bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200 px-3 py-1 rounded-full text-sm">Open Source</span>
                                    <span class="bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200 px-3 py-1 rounded-full text-sm">Conférences</span>
                                    <span class="bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200 px-3 py-1 rounded-full text-sm">Veille Tech</span>
                                </div>
                            </div>
                            
                            ${matchingJobs.length > 0 ? `<div class="mb-6 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 p-5 rounded-lg">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-lightbulb mr-2"></i>Offres recommandées</h3>
                                <div class="space-y-3">
                                    ${matchingJobs.map(job => {
                                        const matchScore = Math.floor(Math.random() * 30) + 70;
                                        return `<div class="bg-white dark:bg-gray-700 p-4 rounded-lg cursor-pointer hover:shadow-md transition" onclick="showDetailsModal(${job.id})">
                                            <div class="flex items-start justify-between">
                                                <div class="flex-1">
                                                    <div class="flex items-center gap-2 mb-1">
                                                        <h4 class="font-semibold dark:text-white">${job.title}</h4>
                                                        <span class="px-2 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 text-xs rounded-full">${matchScore}% match</span>
                                                    </div>
                                                    <p class="text-sm text-gray-600 dark:text-gray-300">${job.company} • ${job.city}</p>
                                                    <p class="text-xs text-gray-500 mt-1">${job.salary?.toLocaleString('fr-FR')} €/an • ${job.contract}</p>
                                                </div>
                                                <button onclick="event.stopPropagation(); applyToJob(${job.id})" class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">Postuler</button>
                                            </div>
                                        </div>`;
                                    }).join('')}
                                </div>
                            </div>` : ''}
                            
                            <div class="mb-6 bg-gradient-to-r from-teal-50 to-cyan-50 dark:from-teal-900/20 dark:to-cyan-900/20 p-5 rounded-lg">
                                <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-star mr-2"></i>Points forts</h3>
                                <div class="space-y-2">
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Expérience confirmée dans le domaine</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Portfolio et projets personnels disponibles</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Disponibilité rapide</span>
                                    </div>
                                    ${item.certifications && item.certifications.length > 0 ? `<div class="flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Certifié par des organismes reconnus</span>
                                    </div>` : ''}
                                </div>
                            </div>
                            
                            <div class="flex gap-3 mt-6">
                                ${state.currentUser?.type === 'recruiter' ? `<button onclick="contactCandidate(${item.id})" class="flex-1 bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition shadow-lg">
                                    <i class="fas fa-envelope mr-2"></i>Contacter
                                </button>` : ''}
                                ${item.portfolioLink ? `<a href="${item.portfolioLink}" target="_blank" class="flex-1 bg-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-purple-700 transition text-center">
                                    <i class="fas fa-external-link-alt mr-2"></i>Portfolio
                                </a>` : ''}
                                <button onclick="calculateRoute({lat: ${state.userLocation.lat}, lon: ${state.userLocation.lon}}, {lat: ${item.location.lat}, lon: ${item.location.lon}}); closeAllModals();" class="flex-1 bg-emerald-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-emerald-700 transition">
                                    <i class="fas fa-route mr-2"></i>Itinéraire
                                </button>
                                <button class="bg-gray-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-gray-700 transition" onclick="shareItem(${item.id})">
                                    <i class="fas fa-share-alt"></i>
                                </button>
                            </div>
                        </div>`;
                    }
                    
                    document.getElementById('details-modal-content').innerHTML = content;
                    openModal('details-modal');
                }

                function handleMatchClick(item) {
                    if (!state.isMatchModeActive) return;
                    if (!state.matchStartPoint) {
                        if (item.type === 'candidate') {
                            state.matchStartPoint = item; state.markers.get(item.id)?._icon.classList.add('pulsing'); showToast(`${item.name} sélectionné. Choisissez une offre.`, 'info');
                        } else { showToast("Veuillez d'abord sélectionner un candidat.", 'error'); }
                    } else {
                        if (item.type === 'job') { calculateAndShowMatchReport(state.matchStartPoint, item); toggleMatchMode(); } 
                        else if (item.id === state.matchStartPoint.id) { toggleMatchMode(); } 
                        else { showToast("Veuillez sélectionner une offre d'emploi.", 'error'); }
                    }
                }
                
                function applyToJob(jobId) {
                    if (!state.currentUser) { showToast('Connectez-vous pour postuler.', 'error'); openModal('login-modal'); return; }
                    const job = data.find(j => j.id === jobId);
                    if (!job) return;
                    if (!state.applications) state.applications = [];
                    if (state.applications.some(a => a.jobId === jobId && a.candidateId === state.currentUser.id)) {
                        showToast('Vous avez déjà postulé à cette offre.', 'info');
                        return;
                    }
                    state.applications.push({ id: state.applications.length + 1, jobId, candidateId: state.currentUser.id, date: new Date().toISOString(), status: 'pending' });
                    showToast(`Candidature envoyée pour ${job.title} !`, 'success');
                    closeAllModals();
                }
                
                function contactCandidate(candidateId) {
                    if (!state.currentUser) { showToast('Connectez-vous pour contacter un candidat.', 'error'); openModal('login-modal'); return; }
                    const candidate = data.find(c => c.id === candidateId);
                    if (!candidate) return;
                    showToast(`Message envoyé à ${candidate.name} !`, 'success');
                    closeAllModals();
                }
                
                function shareItem(itemId) {
                    const item = data.find(d => d.id === itemId);
                    if (!item) return;
                    const url = `${window.location.href}?item=${itemId}`;
                    const text = item.type === 'job' ? `${item.title} chez ${item.company}` : `Profil de ${item.name} - ${item.title}`;
                    if (navigator.share) {
                        navigator.share({ title: 'JobMap by LTd', text, url }).then(() => showToast('Partagé !', 'success')).catch(() => {});
                    } else {
                        navigator.clipboard.writeText(url).then(() => showToast('Lien copié dans le presse-papier !', 'success'));
                    }
                }
                
                function showFavoritesModal() {
                    const favoriteItems = data.filter(item => state.favorites.has(item.id));
                    let content = '';
                    if (favoriteItems.length === 0) {
                        content = '<p class="text-center text-gray-500 py-8">Aucun favori pour le moment.</p>';
                    } else {
                        content = '<div class="space-y-3">';
                        favoriteItems.forEach(item => {
                            content += `<div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg shadow-sm hover:shadow-md transition">
                                <div class="flex justify-between items-start">
                                    <div class="flex-1 cursor-pointer" onclick="showDetailsModal(${item.id})">
                                        <h3 class="font-semibold text-lg dark:text-white">${item.title || item.name}</h3>
                                        <p class="text-gray-600 dark:text-gray-300">${item.type === 'job' ? item.company : item.title}</p>
                                        <div class="flex items-center gap-3 mt-2 text-sm text-gray-500">
                                            <span><i class="fas fa-map-marker-alt mr-1"></i>${item.city}</span>
                                            ${item.type === 'job' ? `<span><i class="fas fa-euro-sign mr-1"></i>${item.salary?.toLocaleString('fr-FR')} €</span>` : ''}
                                        </div>
                                    </div>
                                    <button class="favorite-icon p-2 text-pink-500 hover:text-pink-600" data-id="${item.id}">
                                        <i class="fas fa-heart"></i>
                                    </button>
                                </div>
                            </div>`;
                        });
                        content += '</div>';
                    }
                    document.getElementById('favorites-list').innerHTML = content;
                    openModal('favorites-modal');
                }
                
                function getUserLocation() {
                    if (navigator.geolocation) {
                        showToast('Localisation en cours...', 'info');
                        navigator.geolocation.getCurrentPosition(position => {
                            state.userLocation = { lat: position.coords.latitude, lon: position.coords.longitude };
                            if (state.userLocationMarker) map.removeLayer(state.userLocationMarker);
                            const icon = L.divIcon({ className: '', html: '<div class="user-location-icon"></div>', iconSize: [18, 18], iconAnchor: [9, 9] });
                            state.userLocationMarker = L.marker([state.userLocation.lat, state.userLocation.lon], { icon }).addTo(map);
                            map.setView([state.userLocation.lat, state.userLocation.lon], 12);
                            showToast('Position trouvée !', 'success');
                        }, () => showToast('Impossible de vous localiser.', 'error'));
                    } else {
                        showToast('Géolocalisation non supportée.', 'error');
                    }
                }
                
                function saveCurrentSearch() {
                    const searchName = prompt('Nom de la recherche :');
                    if (!searchName) return;
                    state.savedSearches.push({
                        id: state.savedSearches.length + 1,
                        name: searchName,
                        query: ui.searchInput.value,
                        filters: { ...state.filters },
                        date: new Date().toISOString()
                    });
                    showToast('Recherche sauvegardée !', 'success');
                }
                
                function showSavedSearches() {
                    let content = '';
                    if (state.savedSearches.length === 0) {
                        content = `<p class="text-center text-gray-500 py-8">Aucune recherche sauvegardée.</p>
                            <div class="text-center mt-4">
                                <button onclick="saveCurrentSearch()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                                    <i class="fas fa-save mr-2"></i>Sauvegarder la recherche actuelle
                                </button>
                            </div>`;
                    } else {
                        content = `<div class="space-y-3 mb-4">
                            ${state.savedSearches.map(search => `
                                <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <div class="flex justify-between items-start">
                                        <div class="flex-1">
                                            <h4 class="font-semibold dark:text-white">${search.name}</h4>
                                            <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">
                                                ${search.query ? `Recherche: "${search.query}"` : 'Tous les résultats'} • 
                                                Type: ${search.filters.type === 'all' ? 'Tous' : search.filters.type === 'job' ? 'Emplois' : 'Candidats'}
                                            </p>
                                            <p class="text-xs text-gray-500 mt-1">${new Date(search.date).toLocaleDateString('fr-FR')}</p>
                                        </div>
                                        <button onclick="loadSavedSearch(${search.id})" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm">
                                            <i class="fas fa-search mr-1"></i>Charger
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="text-center">
                            <button onclick="saveCurrentSearch()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                                <i class="fas fa-save mr-2"></i>Sauvegarder la recherche actuelle
                            </button>
                        </div>`;
                    }
                    
                    const modal = document.createElement('div');
                    modal.id = 'saved-searches-modal';
                    modal.className = 'modal-backdrop fixed inset-0 bg-black bg-opacity-60 dark:bg-opacity-70 z-[1050] flex items-center justify-center';
                    modal.innerHTML = `<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl m-4 transform max-h-[90vh] flex flex-col">
                        <button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button>
                        <div class="overflow-y-auto p-8">
                            <h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Recherches sauvegardées</h2>
                            ${content}
                        </div>
                    </div>`;
                    ui.modalContainer.appendChild(modal);
                    setTimeout(() => modal.querySelector('.modal-panel').classList.remove('hidden'), 10);
                }
                
                function loadSavedSearch(searchId) {
                    const search = state.savedSearches.find(s => s.id === searchId);
                    if (!search) return;
                    ui.searchInput.value = search.query || '';
                    state.filters = { ...search.filters };
                    performSearch();
                    closeAllModals();
                    showToast('Recherche chargée !', 'success');
                }
                
                function showViewHistory() {
                    let content = '';
                    if (state.viewHistory.length === 0) {
                        content = '<p class="text-center text-gray-500 py-8">Aucun historique de consultation.</p>';
                    } else {
                        content = `<div class="space-y-3">
                            ${state.viewHistory.map(entry => {
                                const item = entry.item;
                                return `<div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg cursor-pointer hover:shadow-md transition" onclick="showDetailsModal(${item.id})">
                                    <div class="flex items-start gap-3">
                                        ${item.avatar || item.logo ? `<img src="${item.avatar || item.logo}" class="w-12 h-12 rounded-${item.type === 'candidate' ? 'full' : 'lg'}">` : ''}
                                        <div class="flex-1">
                                            <h4 class="font-semibold dark:text-white">${item.type === 'job' ? item.title : item.name}</h4>
                                            <p class="text-sm text-gray-600 dark:text-gray-300">${item.type === 'job' ? item.company : item.title}</p>
                                            <div class="flex items-center gap-3 mt-1 text-xs text-gray-500">
                                                <span><i class="fas fa-map-marker-alt mr-1"></i>${item.city}</span>
                                                <span><i class="fas fa-clock mr-1"></i>${new Date(entry.date).toLocaleString('fr-FR', { day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit' })}</span>
                                            </div>
                                        </div>
                                        <span class="px-2 py-1 rounded text-xs ${item.type === 'job' ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200' : 'bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-200'}">
                                            ${item.type === 'job' ? 'Emploi' : 'Candidat'}
                                        </span>
                                    </div>
                                </div>`;
                            }).join('')}
                        </div>`;
                    }
                    
                    const modal = document.createElement('div');
                    modal.id = 'history-modal';
                    modal.className = 'modal-backdrop fixed inset-0 bg-black bg-opacity-60 dark:bg-opacity-70 z-[1050] flex items-center justify-center';
                    modal.innerHTML = `<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl m-4 transform max-h-[90vh] flex flex-col">
                        <button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button>
                        <div class="overflow-y-auto p-8">
                            <h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Historique de consultation</h2>
                            ${content}
                        </div>
                    </div>`;
                    ui.modalContainer.appendChild(modal);
                    setTimeout(() => modal.querySelector('.modal-panel').classList.remove('hidden'), 10);
                }
                
                function showHelp() {
                    const content = `<div class="space-y-6">
                        <div class="text-center mb-4">
                            <i class="fas fa-map-marked-alt text-6xl text-blue-500 mb-4"></i>
                            <h3 class="text-2xl font-bold dark:text-white">Bienvenue sur JobMap by LTd</h3>
                            <p class="text-gray-600 dark:text-gray-300 mt-2">Votre plateforme de mise en relation emploi géolocalisée</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                <div class="flex items-center gap-3 mb-2">
                                    <i class="fas fa-search text-2xl text-blue-600 dark:text-blue-400"></i>
                                    <h4 class="font-semibold dark:text-white">Recherche</h4>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Utilisez la barre de recherche pour trouver des emplois ou candidats par compétences, ville ou poste.</p>
                            </div>
                            
                            <div class="p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                <div class="flex items-center gap-3 mb-2">
                                    <i class="fas fa-filter text-2xl text-green-600 dark:text-green-400"></i>
                                    <h4 class="font-semibold dark:text-white">Filtres avancés</h4>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Affinez votre recherche avec les filtres : expérience, salaire, distance, type de contrat...</p>
                            </div>
                            
                            <div class="p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
                                <div class="flex items-center gap-3 mb-2">
                                    <i class="fas fa-link text-2xl text-purple-600 dark:text-purple-400"></i>
                                    <h4 class="font-semibold dark:text-white">Mode Association</h4>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Sélectionnez un candidat puis une offre pour voir un rapport de compatibilité détaillé.</p>
                            </div>
                            
                            <div class="p-4 bg-pink-50 dark:bg-pink-900/20 rounded-lg">
                                <div class="flex items-center gap-3 mb-2">
                                    <i class="fas fa-heart text-2xl text-pink-600 dark:text-pink-400"></i>
                                    <h4 class="font-semibold dark:text-white">Favoris</h4>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Ajoutez des offres ou profils à vos favoris pour les retrouver facilement.</p>
                            </div>
                            
                            <div class="p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg">
                                <div class="flex items-center gap-3 mb-2">
                                    <i class="fas fa-crosshairs text-2xl text-yellow-600 dark:text-yellow-400"></i>
                                    <h4 class="font-semibold dark:text-white">Géolocalisation</h4>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Cliquez sur le bouton de géolocalisation pour centrer la carte sur votre position.</p>
                            </div>
                            
                            <div class="p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg">
                                <div class="flex items-center gap-3 mb-2">
                                    <i class="fas fa-route text-2xl text-orange-600 dark:text-orange-400"></i>
                                    <h4 class="font-semibold dark:text-white">Itinéraires</h4>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Calculez l'itinéraire vers une offre d'emploi ou un candidat depuis votre position.</p>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 p-6 rounded-lg">
                            <h4 class="font-semibold text-lg mb-3 dark:text-white">Fonctionnalités Premium</h4>
                            <ul class="space-y-2 text-sm text-gray-700 dark:text-gray-300">
                                <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Sauvegarde de recherches personnalisées</li>
                                <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Historique de consultation</li>
                                <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Notifications en temps réel</li>
                                <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Export de données en CSV</li>
                                <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Tableau de bord avec statistiques</li>
                                <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Système de candidature intégré</li>
                            </ul>
                        </div>
                    </div>`;
                    
                    const modal = document.createElement('div');
                    modal.id = 'help-modal';
                    modal.className = 'modal-backdrop fixed inset-0 bg-black bg-opacity-60 dark:bg-opacity-70 z-[1050] flex items-center justify-center';
                    modal.innerHTML = `<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl m-4 transform max-h-[90vh] flex flex-col">
                        <button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button>
                        <div class="overflow-y-auto p-8">
                            <h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Guide d'utilisation</h2>
                            ${content}
                        </div>
                    </div>`;
                    ui.modalContainer.appendChild(modal);
                    setTimeout(() => modal.querySelector('.modal-panel').classList.remove('hidden'), 10);
                }
                
                function showCompanyProfile(companyName) {
                    const companyJobs = data.filter(j => j.type === 'job' && j.company === companyName);
                    if (companyJobs.length === 0) return;
                    
                    const company = companyJobs[0];
                    const rating = 4.5;
                    const reviews = Math.floor(Math.random() * 50) + 20;
                    const employees = Math.floor(Math.random() * 500) + 50;
                    const foundedYear = 2015 + Math.floor(Math.random() * 8);
                    
                    const content = `<div class="space-y-6">
                        <div class="text-center bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-lg">
                            ${company.logo ? `<img src="${company.logo}" class="w-32 h-32 mx-auto rounded-lg shadow-lg mb-4 border-4 border-white dark:border-gray-700">` : ''}
                            <h2 class="text-3xl font-bold dark:text-white mb-2">${companyName}</h2>
                            <p class="text-gray-600 dark:text-gray-400 mb-3">${company.industry || 'Technologie'}</p>
                            <div class="flex items-center justify-center gap-2 mb-2">
                                ${[1,2,3,4,5].map(i => `<i class="fas fa-star ${i <= Math.floor(rating) ? 'text-yellow-400' : 'text-gray-300'}"></i>`).join('')}
                                <span class="text-gray-600 dark:text-gray-400 ml-2">${rating.toFixed(1)} (${reviews} avis)</span>
                            </div>
                            <div class="flex items-center justify-center gap-4 text-sm text-gray-600 dark:text-gray-400">
                                <span><i class="fas fa-users mr-1"></i>${employees} employés</span>
                                <span><i class="fas fa-calendar mr-1"></i>Fondée en ${foundedYear}</span>
                                <span><i class="fas fa-map-marker-alt mr-1"></i>${company.city}</span>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg text-center">
                                <i class="fas fa-briefcase text-3xl text-blue-600 dark:text-blue-400 mb-2"></i>
                                <p class="text-2xl font-bold text-blue-600 dark:text-blue-400">${companyJobs.length}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Offres actives</p>
                            </div>
                            <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg text-center">
                                <i class="fas fa-chart-line text-3xl text-green-600 dark:text-green-400 mb-2"></i>
                                <p class="text-2xl font-bold text-green-600 dark:text-green-400">+${Math.floor(Math.random() * 30) + 10}%</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Croissance annuelle</p>
                            </div>
                            <div class="bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg text-center">
                                <i class="fas fa-trophy text-3xl text-purple-600 dark:text-purple-400 mb-2"></i>
                                <p class="text-2xl font-bold text-purple-600 dark:text-purple-400">${Math.floor(Math.random() * 5) + 1}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Prix reçus</p>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 p-6 rounded-lg">
                            <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-info-circle mr-2"></i>À propos</h3>
                            <p class="text-gray-700 dark:text-gray-300 mb-4">${company.companyDescription}</p>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mt-4">
                                <div class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-check-circle text-green-500"></i>
                                    <span class="text-gray-700 dark:text-gray-300">Télétravail</span>
                                </div>
                                <div class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-check-circle text-green-500"></i>
                                    <span class="text-gray-700 dark:text-gray-300">Horaires flexibles</span>
                                </div>
                                <div class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-check-circle text-green-500"></i>
                                    <span class="text-gray-700 dark:text-gray-300">Formation</span>
                                </div>
                                <div class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-check-circle text-green-500"></i>
                                    <span class="text-gray-700 dark:text-gray-300">Avantages sociaux</span>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="font-semibold text-lg mb-4 dark:text-white"><i class="fas fa-heart mr-2"></i>Culture d'entreprise</h3>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                <div class="bg-pink-50 dark:bg-pink-900/20 p-3 rounded-lg">
                                    <i class="fas fa-users text-pink-600 dark:text-pink-400 text-xl mb-2"></i>
                                    <p class="font-semibold text-sm dark:text-white">Esprit d'équipe</p>
                                    <p class="text-xs text-gray-600 dark:text-gray-400">Collaboration et entraide</p>
                                </div>
                                <div class="bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg">
                                    <i class="fas fa-lightbulb text-yellow-600 dark:text-yellow-400 text-xl mb-2"></i>
                                    <p class="font-semibold text-sm dark:text-white">Innovation</p>
                                    <p class="text-xs text-gray-600 dark:text-gray-400">Créativité encouragée</p>
                                </div>
                                <div class="bg-green-50 dark:bg-green-900/20 p-3 rounded-lg">
                                    <i class="fas fa-balance-scale text-green-600 dark:text-green-400 text-xl mb-2"></i>
                                    <p class="font-semibold text-sm dark:text-white">Équilibre vie pro/perso</p>
                                    <p class="text-xs text-gray-600 dark:text-gray-400">Respect du temps personnel</p>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="font-semibold text-lg mb-4 dark:text-white"><i class="fas fa-briefcase mr-2"></i>Offres d'emploi actives (${companyJobs.length})</h3>
                            <div class="space-y-3">
                                ${companyJobs.map(job => `
                                    <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg cursor-pointer hover:shadow-lg transition border-l-4 border-blue-500" onclick="showDetailsModal(${job.id})">
                                        <div class="flex items-start justify-between">
                                            <div class="flex-1">
                                                <h4 class="font-semibold text-lg dark:text-white mb-1">${job.title}</h4>
                                                <div class="flex items-center gap-4 text-sm text-gray-600 dark:text-gray-300">
                                                    <span><i class="fas fa-map-marker-alt mr-1"></i>${job.city}</span>
                                                    <span><i class="fas fa-briefcase mr-1"></i>${job.contract}</span>
                                                    <span><i class="fas fa-euro-sign mr-1"></i>${job.salary?.toLocaleString('fr-FR')} €</span>
                                                </div>
                                                <div class="flex flex-wrap gap-1 mt-2">
                                                    ${job.tags.slice(0, 3).map(tag => `<span class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs">${tag}</span>`).join('')}
                                                </div>
                                            </div>
                                            <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm font-semibold">
                                                Voir détails
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="font-semibold text-lg mb-4 dark:text-white"><i class="fas fa-comments mr-2"></i>Avis des employés</h3>
                            <div class="space-y-3">
                                ${[
                                    { author: 'Sophie M.', role: 'Développeuse Full-Stack', rating: 5, comment: 'Excellente ambiance de travail, équipe dynamique et projets stimulants. Les managers sont à l\'écoute et les opportunités d\'évolution sont réelles.', date: '2024-01-15', helpful: 24 },
                                    { author: 'Marc D.', role: 'Product Manager', rating: 4, comment: 'Bonne entreprise avec de belles opportunités d\'évolution. Le télétravail est bien organisé et la culture d\'entreprise est saine.', date: '2023-12-20', helpful: 18 },
                                    { author: 'Julie R.', role: 'UX Designer', rating: 5, comment: 'Management à l\'écoute et très bons avantages sociaux. Les projets sont intéressants et on a vraiment la possibilité de proposer des idées.', date: '2023-11-10', helpful: 31 }
                                ].map(review => `
                                    <div class="p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-700 rounded-lg border border-gray-200 dark:border-gray-600">
                                        <div class="flex items-center justify-between mb-3">
                                            <div class="flex items-center gap-3">
                                                <div class="w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold">
                                                    ${review.author.charAt(0)}
                                                </div>
                                                <div>
                                                    <span class="font-semibold dark:text-white">${review.author}</span>
                                                    <p class="text-xs text-gray-600 dark:text-gray-400">${review.role}</p>
                                                </div>
                                            </div>
                                            <div class="flex items-center gap-1">
                                                ${[1,2,3,4,5].map(i => `<i class="fas fa-star text-sm ${i <= review.rating ? 'text-yellow-400' : 'text-gray-300'}"></i>`).join('')}
                                            </div>
                                        </div>
                                        <p class="text-sm text-gray-700 dark:text-gray-300 mb-3">${review.comment}</p>
                                        <div class="flex items-center justify-between text-xs text-gray-500">
                                            <span>${new Date(review.date).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric' })}</span>
                                            <button class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400">
                                                <i class="fas fa-thumbs-up mr-1"></i>${review.helpful} personnes ont trouvé cet avis utile
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-5 rounded-lg">
                            <h3 class="font-semibold text-lg mb-3 dark:text-white"><i class="fas fa-images mr-2"></i>Vie de l'entreprise</h3>
                            <div class="grid grid-cols-3 gap-2">
                                ${[1,2,3,4,5,6].map(i => `
                                    <div class="aspect-square bg-gray-200 dark:bg-gray-600 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-image text-gray-400 text-2xl"></i>
                                    </div>
                                `).join('')}
                            </div>
                            <p class="text-xs text-gray-600 dark:text-gray-400 mt-2 text-center">Photos et vidéos de l'entreprise</p>
                        </div>
                        
                        <div class="flex gap-3">
                            ${state.currentUser ? `<button onclick="leaveReview('${companyName}')" class="flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-semibold shadow-lg">
                                <i class="fas fa-comment-dots mr-2"></i>Laisser un avis
                            </button>` : ''}
                            <button onclick="closeAllModals()" class="flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-100 px-6 py-3 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 font-semibold">
                                Fermer
                            </button>
                        </div>
                    </div>`;
                    
                    document.getElementById('company-profile-content').innerHTML = content;
                    openModal('company-modal');
                }
                
                function leaveReview(companyName) {
                    const rating = prompt(`Note pour ${companyName} (1-5) :`);
                    if (!rating || rating < 1 || rating > 5) return;
                    const comment = prompt('Votre commentaire :');
                    if (!comment) return;
                    showToast('Avis publié avec succès !', 'success');
                    closeAllModals();
                }

                function performSearch() {
                    state.firstInteraction = true;
                    const query = ui.searchInput.value.toLowerCase();
                    
                    const calculateDistance = (lat1, lon1, lat2, lon2) => {
                        const R = 6371; // Earth radius in km
                        const dLat = (lat2 - lat1) * Math.PI / 180;
                        const dLon = (lon2 - lon1) * Math.PI / 180;
                        const a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon/2) * Math.sin(dLon/2);
                        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
                        return R * c;
                    };
                    
                    const filteredData = data.filter(item => {
                        const typeMatch = state.filters.type === 'all' || item.type === state.filters.type;
                        const expMatch = state.filters.experience === 'all' || (item.experience && item.experience === state.filters.experience);
                        const salaryMatch = item.type === 'candidate' || (item.salary && item.salary <= state.filters.salary);
                        const contractMatch = state.filters.contract === 'all' || (item.type === 'candidate' || (item.contract && item.contract === state.filters.contract));
                        const workArrangementMatch = state.filters.workArrangement === 'all' || (item.type === 'candidate' || (item.workArrangement && (item.workArrangement.includes(state.filters.workArrangement))));
                        const industryMatch = state.filters.industry === 'all' || (item.type === 'candidate' || (item.industry && item.industry === state.filters.industry));
                        const distance = calculateDistance(state.userLocation.lat, state.userLocation.lon, item.location.lat, item.location.lon);
                        const distanceMatch = distance <= state.filters.distance;
                        const queryMatch = !query || Object.values(item).some(val => String(val).toLowerCase().includes(query)) || (item.tags && item.tags.some(tag => tag.toLowerCase().includes(query)));
                        return typeMatch && expMatch && salaryMatch && contractMatch && workArrangementMatch && industryMatch && distanceMatch && queryMatch;
                    });
                    displayData(filteredData);
                }
                
                function exportData() {
                    const query = ui.searchInput.value.toLowerCase();
                    const filteredData = data.filter(item => {
                        const typeMatch = state.filters.type === 'all' || item.type === state.filters.type;
                        return typeMatch;
                    });
                    
                    const csvContent = "data:text/csv;charset=utf-8," + 
                        "Type,Titre/Nom,Entreprise/Fonction,Ville,Compétences,Expérience\n" +
                        filteredData.map(item => {
                            const type = item.type === 'job' ? 'Emploi' : 'Candidat';
                            const name = item.type === 'job' ? item.title : item.name;
                            const company = item.type === 'job' ? item.company : item.title;
                            const skills = item.tags.join('; ');
                            return `"${type}","${name}","${company}","${item.city}","${skills}","${item.experience}"`;
                        }).join("\n");
                    
                    const encodedUri = encodeURI(csvContent);
                    const link = document.createElement("a");
                    link.setAttribute("href", encodedUri);
                    link.setAttribute("download", `jobmap_export_${new Date().toISOString().split('T')[0]}.csv`);
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    showToast('Données exportées !', 'success');
                }

                function displayData(filteredData) {
                    markerClusters.clearLayers(); state.markers.clear(); ui.resultsList.innerHTML = '';
                    const showList = state.firstInteraction;
                    ui.resultsHeader.classList.toggle('hidden', !showList); ui.resultsList.classList.toggle('hidden', !showList);
                    ui.resultsCount.textContent = `${filteredData.length} résultat(s)`;
                    if (filteredData.length === 0 && showList) { ui.resultsList.innerHTML = `<p class="text-center text-gray-500 p-4">Aucun résultat trouvé.</p>`; return; }
                    filteredData.forEach(item => {
                        const markerHtml = `<div class="custom-marker-icon w-8 h-8 ${item.type === 'job' ? 'bg-blue-500' : 'bg-emerald-500'}"><i class="fas ${item.type === 'job' ? 'fa-briefcase' : 'fa-user'}"></i></div>`;
                        const icon = L.divIcon({ className: '', html: markerHtml, iconSize: [32, 32], iconAnchor: [16, 16] });
                        const marker = L.marker([item.location.lat, item.location.lon], { icon: icon });
                        marker.on('click', () => handleMatchClick(item));
                        marker.bindPopup(`<div class="popup-title">${item.title}</div><div class="popup-company">${item.type === 'job' ? item.company : item.name}</div><button class="view-details-btn bg-blue-500 text-white text-xs font-bold py-1 px-3 rounded-full w-full" data-id="${item.id}">Voir détails</button>`);
                        markerClusters.addLayer(marker); state.markers.set(item.id, marker);
                        if(showList) {
                            const isFav = state.favorites.has(item.id);
                            ui.resultsList.innerHTML += `<div class="result-card bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md dark:hover:bg-gray-700 transition flex justify-between items-start ${item.type === 'job' ? 'border-l-4 border-blue-500' : 'border-l-4 border-emerald-500'}"><div class="cursor-pointer flex-grow" data-id="${item.id}" data-lat="${item.location.lat}" data-lon="${item.location.lon}"><h3 class="text-gray-800 dark:text-gray-100">${item.title}</h3><p class="text-gray-600 dark:text-gray-300">${item.type === 'job' ? item.company : item.name}</p><p class="text-gray-400 mt-1"><i class="fas fa-map-marker-alt mr-1"></i>${item.city}</p></div><button class="favorite-icon p-2 text-gray-300 dark:text-gray-500 hover:text-pink-500 ${isFav ? 'is-favorite' : ''}" data-id="${item.id}"><i class="fas fa-heart"></i></button></div>`;
                        }
                    });
                }
                
                document.addEventListener('click', e => {
                    const closeModalBtn = e.target.closest('.close-modal-btn');
                    if (closeModalBtn) { e.preventDefault(); closeAllModals(); return; }
                    const actionTarget = e.target.closest('[data-action]');
                    if (actionTarget) {
                        e.preventDefault(); const { action } = actionTarget.dataset;
                        switch(action) {
                            case 'login': openModal('login-modal'); break;
                            case 'signup-candidate': openModal('signupCandidate-modal'); break;
                            case 'signup-recruiter': openModal('signupRecruiter-modal'); break;
                            case 'signup-employer': openModal('signupEmployer-modal'); break;
                            case 'post-job': openModal('postJob-modal'); break;
                            case 'edit-profile': 
                                const form = document.getElementById('edit-profile-form');
                                const user = data.find(u => u.id === state.currentUser.id);
                                form.innerHTML = `<input name="title" value="${user.title}" class="w-full p-2 border rounded dark:bg-gray-700" placeholder="Titre"><textarea name="description" class="w-full p-2 border rounded dark:bg-gray-700" placeholder="Description">${user.description || ''}</textarea><input name="tags" value="${user.tags.join(', ')}" class="w-full p-2 border rounded dark:bg-gray-700" placeholder="Compétences"><button type="submit" class="w-full bg-blue-600 text-white p-2 rounded mt-4">Sauvegarder</button>`;
                                document.getElementById('edit-profile-form').addEventListener('submit', e => {
                                    e.preventDefault();
                                    user.title = e.target.title.value;
                                    user.description = e.target.description.value;
                                    user.tags = e.target.tags.value.split(',').map(t => t.trim());
                                    closeAllModals();
                                    showToast('Profil mis à jour !', 'success');
                                    performSearch();
                                });
                                openModal('editProfile-modal'); 
                                break;
                            case 'logout': state.currentUser = null; updateAuthUI(); showToast('Déconnecté.', 'info'); break;
                            case 'dashboard': showDashboard(); break;
                            case 'notifications': showNotifications(); break;
                            case 'saved-searches': showSavedSearches(); break;
                            case 'view-history': showViewHistory(); break;
                            case 'show-company': openModal('company-modal'); break;
                            case 'spontaneous-application': openModal('spontaneousApplication-modal'); break;
                            case 'messages': showMessages(); break;
                            case 'job-alerts': showJobAlerts(); break;
                            case 'salary-insights': showSalaryInsights(); break;
                            case 'calendar': showCalendar(); break;
                            case 'job-comparator': showJobComparator(); break;
                            case 'career-coach': showCareerCoach(); break;
                            case 'recruitment-analytics': showRecruitmentAnalytics(); break;
                            case 'candidate-pool': showCandidatePool(); break;
                            case 'job-performance': showJobPerformance(); break;
                            case 'team-collaboration': showTeamCollaboration(); break;
                            case 'statistics': showStatistics(); break;
                            case 'settings': showSettings(); break;
                            case 'help-center': showHelpCenter(); break;
                        }
                        return;
                    }
                    if (e.target.closest('.favorite-icon')) { toggleFavorite(parseInt(e.target.closest('.favorite-icon').dataset.id)); }
                });
                
                function showNotifications() {
                    const notifications = [
                        { id: 1, type: 'success', icon: 'fa-check-circle', title: 'Candidature envoyée', message: 'Votre candidature pour Développeur Full-Stack a été envoyée avec succès.', date: new Date(Date.now() - 3600000).toISOString() },
                        { id: 2, type: 'info', icon: 'fa-eye', title: 'Profil consulté', message: 'Votre profil a été consulté par Tech Solutions Inc.', date: new Date(Date.now() - 86400000).toISOString() },
                        { id: 3, type: 'warning', icon: 'fa-star', title: 'Nouvelle offre correspondante', message: 'Une nouvelle offre correspond à votre profil: Data Scientist Senior.', date: new Date(Date.now() - 172800000).toISOString() }
                    ];
                    
                    const content = `<div class="space-y-3">
                        ${notifications.map(notif => {
                            const colors = { success: 'bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400', info: 'bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400', warning: 'bg-yellow-50 dark:bg-yellow-900/20 text-yellow-600 dark:text-yellow-400' };
                            return `<div class="p-4 ${colors[notif.type]} rounded-lg">
                                <div class="flex items-start gap-3">
                                    <i class="fas ${notif.icon} text-2xl mt-1"></i>
                                    <div class="flex-1">
                                        <h4 class="font-semibold">${notif.title}</h4>
                                        <p class="text-sm mt-1">${notif.message}</p>
                                        <p class="text-xs mt-2 opacity-75">${new Date(notif.date).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' })}</p>
                                    </div>
                                </div>
                            </div>`;
                        }).join('')}
                    </div>`;
                    
                    const modal = document.createElement('div');
                    modal.id = 'notifications-modal';
                    modal.className = 'modal-backdrop fixed inset-0 bg-black bg-opacity-60 dark:bg-opacity-70 z-[1050] flex items-center justify-center';
                    modal.innerHTML = `<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl m-4 transform max-h-[90vh] flex flex-col">
                        <button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button>
                        <div class="overflow-y-auto p-8">
                            <h2 class="text-2xl font-bold text-center mb-6 dark:text-white">Notifications</h2>
                            ${content}
                        </div>
                    </div>`;
                    ui.modalContainer.appendChild(modal);
                    setTimeout(() => modal.querySelector('.modal-panel').classList.remove('hidden'), 10);
                }
                
                function showMessages() {
                    const messages = [
                        { id: 1, from: 'Tech Solutions Inc.', subject: 'Réponse à votre candidature', preview: 'Nous avons bien reçu votre candidature et souhaitons vous rencontrer...', date: new Date(Date.now() - 86400000).toISOString(), unread: true },
                        { id: 2, from: 'DataCorp', subject: 'Opportunité de poste', preview: 'Votre profil nous intéresse pour un poste de Data Scientist...', date: new Date(Date.now() - 172800000).toISOString(), unread: false },
                        { id: 3, from: 'AppFactory', subject: 'Entretien technique', preview: 'Suite à votre candidature, nous souhaitons organiser un entretien...', date: new Date(Date.now() - 259200000).toISOString(), unread: false }
                    ];
                    
                    const content = `<div class="space-y-2">
                        ${messages.map(msg => `<div class="p-4 ${msg.unread ? 'bg-blue-50 dark:bg-blue-900/20' : 'bg-gray-50 dark:bg-gray-700'} rounded-lg hover:shadow-md transition cursor-pointer">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <div class="flex items-center gap-2">
                                        ${msg.unread ? '<span class="w-2 h-2 bg-blue-500 rounded-full"></span>' : ''}
                                        <h4 class="font-semibold dark:text-white">${msg.from}</h4>
                                    </div>
                                    <p class="text-sm font-medium text-gray-700 dark:text-gray-300 mt-1">${msg.subject}</p>
                                    <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">${msg.preview}</p>
                                </div>
                                <span class="text-xs text-gray-500 dark:text-gray-400">${new Date(msg.date).toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' })}</span>
                            </div>
                        </div>`).join('')}
                    </div>`;
                    
                    document.getElementById('messages-content').innerHTML = content;
                    openModal('messages-modal');
                }
                
                function showJobAlerts() {
                    const alerts = [
                        { id: 1, title: 'Développeur Full-Stack', keywords: ['React', 'Node.js', 'TypeScript'], location: 'Paris', frequency: 'Quotidien', active: true, matches: 5 },
                        { id: 2, title: 'Data Scientist', keywords: ['Python', 'Machine Learning'], location: 'Lyon', frequency: 'Hebdomadaire', active: true, matches: 2 },
                        { id: 3, title: 'DevOps Engineer', keywords: ['Docker', 'Kubernetes', 'AWS'], location: 'Télétravail', frequency: 'Quotidien', active: false, matches: 0 }
                    ];
                    
                    const content = `<div class="space-y-4">
                        <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                            <p class="text-sm text-gray-700 dark:text-gray-300"><i class="fas fa-info-circle mr-2"></i>Recevez des notifications lorsque de nouvelles offres correspondent à vos critères.</p>
                        </div>
                        ${alerts.map(alert => `<div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <div class="flex items-center gap-2">
                                        <h4 class="font-semibold dark:text-white">${alert.title}</h4>
                                        <span class="px-2 py-1 text-xs rounded-full ${alert.active ? 'bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-300' : 'bg-gray-200 text-gray-600 dark:bg-gray-600 dark:text-gray-300'}">${alert.active ? 'Actif' : 'Inactif'}</span>
                                    </div>
                                    <div class="mt-2 flex flex-wrap gap-1">
                                        ${alert.keywords.map(kw => `<span class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs">${kw}</span>`).join('')}
                                    </div>
                                    <div class="mt-2 text-sm text-gray-600 dark:text-gray-400">
                                        <i class="fas fa-map-marker-alt mr-1"></i>${alert.location} • ${alert.frequency} • ${alert.matches} nouvelle(s) offre(s)
                                    </div>
                                </div>
                                <button class="text-blue-600 hover:text-blue-700 dark:text-blue-400"><i class="fas fa-cog"></i></button>
                            </div>
                        </div>`).join('')}
                        <button class="w-full py-3 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                            <i class="fas fa-plus mr-2"></i>Créer une nouvelle alerte
                        </button>
                    </div>`;
                    
                    document.getElementById('job-alerts-content').innerHTML = content;
                    openModal('jobAlerts-modal');
                }
                
                function showSalaryInsights() {
                    const jobs = data.filter(item => item.type === 'job' && item.salary);
                    const industries = {};
                    const experiences = { 'Junior': [], 'Confirmé': [], 'Senior': [] };
                    
                    jobs.forEach(job => {
                        if (job.industry) {
                            if (!industries[job.industry]) industries[job.industry] = [];
                            industries[job.industry].push(job.salary);
                        }
                        if (job.experience && experiences[job.experience]) {
                            experiences[job.experience].push(job.salary);
                        }
                    });
                    
                    const avgBySector = Object.keys(industries).map(sector => ({
                        sector,
                        avg: Math.round(industries[sector].reduce((a,b) => a+b, 0) / industries[sector].length),
                        min: Math.min(...industries[sector]),
                        max: Math.max(...industries[sector]),
                        count: industries[sector].length
                    })).sort((a,b) => b.avg - a.avg);
                    
                    const avgByExp = Object.keys(experiences).map(level => ({
                        level,
                        avg: experiences[level].length > 0 ? Math.round(experiences[level].reduce((a,b) => a+b, 0) / experiences[level].length) : 0,
                        count: experiences[level].length
                    })).filter(e => e.count > 0);
                    
                    const content = `<div class="space-y-6">
                        <div class="bg-gradient-to-r from-teal-50 to-blue-50 dark:from-teal-900/20 dark:to-blue-900/20 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-2 dark:text-white"><i class="fas fa-chart-line mr-2"></i>Baromètre des Salaires 2024</h3>
                            <p class="text-sm text-gray-700 dark:text-gray-300">Données basées sur ${jobs.length} offres d'emploi récentes</p>
                        </div>
                        
                        <div>
                            <h4 class="font-bold text-lg mb-4 dark:text-white">Salaires moyens par expérience</h4>
                            <div class="space-y-3">
                                ${avgByExp.map(exp => {
                                    const colors = { 'Junior': 'bg-green-100 dark:bg-green-900/40', 'Confirmé': 'bg-blue-100 dark:bg-blue-900/40', 'Senior': 'bg-purple-100 dark:bg-purple-900/40' };
                                    const percentage = (exp.avg / Math.max(...avgByExp.map(e => e.avg))) * 100;
                                    return `<div class="p-4 ${colors[exp.level]} rounded-lg">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-semibold dark:text-white">${exp.level}</span>
                                            <span class="text-xl font-bold text-blue-600 dark:text-blue-400">${exp.avg.toLocaleString('fr-FR')} €/an</span>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full" style="width: ${percentage}%"></div>
                                        </div>
                                        <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">${exp.count} offres analysées</p>
                                    </div>`;
                                }).join('')}
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-bold text-lg mb-4 dark:text-white">Salaires moyens par secteur</h4>
                            <div class="space-y-3">
                                ${avgBySector.map(sector => {
                                    return `<div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <div class="flex justify-between items-center">
                                            <div class="flex-1">
                                                <h5 class="font-semibold dark:text-white">${sector.sector}</h5>
                                                <p class="text-xs text-gray-500 dark:text-gray-400">Min: ${sector.min.toLocaleString('fr-FR')}€ • Max: ${sector.max.toLocaleString('fr-FR')}€</p>
                                            </div>
                                            <div class="text-right">
                                                <p class="text-xl font-bold text-teal-600 dark:text-teal-400">${sector.avg.toLocaleString('fr-FR')}€</p>
                                                <p class="text-xs text-gray-500 dark:text-gray-400">${sector.count} offres</p>
                                            </div>
                                        </div>
                                    </div>`;
                                }).join('')}
                            </div>
                        </div>
                        
                        <div class="bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg">
                            <p class="text-sm text-gray-700 dark:text-gray-300"><i class="fas fa-lightbulb mr-2 text-yellow-500"></i><strong>Conseil:</strong> Ces données vous aident à négocier votre salaire et à évaluer la compétitivité des offres.</p>
                        </div>
                    </div>`;
                    
                    const modal = document.createElement('div');
                    modal.id = 'salary-insights-modal';
                    modal.className = 'modal-backdrop fixed inset-0 bg-black bg-opacity-60 dark:bg-opacity-70 z-[1050] flex items-center justify-center';
                    modal.innerHTML = `<div class="modal-panel bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-3xl m-4 transform max-h-[90vh] flex flex-col">
                        <button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"><i class="fas fa-times fa-2x"></i></button>
                        <div class="overflow-y-auto p-8">
                            <h2 class="text-2xl font-bold text-center mb-6 dark:text-white"><i class="fas fa-chart-bar mr-2"></i>Baromètre des Salaires</h2>
                            ${content}
                        </div>
                    </div>`;
                    ui.modalContainer.appendChild(modal);
                    setTimeout(() => modal.querySelector('.modal-panel').classList.remove('hidden'), 10);
                }
                
                function showCalendar() {
                    if (!state.currentUser) { showToast('Connectez-vous pour accéder au calendrier.', 'error'); openModal('login-modal'); return; }
                    
                    const interviews = [
                        { id: 1, date: new Date(Date.now() + 86400000 * 2).toISOString(), time: '10:00', type: 'Technique', company: 'Tech Solutions Inc.', position: 'Développeur Full-Stack', format: 'Visio', duration: '1h30' },
                        { id: 2, date: new Date(Date.now() + 86400000 * 5).toISOString(), time: '14:30', type: 'RH', company: 'DataCorp', position: 'Data Scientist', format: 'Présentiel', duration: '45 min' },
                        { id: 3, date: new Date(Date.now() + 86400000 * 8).toISOString(), time: '11:00', type: 'Présentation', company: 'AppFactory', position: 'Développeur Mobile', format: 'Téléphone', duration: '30 min' }
                    ];
                    
                    const content = `<div class="space-y-6">
                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-2 dark:text-white"><i class="fas fa-calendar-check mr-2"></i>Entretiens à venir</h3>
                            <p class="text-sm text-gray-700 dark:text-gray-300">Vous avez ${interviews.length} entretien(s) planifié(s)</p>
                        </div>
                        
                        <div class="space-y-4">
                            ${interviews.map(interview => {
                                const dateObj = new Date(interview.date);
                                const typeColors = { 'Technique': 'blue', 'RH': 'purple', 'Présentation': 'green' };
                                const color = typeColors[interview.type] || 'gray';
                                return `<div class="p-5 bg-gradient-to-r from-${color}-50 to-${color}-100 dark:from-${color}-900/20 dark:to-${color}-900/30 rounded-lg border-l-4 border-${color}-500 hover:shadow-lg transition">
                                    <div class="flex items-start justify-between">
                                        <div class="flex-1">
                                            <div class="flex items-center gap-2 mb-2">
                                                <span class="px-3 py-1 bg-${color}-600 text-white text-xs rounded-full font-semibold">${interview.type}</span>
                                                <span class="px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs rounded-full">${interview.format}</span>
                                            </div>
                                            <h4 class="text-lg font-bold dark:text-white mb-1">${interview.position}</h4>
                                            <p class="text-sm text-gray-700 dark:text-gray-300 mb-2">${interview.company}</p>
                                            <div class="flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400">
                                                <span><i class="fas fa-calendar mr-1"></i>${dateObj.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' })}</span>
                                                <span><i class="fas fa-clock mr-1"></i>${interview.time}</span>
                                                <span><i class="fas fa-hourglass-half mr-1"></i>${interview.duration}</span>
                                            </div>
                                        </div>
                                        <div class="flex flex-col gap-2">
                                            <button class="bg-${color}-600 text-white px-4 py-2 rounded-lg hover:bg-${color}-700 text-sm font-semibold">
                                                <i class="fas fa-edit mr-1"></i>Modifier
                                            </button>
                                            <button class="bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 text-sm">
                                                <i class="fas fa-times mr-1"></i>Annuler
                                            </button>
                                        </div>
                                    </div>
                                    ${interview.format === 'Visio' ? `<div class="mt-3 p-3 bg-white dark:bg-gray-800 rounded-lg">
                                        <p class="text-xs text-gray-600 dark:text-gray-400 mb-1">Lien de visio:</p>
                                        <div class="flex items-center gap-2">
                                            <input type="text" value="https://meet.example.com/xyz-abc-123" readonly class="flex-1 text-sm bg-gray-100 dark:bg-gray-700 p-2 rounded">
                                            <button class="bg-blue-600 text-white px-3 py-2 rounded hover:bg-blue-700 text-sm">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                    </div>` : ''}
                                </div>`;
                            }).join('')}
                        </div>
                        
                        <div class="bg-yellow-50 dark:bg-yellow-900/20 p-5 rounded-lg">
                            <h4 class="font-semibold mb-3 dark:text-white"><i class="fas fa-lightbulb mr-2 text-yellow-500"></i>Conseils pour vos entretiens</h4>
                            <ul class="space-y-2 text-sm text-gray-700 dark:text-gray-300">
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Préparez des questions sur l'entreprise et le poste</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Testez votre matériel technique pour les visios</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Arrivez 5-10 minutes en avance</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Préparez des exemples concrets de votre expérience</li>
                            </ul>
                        </div>
                    </div>`;
                    
                    document.getElementById('calendar-content').innerHTML = content;
                    openModal('calendar-modal');
                }
                
                function showJobComparator() {
                    if (!state.currentUser?.type === 'candidate') { showToast('Cette fonctionnalité est réservée aux candidats.', 'error'); return; }
                    
                    const favoriteJobs = data.filter(item => state.favorites.has(item.id) && item.type === 'job').slice(0, 3);
                    if (favoriteJobs.length < 2) {
                        showToast('Ajoutez au moins 2 offres à vos favoris pour les comparer.', 'info');
                        return;
                    }
                    
                    const criteria = ['Salaire', 'Type de contrat', 'Mode de travail', 'Expérience requise', 'Compétences techniques', 'Distance'];
                    
                    const content = `<div class="space-y-6">
                        <div class="bg-gradient-to-r from-cyan-50 to-blue-50 dark:from-cyan-900/20 dark:to-blue-900/20 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-2 dark:text-white"><i class="fas fa-balance-scale mr-2"></i>Comparaison d'offres</h3>
                            <p class="text-sm text-gray-700 dark:text-gray-300">Comparez jusqu'à 3 offres d'emploi côte à côte</p>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full border-collapse">
                                <thead>
                                    <tr class="bg-gray-100 dark:bg-gray-700">
                                        <th class="p-3 text-left text-sm font-semibold dark:text-white sticky left-0 bg-gray-100 dark:bg-gray-700">Critère</th>
                                        ${favoriteJobs.map(job => `<th class="p-3 text-center text-sm font-semibold dark:text-white min-w-[200px]">${job.title}</th>`).join('')}
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b dark:border-gray-600">
                                        <td class="p-3 font-medium dark:text-white sticky left-0 bg-white dark:bg-gray-800">Entreprise</td>
                                        ${favoriteJobs.map(job => `<td class="p-3 text-center text-sm dark:text-gray-300">${job.company}</td>`).join('')}
                                    </tr>
                                    <tr class="border-b dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50">
                                        <td class="p-3 font-medium dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700/50">Salaire</td>
                                        ${favoriteJobs.map(job => `<td class="p-3 text-center text-sm font-bold text-green-600 dark:text-green-400">${job.salary?.toLocaleString('fr-FR')} €/an</td>`).join('')}
                                    </tr>
                                    <tr class="border-b dark:border-gray-600">
                                        <td class="p-3 font-medium dark:text-white sticky left-0 bg-white dark:bg-gray-800">Type de contrat</td>
                                        ${favoriteJobs.map(job => `<td class="p-3 text-center text-sm dark:text-gray-300">${job.contract}</td>`).join('')}
                                    </tr>
                                    <tr class="border-b dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50">
                                        <td class="p-3 font-medium dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700/50">Mode de travail</td>
                                        ${favoriteJobs.map(job => `<td class="p-3 text-center text-sm dark:text-gray-300">${job.workArrangement}</td>`).join('')}
                                    </tr>
                                    <tr class="border-b dark:border-gray-600">
                                        <td class="p-3 font-medium dark:text-white sticky left-0 bg-white dark:bg-gray-800">Localisation</td>
                                        ${favoriteJobs.map(job => `<td class="p-3 text-center text-sm dark:text-gray-300">${job.city}</td>`).join('')}
                                    </tr>
                                    <tr class="border-b dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50">
                                        <td class="p-3 font-medium dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700/50">Expérience</td>
                                        ${favoriteJobs.map(job => `<td class="p-3 text-center text-sm dark:text-gray-300">${job.experience}</td>`).join('')}
                                    </tr>
                                    <tr class="border-b dark:border-gray-600">
                                        <td class="p-3 font-medium dark:text-white sticky left-0 bg-white dark:bg-gray-800">Compétences clés</td>
                                        ${favoriteJobs.map(job => `<td class="p-3 text-center text-xs dark:text-gray-300">${job.tags.slice(0, 3).join(', ')}</td>`).join('')}
                                    </tr>
                                    <tr class="bg-gray-50 dark:bg-gray-700/50">
                                        <td class="p-3 font-medium dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700/50">Actions</td>
                                        ${favoriteJobs.map(job => `<td class="p-3 text-center">
                                            <button onclick="showDetailsModal(${job.id}); closeAllModals();" class="bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700">
                                                Voir détails
                                            </button>
                                        </td>`).join('')}
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                            <p class="text-sm text-gray-700 dark:text-gray-300"><i class="fas fa-info-circle mr-2 text-blue-500"></i>Ajoutez des offres à vos favoris <i class="fas fa-heart text-pink-500"></i> pour les comparer ici</p>
                        </div>
                    </div>`;
                    
                    document.getElementById('comparator-content').innerHTML = content;
                    openModal('jobComparator-modal');
                }
                
                function showCareerCoach() {
                    if (!state.currentUser?.type === 'candidate') { showToast('Cette fonctionnalité est réservée aux candidats.', 'error'); return; }
                    
                    const tips = [
                        { category: 'CV', icon: 'fa-file-alt', color: 'blue', title: 'Optimisez votre CV', description: 'Utilisez des mots-clés pertinents et quantifiez vos réalisations', progress: 75 },
                        { category: 'Profil', icon: 'fa-user', color: 'green', title: 'Complétez votre profil', description: 'Un profil complet augmente vos chances de 40%', progress: 85 },
                        { category: 'Compétences', icon: 'fa-graduation-cap', color: 'purple', title: 'Développez vos compétences', description: 'Suivez des formations en ligne pour rester compétitif', progress: 60 },
                        { category: 'Réseau', icon: 'fa-users', color: 'orange', title: 'Élargissez votre réseau', description: 'Connectez-vous avec des professionnels de votre secteur', progress: 45 }
                    ];
                    
                    const content = `<div class="space-y-6">
                        <div class="bg-gradient-to-r from-rose-50 to-pink-50 dark:from-rose-900/20 dark:to-pink-900/20 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-2 dark:text-white"><i class="fas fa-rocket mr-2"></i>Boostez votre carrière</h3>
                            <p class="text-sm text-gray-700 dark:text-gray-300">Conseils personnalisés pour réussir votre recherche d'emploi</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            ${tips.map(tip => `<div class="bg-gradient-to-br from-${tip.color}-50 to-${tip.color}-100 dark:from-${tip.color}-900/20 dark:to-${tip.color}-900/30 p-5 rounded-lg border-l-4 border-${tip.color}-500">
                                <div class="flex items-start gap-3 mb-3">
                                    <div class="w-12 h-12 bg-${tip.color}-600 text-white rounded-full flex items-center justify-center flex-shrink-0">
                                        <i class="fas ${tip.icon}"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-bold text-lg dark:text-white mb-1">${tip.title}</h4>
                                        <p class="text-sm text-gray-700 dark:text-gray-300">${tip.description}</p>
                                    </div>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                    <div class="bg-${tip.color}-600 h-2 rounded-full" style="width: ${tip.progress}%"></div>
                                </div>
                                <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">${tip.progress}% complété</p>
                            </div>`).join('')}
                        </div>
                        
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow">
                            <h4 class="font-bold text-lg mb-4 dark:text-white"><i class="fas fa-chart-line mr-2 text-teal-500"></i>Votre progression</h4>
                            <div class="space-y-4">
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-sm font-medium dark:text-gray-300">Force du profil</span>
                                        <span class="text-sm font-bold text-teal-600 dark:text-teal-400">66%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                                        <div class="bg-teal-600 h-3 rounded-full" style="width: 66%"></div>
                                    </div>
                                </div>
                                <div class="grid grid-cols-3 gap-3 mt-4">
                                    <div class="text-center p-3 bg-blue-50 dark:bg-blue-900/20 rounded">
                                        <p class="text-2xl font-bold text-blue-600 dark:text-blue-400">12</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Candidatures</p>
                                    </div>
                                    <div class="text-center p-3 bg-green-50 dark:bg-green-900/20 rounded">
                                        <p class="text-2xl font-bold text-green-600 dark:text-green-400">3</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Entretiens</p>
                                    </div>
                                    <div class="text-center p-3 bg-purple-50 dark:bg-purple-900/20 rounded">
                                        <p class="text-2xl font-bold text-purple-600 dark:text-purple-400">87</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Vues profil</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 p-5 rounded-lg">
                            <h4 class="font-bold mb-3 dark:text-white"><i class="fas fa-trophy mr-2 text-yellow-500"></i>Prochaines étapes recommandées</h4>
                            <ul class="space-y-2 text-sm">
                                <li class="flex items-start gap-2">
                                    <i class="fas fa-arrow-right text-orange-500 mt-1"></i>
                                    <span class="text-gray-700 dark:text-gray-300">Ajoutez au moins 3 projets à votre portfolio</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <i class="fas fa-arrow-right text-orange-500 mt-1"></i>
                                    <span class="text-gray-700 dark:text-gray-300">Obtenez une certification dans votre domaine</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <i class="fas fa-arrow-right text-orange-500 mt-1"></i>
                                    <span class="text-gray-700 dark:text-gray-300">Postulez à au moins 5 offres cette semaine</span>
                                </li>
                            </ul>
                        </div>
                    </div>`;
                    
                    document.getElementById('career-coach-content').innerHTML = content;
                    openModal('careerCoach-modal');
                }
                
                function showRecruitmentAnalytics() {
                    if (!state.currentUser || (state.currentUser.type !== 'recruiter' && state.currentUser.type !== 'employer')) {
                        showToast('Cette fonctionnalité est réservée aux recruteurs et employeurs.', 'error');
                        return;
                    }
                    
                    const myJobs = data.filter(j => j.type === 'job').slice(0, 5);
                    const totalApplications = state.applications ? state.applications.length : Math.floor(Math.random() * 150) + 50;
                    const interviewsScheduled = Math.floor(totalApplications * 0.3);
                    const hiredCount = Math.floor(totalApplications * 0.1);
                    const averageTime = Math.floor(Math.random() * 20) + 15;
                    
                    const content = `<div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-900/30 p-5 rounded-lg">
                                <i class="fas fa-file-alt text-3xl text-blue-600 dark:text-blue-400 mb-2"></i>
                                <p class="text-3xl font-bold text-blue-600 dark:text-blue-400">${totalApplications}</p>
                                <p class="text-sm text-gray-700 dark:text-gray-300">Candidatures reçues</p>
                            </div>
                            <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-900/30 p-5 rounded-lg">
                                <i class="fas fa-calendar-check text-3xl text-green-600 dark:text-green-400 mb-2"></i>
                                <p class="text-3xl font-bold text-green-600 dark:text-green-400">${interviewsScheduled}</p>
                                <p class="text-sm text-gray-700 dark:text-gray-300">Entretiens planifiés</p>
                            </div>
                            <div class="bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-900/30 p-5 rounded-lg">
                                <i class="fas fa-user-check text-3xl text-purple-600 dark:text-purple-400 mb-2"></i>
                                <p class="text-3xl font-bold text-purple-600 dark:text-purple-400">${hiredCount}</p>
                                <p class="text-sm text-gray-700 dark:text-gray-300">Recrutements réussis</p>
                            </div>
                            <div class="bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-900/30 p-5 rounded-lg">
                                <i class="fas fa-clock text-3xl text-orange-600 dark:text-orange-400 mb-2"></i>
                                <p class="text-3xl font-bold text-orange-600 dark:text-orange-400">${averageTime}j</p>
                                <p class="text-sm text-gray-700 dark:text-gray-300">Délai moyen d'embauche</p>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow">
                            <h3 class="font-bold text-lg mb-4 dark:text-white"><i class="fas fa-chart-line mr-2 text-blue-500"></i>Performance des offres</h3>
                            <div class="space-y-3">
                                ${myJobs.map(job => {
                                    const applications = Math.floor(Math.random() * 50) + 10;
                                    const views = Math.floor(Math.random() * 200) + 50;
                                    return `<div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-600 rounded-lg">
                                        <div class="flex-1">
                                            <p class="font-semibold dark:text-white">${job.title}</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-300">${job.city} • ${job.contract}</p>
                                        </div>
                                        <div class="flex gap-4 text-sm">
                                            <div class="text-center">
                                                <p class="font-bold text-blue-600 dark:text-blue-400">${views}</p>
                                                <p class="text-xs text-gray-500">vues</p>
                                            </div>
                                            <div class="text-center">
                                                <p class="font-bold text-green-600 dark:text-green-400">${applications}</p>
                                                <p class="text-xs text-gray-500">candidatures</p>
                                            </div>
                                        </div>
                                    </div>`;
                                }).join('')}
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-cyan-50 to-blue-50 dark:from-cyan-900/20 dark:to-blue-900/20 p-5 rounded-lg">
                            <h4 class="font-bold mb-3 dark:text-white"><i class="fas fa-lightbulb mr-2 text-yellow-500"></i>Recommandations</h4>
                            <ul class="space-y-2 text-sm text-gray-700 dark:text-gray-300">
                                <li><i class="fas fa-arrow-right text-blue-500 mr-2"></i>Augmentez la visibilité de vos offres en améliorant les descriptions</li>
                                <li><i class="fas fa-arrow-right text-blue-500 mr-2"></i>Répondez rapidement aux candidatures pour améliorer votre taux de conversion</li>
                                <li><i class="fas fa-arrow-right text-blue-500 mr-2"></i>Utilisez la fonctionnalité de matching pour trouver les meilleurs profils</li>
                            </ul>
                        </div>
                    </div>`;
                    
                    document.getElementById('recruitment-analytics-content').innerHTML = content;
                    openModal('recruitmentAnalytics-modal');
                }
                
                function showCandidatePool() {
                    if (!state.currentUser || (state.currentUser.type !== 'recruiter' && state.currentUser.type !== 'employer')) {
                        showToast('Cette fonctionnalité est réservée aux recruteurs et employeurs.', 'error');
                        return;
                    }
                    
                    const candidates = data.filter(c => c.type === 'candidate').slice(0, 10);
                    
                    const content = `<div class="space-y-6">
                        <div class="bg-gradient-to-r from-cyan-50 to-blue-50 dark:from-cyan-900/20 dark:to-blue-900/20 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-2 dark:text-white"><i class="fas fa-users mr-2"></i>Vivier de candidats</h3>
                            <p class="text-sm text-gray-700 dark:text-gray-300">Parcourez et gérez votre base de candidats</p>
                        </div>
                        
                        <div class="flex gap-2 mb-4">
                            <input type="text" placeholder="Rechercher un candidat..." class="flex-1 px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            <button class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        
                        <div class="space-y-3">
                            ${candidates.map(candidate => `<div class="bg-white dark:bg-gray-700 p-5 rounded-lg shadow hover:shadow-lg transition cursor-pointer" onclick="showDetailsModal(${candidate.id})">
                                <div class="flex items-start gap-4">
                                    <img src="${candidate.avatar}" class="w-16 h-16 rounded-full" alt="${candidate.name}">
                                    <div class="flex-1">
                                        <div class="flex items-center justify-between mb-2">
                                            <h4 class="font-bold text-lg dark:text-white">${candidate.name}</h4>
                                            <button onclick="event.stopPropagation(); contactCandidate(${candidate.id})" class="bg-blue-600 text-white px-4 py-1 rounded text-sm hover:bg-blue-700">
                                                Contacter
                                            </button>
                                        </div>
                                        <p class="text-gray-600 dark:text-gray-300 mb-2">${candidate.title}</p>
                                        <div class="flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400">
                                            <span><i class="fas fa-map-marker-alt mr-1"></i>${candidate.city}</span>
                                            <span><i class="fas fa-briefcase mr-1"></i>${candidate.experience}</span>
                                            <span><i class="fas fa-clock mr-1"></i>${candidate.availability}</span>
                                        </div>
                                        <div class="flex flex-wrap gap-2 mt-3">
                                            ${candidate.tags.slice(0, 4).map(tag => `<span class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs">${tag}</span>`).join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>`).join('')}
                        </div>
                    </div>`;
                    
                    document.getElementById('candidate-pool-content').innerHTML = content;
                    openModal('candidatePool-modal');
                }
                
                function showJobPerformance() {
                    if (!state.currentUser || (state.currentUser.type !== 'recruiter' && state.currentUser.type !== 'employer')) {
                        showToast('Cette fonctionnalité est réservée aux recruteurs et employeurs.', 'error');
                        return;
                    }
                    
                    const myJobs = data.filter(j => j.type === 'job').slice(0, 8);
                    
                    const content = `<div class="space-y-6">
                        <div class="bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-2 dark:text-white"><i class="fas fa-trophy mr-2"></i>Performance des offres d'emploi</h3>
                            <p class="text-sm text-gray-700 dark:text-gray-300">Analysez la performance de vos offres publiées</p>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-100 dark:bg-gray-700">
                                    <tr>
                                        <th class="p-3 text-left text-sm font-semibold dark:text-white">Poste</th>
                                        <th class="p-3 text-center text-sm font-semibold dark:text-white">Vues</th>
                                        <th class="p-3 text-center text-sm font-semibold dark:text-white">Candidatures</th>
                                        <th class="p-3 text-center text-sm font-semibold dark:text-white">Taux conversion</th>
                                        <th class="p-3 text-center text-sm font-semibold dark:text-white">Score</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${myJobs.map(job => {
                                        const views = Math.floor(Math.random() * 300) + 100;
                                        const applications = Math.floor(Math.random() * 50) + 10;
                                        const conversionRate = ((applications / views) * 100).toFixed(1);
                                        const score = Math.floor(Math.random() * 30) + 70;
                                        const scoreColor = score >= 85 ? 'text-green-600 dark:text-green-400' : score >= 70 ? 'text-yellow-600 dark:text-yellow-400' : 'text-red-600 dark:text-red-400';
                                        
                                        return `<tr class="border-b dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="p-3">
                                                <p class="font-semibold dark:text-white">${job.title}</p>
                                                <p class="text-xs text-gray-500 dark:text-gray-400">${job.city} • ${job.contract}</p>
                                            </td>
                                            <td class="p-3 text-center font-bold text-blue-600 dark:text-blue-400">${views}</td>
                                            <td class="p-3 text-center font-bold text-green-600 dark:text-green-400">${applications}</td>
                                            <td class="p-3 text-center font-bold text-purple-600 dark:text-purple-400">${conversionRate}%</td>
                                            <td class="p-3 text-center">
                                                <div class="flex items-center justify-center gap-2">
                                                    <span class="font-bold ${scoreColor}">${score}</span>
                                                    <i class="fas ${score >= 85 ? 'fa-arrow-up' : score >= 70 ? 'fa-minus' : 'fa-arrow-down'} ${scoreColor}"></i>
                                                </div>
                                            </td>
                                        </tr>`;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                                <p class="text-sm text-gray-600 dark:text-gray-400">Offre la plus vue</p>
                                <p class="font-bold text-lg dark:text-white">${myJobs[0]?.title || 'N/A'}</p>
                            </div>
                            <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg">
                                <p class="text-sm text-gray-600 dark:text-gray-400">Meilleur taux de conversion</p>
                                <p class="font-bold text-lg dark:text-white">${myJobs[1]?.title || 'N/A'}</p>
                            </div>
                            <div class="bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg">
                                <p class="text-sm text-gray-600 dark:text-gray-400">Plus de candidatures</p>
                                <p class="font-bold text-lg dark:text-white">${myJobs[2]?.title || 'N/A'}</p>
                            </div>
                        </div>
                    </div>`;
                    
                    document.getElementById('job-performance-content').innerHTML = content;
                    openModal('jobPerformance-modal');
                }
                
                function showTeamCollaboration() {
                    if (!state.currentUser || (state.currentUser.type !== 'recruiter' && state.currentUser.type !== 'employer')) {
                        showToast('Cette fonctionnalité est réservée aux recruteurs et employeurs.', 'error');
                        return;
                    }
                    
                    const teamMembers = [
                        { id: 1, name: 'Sophie Martin', role: 'Recruteur Senior', avatar: 'https://placehold.co/100x100/3b82f6/ffffff?text=SM', active: true, tasks: 12 },
                        { id: 2, name: 'Marc Dubois', role: 'RH Manager', avatar: 'https://placehold.co/100x100/10b981/ffffff?text=MD', active: true, tasks: 8 },
                        { id: 3, name: 'Julie Roux', role: 'Recruteur', avatar: 'https://placehold.co/100x100/ec4899/ffffff?text=JR', active: false, tasks: 15 },
                        { id: 4, name: 'Thomas Blanc', role: 'Talent Acquisition', avatar: 'https://placehold.co/100x100/f59e0b/ffffff?text=TB', active: true, tasks: 6 }
                    ];
                    
                    const content = `<div class="space-y-6">
                        <div class="bg-gradient-to-r from-teal-50 to-cyan-50 dark:from-teal-900/20 dark:to-cyan-900/20 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-2 dark:text-white"><i class="fas fa-users-cog mr-2"></i>Collaboration d'équipe</h3>
                            <p class="text-sm text-gray-700 dark:text-gray-300">Gérez votre équipe de recrutement et leurs tâches</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            ${teamMembers.map(member => `<div class="bg-white dark:bg-gray-700 p-5 rounded-lg shadow">
                                <div class="flex items-start gap-4">
                                    <div class="relative">
                                        <img src="${member.avatar}" class="w-16 h-16 rounded-full" alt="${member.name}">
                                        <span class="absolute bottom-0 right-0 w-4 h-4 ${member.active ? 'bg-green-500' : 'bg-gray-400'} border-2 border-white rounded-full"></span>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-bold dark:text-white">${member.name}</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-300">${member.role}</p>
                                        <div class="flex items-center gap-4 mt-2 text-sm">
                                            <span class="text-gray-500 dark:text-gray-400">
                                                <i class="fas fa-tasks mr-1"></i>${member.tasks} tâches
                                            </span>
                                            <span class="${member.active ? 'text-green-600 dark:text-green-400' : 'text-gray-500 dark:text-gray-400'}">
                                                <i class="fas fa-circle mr-1 text-xs"></i>${member.active ? 'En ligne' : 'Hors ligne'}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>`).join('')}
                        </div>
                        
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow">
                            <h4 class="font-bold mb-4 dark:text-white"><i class="fas fa-clipboard-list mr-2"></i>Tâches en cours</h4>
                            <div class="space-y-3">
                                ${['Révision CV - Développeur Full-Stack', 'Planifier entretien - Data Scientist', 'Feedback candidat - Designer UX', 'Suivi candidature - DevOps Engineer'].map((task, i) => `<div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-600 rounded-lg">
                                    <div class="flex items-center gap-3">
                                        <input type="checkbox" class="w-5 h-5 text-blue-600 rounded" ${i === 0 ? 'checked' : ''}>
                                        <span class="dark:text-white ${i === 0 ? 'line-through text-gray-500' : ''}">${task}</span>
                                    </div>
                                    <span class="text-xs text-gray-500 dark:text-gray-400">${teamMembers[i % teamMembers.length].name}</span>
                                </div>`).join('')}
                            </div>
                        </div>
                        
                        <div class="flex gap-3">
                            <button class="flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 font-semibold">
                                <i class="fas fa-plus mr-2"></i>Ajouter une tâche
                            </button>
                            <button class="flex-1 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 py-3 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 font-semibold">
                                <i class="fas fa-user-plus mr-2"></i>Inviter un membre
                            </button>
                        </div>
                    </div>`;
                    
                    document.getElementById('team-collaboration-content').innerHTML = content;
                    openModal('teamCollaboration-modal');
                }
                
                function showStatistics() {
                    const content = `<div class="space-y-6">
                        <div class="bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-2 dark:text-white"><i class="fas fa-chart-area mr-2"></i>Statistiques d'utilisation</h3>
                            <p class="text-sm text-gray-700 dark:text-gray-300">Analysez votre activité sur la plateforme</p>
                        </div>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="bg-white dark:bg-gray-700 p-5 rounded-lg shadow text-center">
                                <i class="fas fa-search text-3xl text-blue-600 dark:text-blue-400 mb-2"></i>
                                <p class="text-3xl font-bold dark:text-white">${Math.floor(Math.random() * 200) + 50}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Recherches</p>
                            </div>
                            <div class="bg-white dark:bg-gray-700 p-5 rounded-lg shadow text-center">
                                <i class="fas fa-eye text-3xl text-green-600 dark:text-green-400 mb-2"></i>
                                <p class="text-3xl font-bold dark:text-white">${Math.floor(Math.random() * 500) + 100}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Vues de profil</p>
                            </div>
                            <div class="bg-white dark:bg-gray-700 p-5 rounded-lg shadow text-center">
                                <i class="fas fa-heart text-3xl text-pink-600 dark:text-pink-400 mb-2"></i>
                                <p class="text-3xl font-bold dark:text-white">${state.favorites.size}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Favoris</p>
                            </div>
                            <div class="bg-white dark:bg-gray-700 p-5 rounded-lg shadow text-center">
                                <i class="fas fa-paper-plane text-3xl text-purple-600 dark:text-purple-400 mb-2"></i>
                                <p class="text-3xl font-bold dark:text-white">${state.applications ? state.applications.length : 0}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Candidatures</p>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow">
                            <h4 class="font-bold mb-4 dark:text-white"><i class="fas fa-clock mr-2"></i>Activité récente</h4>
                            <div class="space-y-3">
                                ${state.viewHistory.slice(0, 5).map(view => {
                                    const item = view.item;
                                    const timeAgo = Math.floor((Date.now() - new Date(view.date).getTime()) / 60000);
                                    return `<div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-600 rounded-lg">
                                        <div>
                                            <p class="font-semibold dark:text-white">${item.type === 'job' ? item.title : item.name}</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-300">${item.type === 'job' ? item.company : item.title}</p>
                                        </div>
                                        <span class="text-xs text-gray-500 dark:text-gray-400">Il y a ${timeAgo} min</span>
                                    </div>`;
                                }).join('') || '<p class="text-gray-500 dark:text-gray-400 text-center">Aucune activité récente</p>'}
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 dark:bg-blue-900/20 p-5 rounded-lg">
                            <h4 class="font-bold mb-3 dark:text-white"><i class="fas fa-trophy mr-2 text-yellow-500"></i>Vos accomplissements</h4>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                ${[
                                    { icon: 'fa-star', name: 'Premier Favori', color: 'yellow' },
                                    { icon: 'fa-fire', name: 'Utilisateur Actif', color: 'orange' },
                                    { icon: 'fa-search', name: 'Explorateur', color: 'blue' },
                                    { icon: 'fa-heart', name: 'Super Fan', color: 'pink' }
                                ].map(badge => `<div class="bg-white dark:bg-gray-700 p-3 rounded-lg text-center">
                                    <i class="fas ${badge.icon} text-2xl text-${badge.color}-600 dark:text-${badge.color}-400 mb-2"></i>
                                    <p class="text-xs font-semibold dark:text-white">${badge.name}</p>
                                </div>`).join('')}
                            </div>
                        </div>
                    </div>`;
                    
                    document.getElementById('statistics-content').innerHTML = content;
                    openModal('statistics-modal');
                }
                
                function showSettings() {
                    const content = `<div class="space-y-6">
                        <div class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-2 dark:text-white"><i class="fas fa-cog mr-2"></i>Paramètres</h3>
                            <p class="text-sm text-gray-700 dark:text-gray-300">Gérez vos préférences et paramètres de compte</p>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="bg-white dark:bg-gray-700 p-5 rounded-lg shadow">
                                <h4 class="font-bold mb-4 dark:text-white"><i class="fas fa-bell mr-2"></i>Notifications</h4>
                                <div class="space-y-3">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-semibold dark:text-white">Nouvelles offres</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Recevoir des alertes pour les nouvelles offres correspondantes</p>
                                        </div>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" class="sr-only peer" checked>
                                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-semibold dark:text-white">Messages</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Notifications de nouveaux messages</p>
                                        </div>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" class="sr-only peer" checked>
                                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-semibold dark:text-white">Emails hebdomadaires</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Résumé hebdomadaire de votre activité</p>
                                        </div>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" class="sr-only peer">
                                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-700 p-5 rounded-lg shadow">
                                <h4 class="font-bold mb-4 dark:text-white"><i class="fas fa-lock mr-2"></i>Confidentialité</h4>
                                <div class="space-y-3">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-semibold dark:text-white">Profil public</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Rendre mon profil visible aux recruteurs</p>
                                        </div>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" class="sr-only peer" checked>
                                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-semibold dark:text-white">Statistiques anonymisées</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Partager des données anonymes pour améliorer le service</p>
                                        </div>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" class="sr-only peer" checked>
                                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-700 p-5 rounded-lg shadow">
                                <h4 class="font-bold mb-4 dark:text-white"><i class="fas fa-paint-brush mr-2"></i>Apparence</h4>
                                <div class="grid grid-cols-2 gap-3">
                                    <button class="p-4 border-2 border-blue-500 rounded-lg bg-white hover:bg-gray-50">
                                        <i class="fas fa-sun text-2xl text-yellow-500 mb-2"></i>
                                        <p class="text-sm font-semibold">Clair</p>
                                    </button>
                                    <button class="p-4 border-2 border-gray-300 rounded-lg bg-gray-800 hover:bg-gray-700">
                                        <i class="fas fa-moon text-2xl text-blue-400 mb-2"></i>
                                        <p class="text-sm font-semibold text-white">Sombre</p>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="flex gap-3">
                                <button class="flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 font-semibold">
                                    <i class="fas fa-save mr-2"></i>Sauvegarder les modifications
                                </button>
                                <button class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 font-semibold">
                                    <i class="fas fa-trash mr-2"></i>Supprimer le compte
                                </button>
                            </div>
                        </div>
                    </div>`;
                    
                    document.getElementById('settings-content').innerHTML = content;
                    openModal('settings-modal');
                }
                
                function showHelpCenter() {
                    const content = `<div class="space-y-6">
                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-2 dark:text-white"><i class="fas fa-question-circle mr-2"></i>Centre d'aide</h3>
                            <p class="text-sm text-gray-700 dark:text-gray-300">Trouvez des réponses à vos questions</p>
                        </div>
                        
                        <div class="mb-4">
                            <input type="text" placeholder="Rechercher dans l'aide..." class="w-full px-4 py-3 border-2 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:border-blue-500 focus:outline-none">
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            ${[
                                { icon: 'fa-user-circle', title: 'Créer un compte', desc: 'Comment créer et configurer votre profil', color: 'blue' },
                                { icon: 'fa-search', title: 'Rechercher des offres', desc: 'Utilisez les filtres pour trouver l\'emploi idéal', color: 'green' },
                                { icon: 'fa-paper-plane', title: 'Postuler', desc: 'Comment envoyer votre candidature', color: 'purple' },
                                { icon: 'fa-heart', title: 'Gérer les favoris', desc: 'Organisez vos offres favorites', color: 'pink' }
                            ].map(topic => `<div class="bg-white dark:bg-gray-700 p-5 rounded-lg shadow hover:shadow-lg transition cursor-pointer">
                                <i class="fas ${topic.icon} text-3xl text-${topic.color}-600 dark:text-${topic.color}-400 mb-3"></i>
                                <h4 class="font-bold mb-2 dark:text-white">${topic.title}</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-300">${topic.desc}</p>
                            </div>`).join('')}
                        </div>
                        
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow">
                            <h4 class="font-bold mb-4 dark:text-white"><i class="fas fa-question mr-2"></i>Questions fréquentes</h4>
                            <div class="space-y-3">
                                ${[
                                    { q: 'Comment modifier mon profil ?', a: 'Cliquez sur le menu utilisateur puis "Mon Profil" pour accéder aux paramètres de votre compte.' },
                                    { q: 'Comment postuler à une offre ?', a: 'Cliquez sur "Voir détails" puis sur le bouton "Postuler maintenant" dans la fiche de l\'offre.' },
                                    { q: 'Comment ajouter des favoris ?', a: 'Cliquez sur l\'icône de cœur sur n\'importe quelle offre ou profil pour l\'ajouter à vos favoris.' },
                                    { q: 'Comment utiliser le mode association ?', a: 'Activez le mode association, sélectionnez un candidat puis une offre pour voir la compatibilité.' }
                                ].map(faq => `<details class="bg-gray-50 dark:bg-gray-600 p-4 rounded-lg cursor-pointer">
                                    <summary class="font-semibold dark:text-white">${faq.q}</summary>
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mt-2">${faq.a}</p>
                                </details>`).join('')}
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 dark:bg-blue-900/20 p-5 rounded-lg">
                            <h4 class="font-bold mb-3 dark:text-white"><i class="fas fa-headset mr-2"></i>Besoin d'aide supplémentaire ?</h4>
                            <p class="text-sm text-gray-700 dark:text-gray-300 mb-4">Notre équipe support est disponible du lundi au vendredi de 9h à 18h</p>
                            <div class="flex gap-3">
                                <button class="flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">
                                    <i class="fas fa-envelope mr-2"></i>Nous contacter
                                </button>
                                <button class="flex-1 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500">
                                    <i class="fas fa-comments mr-2"></i>Chat en direct
                                </button>
                            </div>
                        </div>
                    </div>`;
                    
                    document.getElementById('help-center-content').innerHTML = content;
                    openModal('helpCenter-modal');
                }
                
                
                document.getElementById('login-form').addEventListener('submit', e => { e.preventDefault(); state.currentUser = {id: 99, name: "Recruteur Test", email: e.target.email.value, type: 'recruiter'}; closeAllModals(); updateAuthUI(); showToast('Connexion réussie !', 'success'); });
                document.getElementById('signup-candidate-form').addEventListener('submit', e => { e.preventDefault(); const name = e.target.name.value; state.currentUser = {id: data.length + 1, name, email: e.target.email.value, type: 'candidate'}; data.push({id: state.currentUser.id, type:'candidate', name, title: e.target.title.value, tags: e.target.tags.value.split(','), softSkills: [], location: {lat: 48.85, lon: 2.35}, city: 'Paris', experience: 'Junior', availability: 'Immédiate', description: 'Nouveau candidat'}); closeAllModals(); updateAuthUI(); showToast(`Bienvenue, ${name} !`, 'success'); performSearch(); });
                document.getElementById('signup-recruiter-form').addEventListener('submit', e => { e.preventDefault(); const name = e.target.name.value; state.currentUser = {id: data.length + 1, name, email: e.target.email.value, type: 'recruiter', company: e.target.company.value}; closeAllModals(); updateAuthUI(); showToast(`Bienvenue, ${name} !`, 'success'); });
                document.getElementById('signup-employer-form').addEventListener('submit', e => { e.preventDefault(); const name = e.target.name.value; state.currentUser = {id: data.length + 1, name, email: e.target.email.value, type: 'employer', company: e.target.companyName.value, siret: e.target.siret.value}; closeAllModals(); updateAuthUI(); showToast(`Bienvenue, ${name} !`, 'success'); });
                document.getElementById('post-job-form').addEventListener('submit', e => { e.preventDefault(); const newJob = {id: data.length + 1, type: 'job', title: e.target.title.value, company: e.target.company.value, city: e.target.city.value, description: e.target.description.value, tags: e.target.tags.value.split(','), softSkills: e.target.softSkills.value.split(','), experience: e.target.experience.value, salary: parseInt(e.target.salary.value), location: { lat: 48.85, lon: 2.35 }, contract: 'CDI', workArrangement: 'Hybride', companyDescription: '' }; data.push(newJob); closeAllModals(); showToast('Offre publiée !', 'success'); performSearch(); });
                document.getElementById('spontaneous-application-form').addEventListener('submit', e => { e.preventDefault(); const company = e.target.company.value; const message = e.target.message.value; if (!state.spontaneousApplications) state.spontaneousApplications = []; state.spontaneousApplications.push({ id: state.spontaneousApplications.length + 1, candidateId: state.currentUser.id, company, message, date: new Date().toISOString(), status: 'sent' }); closeAllModals(); showToast(`Candidature spontanée envoyée à ${company} !`, 'success'); });
                
                ui.favoritesBtn.addEventListener('click', showFavoritesModal);
                ui.locateMeBtn.addEventListener('click', getUserLocation);
                ui.saveSearchBtn.addEventListener('click', saveCurrentSearch);
                ui.helpBtn.addEventListener('click', showHelp);
                
                ui.darkModeToggle.addEventListener('click', () => { document.documentElement.classList.toggle('dark'); const icon = ui.darkModeToggle.querySelector('i'); if (document.documentElement.classList.contains('dark')) { icon.classList.replace('fa-moon', 'fa-sun'); localStorage.setItem('theme', 'dark'); } else { icon.classList.replace('fa-sun', 'fa-moon'); localStorage.setItem('theme', 'light'); } });
                if (localStorage.getItem('theme') === 'dark') { document.documentElement.classList.add('dark'); ui.darkModeToggle.querySelector('i').classList.replace('fa-moon', 'fa-sun'); }
                
                ui.userMenuButton.addEventListener('click', e => { e.stopPropagation(); ui.userMenu.classList.toggle('hidden'); ui.userMenu.classList.toggle('opacity-0'); ui.userMenu.classList.toggle('scale-95');});
                document.addEventListener('click', e => { if (!e.target.closest('#user-menu-button') && !e.target.closest('#user-menu')) { ui.userMenu.classList.add('hidden', 'opacity-0', 'scale-95'); }});
                ui.togglePanelBtn.addEventListener('click', () => ui.searchPanel.classList.toggle('collapsed'));
                ui.matchModeBtn.addEventListener('click', toggleMatchMode);
                ui.searchInput.addEventListener('keyup', performSearch);
                ui.filterContainer.addEventListener('click', e => { const target = e.target.closest('button'); if(target) { ui.filterContainer.querySelector('.active').classList.remove('active'); target.classList.add('active'); state.filters.type = target.dataset.filter; performSearch(); } });
                
                [ui.expFilterContainer, ui.contractFilterContainer, ui.workArrangementFilterContainer].forEach(container => {
                    container.addEventListener('click', e => {
                        const target = e.target.closest('.sub-filter-btn');
                        if (target) {
                            container.querySelector('.active').classList.remove('active'); target.classList.add('active');
                            if (target.dataset.exp) state.filters.experience = target.dataset.exp;
                            if (target.dataset.contract) state.filters.contract = target.dataset.contract;
                            if (target.dataset.work) state.filters.workArrangement = target.dataset.work;
                            performSearch();
                        }
                    });
                });
                
                ui.industryFilter.addEventListener('change', e => { state.filters.industry = e.target.value; performSearch(); });
                
                ui.salarySlider.addEventListener('input', e => { state.filters.salary = parseInt(e.target.value); ui.salaryValue.textContent = `${state.filters.salary.toLocaleString('fr-FR')} €`; });
                ui.salarySlider.addEventListener('change', performSearch);
                ui.distanceSlider.addEventListener('input', e => { state.filters.distance = parseInt(e.target.value); ui.distanceValue.textContent = `${state.filters.distance} km`; });
                ui.distanceSlider.addEventListener('change', performSearch);
                ui.exportDataBtn.addEventListener('click', exportData);
                ui.resultsList.addEventListener('click', e => { const card = e.target.closest('[data-id][data-lat]'); if (card) showDetailsModal(parseInt(card.dataset.id)); });
                map.on('popupopen', e => e.popup.getElement().querySelector('.view-details-btn')?.addEventListener('click', ev => showDetailsModal(ev.currentTarget.dataset.id)));
                
                ui.toggleResultsBtn.addEventListener('click', () => { ui.resultsList.classList.toggle('expanded'); const icon = ui.toggleResultsBtn.querySelector('i'); icon.classList.toggle('fa-chevron-up'); icon.classList.toggle('fa-chevron-down'); });
                ui.toggleFiltersBtn.addEventListener('click', () => { ui.advancedFilters.classList.toggle('collapsed'); const icon = ui.toggleFiltersBtn.querySelector('i'); icon.classList.toggle('fa-chevron-up'); icon.classList.toggle('fa-chevron-down'); });
                
                updateAuthUI(); performSearch();
            }
        });
    </script>
</body>
</html>


